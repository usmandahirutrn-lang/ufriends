(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,750769,e=>{"use strict";var t=e.i(271645),r=e.i(692659);function a(e){try{let t=String(e?.role||"").toLowerCase(),r=Array.isArray(e?.roles)?e.roles.map(e=>String(e).toLowerCase()):[];return t.includes("marketer")||r.includes("marketer")||e?.isMarketer===!0?"marketer":"user"}catch{return"user"}}async function i(){try{let e=await fetch("/api/me");if(!e.ok)return"user";let t=await e.json().catch(()=>null);return a(t?.user||t)}catch{return"user"}}function n(e,n,s,o,c){let[l,d]=(0,t.useState)(()=>a(c)),[u,m]=(0,t.useState)(null),[p,h]=(0,t.useState)(!1),[f,v]=(0,t.useState)(null),[g,x]=(0,t.useState)(void 0),b=(0,t.useMemo)(()=>({category:String(e||"").trim(),subservice:String(n||"").trim(),variant:String(s||"").trim()}),[e,n,s]),y=(0,t.useMemo)(()=>{if(!o||"object"!=typeof o)return"";let e=Object.entries(o).filter(([e,t])=>null!=t);return e.length?(e.sort(([e],[t])=>e.localeCompare(t)),e.map(([e,t])=>`${e}=${String(t)}`).join("|")):""},[o]);return(0,t.useEffect)(()=>{let e=!1;return(async()=>{h(!0),v(null);try{let t=c?a(c):await i();e||d(t);let r=[["category",b.category],["subservice",b.subservice],["variant",b.variant],["role",t]];if(o&&"object"==typeof o){let e=Object.entries(o).filter(([e,t])=>null!=t);for(let[t,a]of(e.sort(([e],[t])=>e.localeCompare(t)),e))r.push([t,String(a)])}let n=new URLSearchParams(r),s=await fetch(`/api/pricing?${n.toString()}`,{cache:"no-store"}),l=await s.json().catch(()=>null);if(!s.ok)throw Error(String(l?.error||"Failed to load pricing"));let u=l?.price;m("number"==typeof u?u:null)}catch(e){v(e?.message||"Failed to fetch pricing"),m(null)}finally{e||h(!1)}})(),()=>{e=!0}},[b.category,b.subservice,b.variant,y,c]),{price:u,isLoading:p,error:f,reference:g,submitService:(0,t.useCallback)(async e=>{try{let t={amount:Number(e.amount),idempotencyKey:"string"==typeof e.idempotencyKey?e.idempotencyKey:void 0,params:{...e||{}},subServiceId:b.variant||void 0,action:function(e,t){let r=e.trim().toLowerCase(),a=t.trim().toLowerCase();if("nin"===r){if("slip"===a)return"nin.slip";if("printout"===a)return"nin.printout";if("advanced"===a||"verification"===a)return"nin.advanced"}if("bvn"===r){if("printout"===a)return"bvn.printout";if("retrieval"===a||"retrieval_phone"===a)return"bvn.retrieval_phone";if("advanced"===a||"verification"===a)return"bvn.advanced"}if("cac"===r){if("info"===a)return"cac.info";if("status"===a)return"cac.status"}return"passport"===r&&("verify"===a||"verification"===a||"basic"===a)?"passport.verify":"phone"===r&&("advanced"===a||"verification"===a||"basic"===a)?"phone.verify_advanced":("driver-license"===r||"drivers_license"===r)&&("basic"===a||"verification"===a)?"drivers_license.verify":("voters-card"===r||"voters"===r)&&("basic"===a||"full"===a||"verification"===a)?"voters.verify":("plate-number"===r||"plate"===r)&&("basic"===a||"verification"===a)?"plate.verify":"tin"===r&&("basic"===a||"certificate"===a||"verification"===a)?"tin.verify":null}(b.category,b.subservice)||void 0,pin:e.pin},a=await (0,r.authFetch)(`/api/service/${encodeURIComponent(b.category)}/${encodeURIComponent(b.subservice)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}),i=await a.json().catch(()=>null);if(!a.ok)return{ok:!1,error:String(i?.error||`Service failed (${a.status})`),message:String(i?.message||"Failed"),data:i};return x(String(i?.reference||"")),{ok:!0,reference:String(i?.reference||""),message:String(i?.message||""),data:i}}catch(e){return{ok:!1,error:String(e?.message||e)}}},[b.category,b.subservice,b.variant])}}e.s(["default",0,n,"useDynamicPricing",()=>n])},330843,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(630374),i=e.i(167881),n=e.i(23750),s=e.i(10708),o=e.i(846696);function c({isOpen:e,onClose:c,onConfirm:l,isLoading:d}){let[u,m]=(0,r.useState)(""),p=()=>{4!==u.length?o.toast.error("Please enter a 4-digit PIN"):(l(u),m(""))};return(0,t.jsx)(a.Dialog,{open:e,onOpenChange:e=>!e&&c(),children:(0,t.jsxs)(a.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(a.DialogHeader,{children:[(0,t.jsx)(a.DialogTitle,{children:"Enter Transaction PIN"}),(0,t.jsx)(a.DialogDescription,{children:"Please enter your 4-digit transaction PIN to authorize this request."})]}),(0,t.jsx)("div",{className:"space-y-4 py-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(s.Label,{htmlFor:"pin",className:"text-center block",children:"PIN"}),(0,t.jsx)(n.Input,{id:"pin",type:"password",inputMode:"numeric",maxLength:4,value:u,onChange:e=>m(e.target.value.replace(/\D/g,"")),className:"text-center text-2xl tracking-[1em]",placeholder:"••••",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&p()}})]})}),(0,t.jsxs)(a.DialogFooter,{children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:c,disabled:d,children:"Cancel"}),(0,t.jsx)(i.Button,{onClick:p,disabled:d||4!==u.length,className:"bg-[#3457D5]",children:d?"Verifying...":"Confirm PIN"})]})]})})}e.s(["PinPrompt",()=>c])},929054,e=>{"use strict";function t(e,r,a="Error"){r({title:a,description:e.error||e.message||"An unexpected error occurred",variant:"destructive"})}e.s(["handleServiceError",()=>t])},625959,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(820783),i=e.i(30030),n=e.i(981140),s=e.i(369340),o=e.i(999682),c=e.i(635804),l=e.i(296626),d=e.i(248425),u="Checkbox",[m,p]=(0,i.createContextScope)(u),[h,f]=m(u);function v(e){let{__scopeCheckbox:a,checked:i,children:n,defaultChecked:o,disabled:c,form:l,name:d,onCheckedChange:m,required:p,value:f="on",internal_do_not_use_render:v}=e,[g,x]=(0,s.useControllableState)({prop:i,defaultProp:o??!1,onChange:m,caller:u}),[b,y]=r.useState(null),[j,N]=r.useState(null),C=r.useRef(!1),S=!b||!!l||!!b.closest("form"),k={checked:g,disabled:c,setChecked:x,control:b,setControl:y,name:d,form:l,value:f,hasConsumerStoppedPropagationRef:C,required:p,defaultChecked:!w(o)&&o,isFormControl:S,bubbleInput:j,setBubbleInput:N};return(0,t.jsx)(h,{scope:a,...k,children:"function"==typeof v?v(k):n})}var g="CheckboxTrigger",x=r.forwardRef(({__scopeCheckbox:e,onKeyDown:i,onClick:s,...o},c)=>{let{control:l,value:u,disabled:m,checked:p,required:h,setControl:v,setChecked:x,hasConsumerStoppedPropagationRef:b,isFormControl:y,bubbleInput:j}=f(g,e),N=(0,a.useComposedRefs)(c,v),C=r.useRef(p);return r.useEffect(()=>{let e=l?.form;if(e){let t=()=>x(C.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[l,x]),(0,t.jsx)(d.Primitive.button,{type:"button",role:"checkbox","aria-checked":w(p)?"mixed":p,"aria-required":h,"data-state":S(p),"data-disabled":m?"":void 0,disabled:m,value:u,...o,ref:N,onKeyDown:(0,n.composeEventHandlers)(i,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,n.composeEventHandlers)(s,e=>{x(e=>!!w(e)||!e),j&&y&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})})});x.displayName=g;var b=r.forwardRef((e,r)=>{let{__scopeCheckbox:a,name:i,checked:n,defaultChecked:s,required:o,disabled:c,value:l,onCheckedChange:d,form:u,...m}=e;return(0,t.jsx)(v,{__scopeCheckbox:a,checked:n,defaultChecked:s,disabled:c,required:o,onCheckedChange:d,name:i,form:u,value:l,internal_do_not_use_render:({isFormControl:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x,{...m,ref:r,__scopeCheckbox:a}),e&&(0,t.jsx)(C,{__scopeCheckbox:a})]})})});b.displayName=u;var y="CheckboxIndicator",j=r.forwardRef((e,r)=>{let{__scopeCheckbox:a,forceMount:i,...n}=e,s=f(y,a);return(0,t.jsx)(l.Presence,{present:i||w(s.checked)||!0===s.checked,children:(0,t.jsx)(d.Primitive.span,{"data-state":S(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:r,style:{pointerEvents:"none",...e.style}})})});j.displayName=y;var N="CheckboxBubbleInput",C=r.forwardRef(({__scopeCheckbox:e,...i},n)=>{let{control:s,hasConsumerStoppedPropagationRef:l,checked:u,defaultChecked:m,required:p,disabled:h,name:v,value:g,form:x,bubbleInput:b,setBubbleInput:y}=f(N,e),j=(0,a.useComposedRefs)(n,y),C=(0,o.usePrevious)(u),S=(0,c.useSize)(s);r.useEffect(()=>{if(!b)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!l.current;if(C!==u&&e){let r=new Event("click",{bubbles:t});b.indeterminate=w(u),e.call(b,!w(u)&&u),b.dispatchEvent(r)}},[b,C,u,l]);let k=r.useRef(!w(u)&&u);return(0,t.jsx)(d.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:m??k.current,required:p,disabled:h,name:v,value:g,form:x,...i,tabIndex:-1,ref:j,style:{...i.style,...S,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function w(e){return"indeterminate"===e}function S(e){return w(e)?"indeterminate":e?"checked":"unchecked"}C.displayName=N;var k=e.i(643531),D=e.i(647163);function P({className:e,...r}){return(0,t.jsx)(b,{"data-slot":"checkbox",className:(0,D.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:(0,t.jsx)(j,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,t.jsx)(k.Check,{className:"size-3.5"})})})}e.s(["Checkbox",()=>P],625959)},643182,e=>{"use strict";async function t(e,t,r,a,i){let n,s=await fetch("/api/pdf",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({templateId:e,action:t,params:r,fileName:a,data:i})});if(!s.ok){let e="Failed to generate PDF";try{let t=await s.json();e=t?.error||e}catch{}throw Error(e)}let o=await s.blob(),c=URL.createObjectURL(o),l=(n=(s.headers.get("Content-Disposition")||"").match(/filename="([^"]+)"/i),n?.[1]),d=a||l||`${t}-slip-${Date.now()}.pdf`,u=document.createElement("a");u.href=c,u.download=d.endsWith(".pdf")?d:`${d}.pdf`,document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(c)}async function r(e,r,a,i){let n=await fetch("/api/templates/resolve",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({action:e,slipType:i})});if(!n.ok){let e="Failed to resolve template";try{let t=await n.json();e=t?.error||e}catch{}throw Error(e)}let s=await n.json(),o=s?.templateId;if(!o)throw Error("Template ID missing");await t(o,e,r,a)}async function a(e,r,a,i){let n=await fetch("/api/templates/resolve",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({action:e,slipType:i})});if(!n.ok){let e="Failed to resolve template";try{let t=await n.json();e=t?.error||e}catch{}throw Error(e)}let s=await n.json(),o=s?.templateId;if(!o)throw Error("Template ID missing");await t(o,e,{},a,r)}e.s(["downloadPdfAuto",()=>r,"downloadPdfAutoWithData",()=>a,"downloadPdfViaServer",()=>t])},287830,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(167881),i=e.i(970065),n=e.i(23750),s=e.i(10708),o=e.i(625959),c=e.i(630374),l=e.i(178583),d=e.i(878894),u=e.i(330843),m=e.i(929054),p=e.i(522016),h=e.i(120682),f=e.i(750769),v=e.i(643182);function g(){let[g,x]=(0,r.useState)(!0),[b,y]=(0,r.useState)(""),[j,N]=(0,r.useState)(!1),[C,w]=(0,r.useState)(!1),[S,k]=(0,r.useState)(!1),[D,P]=(0,r.useState)(null),[F,E]=(0,r.useState)(null),[I,T]=(0,r.useState)(!1),[B,O]=(0,r.useState)("standard"),{toast:L}=(0,h.useToast)(),[R,_]=(0,r.useState)(!1),[U,V]=(0,r.useState)(null),{price:$,isLoading:A,error:K,submitService:z}=(0,f.useDynamicPricing)("bvn","printout","default"),H=async()=>{if(!b||11!==b.length||!j||!C)return void L({title:"Validation Error",description:"Enter a valid 11-digit BVN and accept privacy/terms.",variant:"destructive"});let e=Number($||0);!Number.isFinite(e)||e<=0?L({title:"Pricing Unavailable",description:"Service price not available.",variant:"destructive"}):(V({amount:e,idempotencyKey:crypto.randomUUID(),bvn:b}),_(!0))},J=async e=>{_(!1),k(!0);try{let t=await z({...U,pin:e});if(!t.ok)return void(0,m.handleServiceError)(t,L,"BVN Printout Failed");let r=t.data;P(r?.data||null),E(r||null),T(!0),localStorage.setItem("ufriends_manual_services",JSON.stringify([...JSON.parse(localStorage.getItem("ufriends_manual_services")||"[]"),{id:crypto.randomUUID(),userId:"u_001",serviceType:"BVN Printout",formData:{bvn:b},price:U.amount,status:"Completed",result:r?.data,submittedAt:new Date().toISOString()}])),L({title:"Success!",description:"BVN printout retrieved and billed."})}catch(e){L({title:"Error",description:e?.message||"Verification failed",variant:"destructive"})}finally{k(!1)}},M=async()=>{try{await (0,v.downloadPdfAutoWithData)("bvn.printout",F||D||{},"bvn-printout",B),L({title:"Success",description:"Downloaded BVN printout"})}catch(t){try{let t=D||{},r=t.full_name||t.fullName||[t.first_name||t.firstName,t.last_name||t.lastName].filter(Boolean).join(" "),a=t.date_of_birth||t.dob||t.birthdate||"",i=t.bvn||b,n=new(await e.A(234162)).default;n.setFontSize(18),n.text("BVN Printout",90,15),n.setFontSize(10),n.text(`Name: ${r||""}`,15,30),n.text(`BVN: ${i}`,15,40),a&&n.text(`DOB: ${a}`,15,50),n.save(`bvn-printout-${Date.now()}.pdf`),L({title:"Downloaded",description:"Basic BVN printout generated"})}catch{L({title:"Error",description:t?.message||"Failed to generate PDF",variant:"destructive"})}}};return(0,t.jsxs)("div",{className:"min-h-screen bg-[#F9F7F3] p-4 md:p-8",children:[(0,t.jsx)(c.Dialog,{open:g,onOpenChange:x,children:(0,t.jsxs)(c.DialogContent,{className:"sm:max-w-lg",children:[(0,t.jsxs)(c.DialogHeader,{children:[(0,t.jsx)("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full border-2 border-[#3457D5] bg-[#CCCCFF]/20",children:(0,t.jsx)(d.AlertTriangle,{className:"h-8 w-8 text-[#3457D5]"})}),(0,t.jsx)(c.DialogTitle,{className:"text-center text-2xl font-bold",children:"Privacy & Data Protection Warning"}),(0,t.jsx)(c.DialogDescription,{className:"text-center text-sm leading-relaxed text-gray-600",children:"By using this service, you confirm legal authority to process this data and accept liability for misuse."})]}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(a.Button,{onClick:()=>x(!1),className:"bg-[#3457D5] px-8 text-white hover:bg-[#3457D5]/90",children:"I Understand & Accept"})})]})}),(0,t.jsx)("div",{className:"mx-auto max-w-3xl",children:(0,t.jsxs)(i.Card,{className:"border-[#CCCCFF]/30 shadow-lg",children:[(0,t.jsx)(i.CardHeader,{className:"bg-gradient-to-r from-[#3457D5]/5 to-[#CCCCFF]/10",children:(0,t.jsxs)(i.CardTitle,{className:"flex items-center text-[#3457D5]",children:[(0,t.jsx)(l.FileText,{className:"mr-2 h-5 w-5"})," BVN Printout"]})}),(0,t.jsxs)(i.CardContent,{className:"space-y-6 pt-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(s.Label,{htmlFor:"bvn",children:"BVN Number"}),(0,t.jsx)(n.Input,{id:"bvn",placeholder:"Enter 11-digit BVN",maxLength:11,value:b,onChange:e=>y(e.target.value.replace(/\D/g,"")),className:"mt-2 border-[#CCCCFF] focus:border-[#3457D5]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(s.Label,{children:"Slip Type"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("label",{className:"flex items-center space-x-2 border p-3 rounded-md cursor-pointer hover:bg-gray-50 transition-colors w-full",children:[(0,t.jsx)("input",{type:"radio",name:"slipType",value:"standard",checked:"standard"===B,onChange:()=>O("standard"),className:"accent-[#3457D5]"}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-medium",children:"Standard Slip"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"Regular A4 printout"})]})]}),(0,t.jsxs)("label",{className:"flex items-center space-x-2 border p-3 rounded-md cursor-pointer hover:bg-gray-50 transition-colors w-full",children:[(0,t.jsx)("input",{type:"radio",name:"slipType",value:"plastic",checked:"plastic"===B,onChange:()=>O("plastic"),className:"accent-[#3457D5]"}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-medium",children:"Plastic ID"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"ID Card format"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)(o.Checkbox,{id:"privacy",checked:j,onCheckedChange:e=>N(!0===e),className:"mt-1 border-[#3457D5] data-[state=checked]:bg-[#3457D5]"}),(0,t.jsxs)(s.Label,{htmlFor:"privacy",className:"cursor-pointer text-sm leading-relaxed",children:["I confirm I have legal authority to access this data and agree to the "," ",(0,t.jsx)(p.default,{href:"/privacy",className:"text-[#3457D5] hover:underline",children:"Privacy Policy"})]})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)(o.Checkbox,{id:"terms",checked:C,onCheckedChange:e=>w(!0===e),className:"mt-1 border-[#3457D5] data-[state=checked]:bg-[#3457D5]"}),(0,t.jsxs)(s.Label,{htmlFor:"terms",className:"cursor-pointer text-sm leading-relaxed",children:["I agree to the "," ",(0,t.jsx)(p.default,{href:"/terms",className:"text-[#3457D5] hover:underline",children:"Terms of Use"})," "," and understand the legal implications"]})]}),(0,t.jsx)(a.Button,{onClick:H,disabled:S||11!==b.length||!j||!C||A,className:"w-full bg-[#3457D5] py-6 text-base font-semibold text-white hover:bg-[#3457D5]/90",children:S?"Processing...":A?"Loading price...":`Submit - ₦${$??0}`}),I&&(0,t.jsx)(a.Button,{onClick:M,className:"w-full bg-green-600 py-6 text-base font-semibold text-white hover:bg-green-700",children:"Download BVN Printout (PDF)"}),K?(0,t.jsx)("p",{className:"text-sm text-red-600 mt-2",children:String(K)}):null]})]})}),(0,t.jsx)(u.PinPrompt,{isOpen:R,onClose:()=>_(!1),onConfirm:J,isLoading:S})]})}e.s(["default",()=>g])},234162,e=>{e.v(t=>Promise.all(["static/chunks/124edae34816cb73.js","static/chunks/6e0fcee41c7c776c.js"].map(t=>e.l(t))).then(()=>t(255749)))}]);