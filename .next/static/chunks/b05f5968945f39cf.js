(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,595468,e=>{"use strict";let t=(0,e.i(475254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],595468)},750769,e=>{"use strict";var t=e.i(271645),r=e.i(692659);function i(e){try{let t=String(e?.role||"").toLowerCase(),r=Array.isArray(e?.roles)?e.roles.map(e=>String(e).toLowerCase()):[];return t.includes("marketer")||r.includes("marketer")||e?.isMarketer===!0?"marketer":"user"}catch{return"user"}}async function a(){try{let e=await fetch("/api/me");if(!e.ok)return"user";let t=await e.json().catch(()=>null);return i(t?.user||t)}catch{return"user"}}function s(e,s,n,l,c){let[o,d]=(0,t.useState)(()=>i(c)),[u,m]=(0,t.useState)(null),[x,h]=(0,t.useState)(!1),[p,g]=(0,t.useState)(null),[f,j]=(0,t.useState)(void 0),v=(0,t.useMemo)(()=>({category:String(e||"").trim(),subservice:String(s||"").trim(),variant:String(n||"").trim()}),[e,s,n]),y=(0,t.useMemo)(()=>{if(!l||"object"!=typeof l)return"";let e=Object.entries(l).filter(([e,t])=>null!=t);return e.length?(e.sort(([e],[t])=>e.localeCompare(t)),e.map(([e,t])=>`${e}=${String(t)}`).join("|")):""},[l]);return(0,t.useEffect)(()=>{let e=!1;return(async()=>{h(!0),g(null);try{let t=c?i(c):await a();e||d(t);let r=[["category",v.category],["subservice",v.subservice],["variant",v.variant],["role",t]];if(l&&"object"==typeof l){let e=Object.entries(l).filter(([e,t])=>null!=t);for(let[t,i]of(e.sort(([e],[t])=>e.localeCompare(t)),e))r.push([t,String(i)])}let s=new URLSearchParams(r),n=await fetch(`/api/pricing?${s.toString()}`,{cache:"no-store"}),o=await n.json().catch(()=>null);if(!n.ok)throw Error(String(o?.error||"Failed to load pricing"));let u=o?.price;m("number"==typeof u?u:null)}catch(e){g(e?.message||"Failed to fetch pricing"),m(null)}finally{e||h(!1)}})(),()=>{e=!0}},[v.category,v.subservice,v.variant,y,c]),{price:u,isLoading:x,error:p,reference:f,submitService:(0,t.useCallback)(async e=>{try{let t={amount:Number(e.amount),idempotencyKey:"string"==typeof e.idempotencyKey?e.idempotencyKey:void 0,params:{...e||{}},subServiceId:v.variant||void 0,action:function(e,t){let r=e.trim().toLowerCase(),i=t.trim().toLowerCase();if("nin"===r){if("slip"===i)return"nin.slip";if("printout"===i)return"nin.printout";if("advanced"===i||"verification"===i)return"nin.advanced"}if("bvn"===r){if("printout"===i)return"bvn.printout";if("retrieval"===i||"retrieval_phone"===i)return"bvn.retrieval_phone";if("advanced"===i||"verification"===i)return"bvn.advanced"}if("cac"===r){if("info"===i)return"cac.info";if("status"===i)return"cac.status"}return"passport"===r&&("verify"===i||"verification"===i||"basic"===i)?"passport.verify":"phone"===r&&("advanced"===i||"verification"===i||"basic"===i)?"phone.verify_advanced":("driver-license"===r||"drivers_license"===r)&&("basic"===i||"verification"===i)?"drivers_license.verify":("voters-card"===r||"voters"===r)&&("basic"===i||"full"===i||"verification"===i)?"voters.verify":("plate-number"===r||"plate"===r)&&("basic"===i||"verification"===i)?"plate.verify":"tin"===r&&("basic"===i||"certificate"===i||"verification"===i)?"tin.verify":null}(v.category,v.subservice)||void 0,pin:e.pin},i=await (0,r.authFetch)(`/api/service/${encodeURIComponent(v.category)}/${encodeURIComponent(v.subservice)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}),a=await i.json().catch(()=>null);if(!i.ok)return{ok:!1,error:String(a?.error||`Service failed (${i.status})`),message:String(a?.message||"Failed"),data:a};return j(String(a?.reference||"")),{ok:!0,reference:String(a?.reference||""),message:String(a?.message||""),data:a}}catch(e){return{ok:!1,error:String(e?.message||e)}}},[v.category,v.subservice,v.variant])}}e.s(["default",0,s,"useDynamicPricing",()=>s])},330843,e=>{"use strict";var t=e.i(843476),r=e.i(271645),i=e.i(630374),a=e.i(167881),s=e.i(23750),n=e.i(10708),l=e.i(846696);function c({isOpen:e,onClose:c,onConfirm:o,isLoading:d}){let[u,m]=(0,r.useState)(""),x=()=>{4!==u.length?l.toast.error("Please enter a 4-digit PIN"):(o(u),m(""))};return(0,t.jsx)(i.Dialog,{open:e,onOpenChange:e=>!e&&c(),children:(0,t.jsxs)(i.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(i.DialogHeader,{children:[(0,t.jsx)(i.DialogTitle,{children:"Enter Transaction PIN"}),(0,t.jsx)(i.DialogDescription,{children:"Please enter your 4-digit transaction PIN to authorize this request."})]}),(0,t.jsx)("div",{className:"space-y-4 py-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"pin",className:"text-center block",children:"PIN"}),(0,t.jsx)(s.Input,{id:"pin",type:"password",inputMode:"numeric",maxLength:4,value:u,onChange:e=>m(e.target.value.replace(/\D/g,"")),className:"text-center text-2xl tracking-[1em]",placeholder:"••••",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&x()}})]})}),(0,t.jsxs)(i.DialogFooter,{children:[(0,t.jsx)(a.Button,{variant:"outline",onClick:c,disabled:d,children:"Cancel"}),(0,t.jsx)(a.Button,{onClick:x,disabled:d||4!==u.length,className:"bg-[#3457D5]",children:d?"Verifying...":"Confirm PIN"})]})]})})}e.s(["PinPrompt",()=>c])},929054,e=>{"use strict";function t(e,r,i="Error"){r({title:i,description:e.error||e.message||"An unexpected error occurred",variant:"destructive"})}e.s(["handleServiceError",()=>t])},39312,e=>{"use strict";let t=(0,e.i(475254).default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);e.s(["Zap",()=>t],39312)},635408,e=>{"use strict";let t=(0,e.i(475254).default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);e.s(["TrendingDown",()=>t],635408)},662031,e=>{"use strict";let t=(0,e.i(475254).default)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);e.s(["Share2",()=>t],662031)},920102,e=>{"use strict";var t=e.i(843476),r=e.i(271645),i=e.i(750769),a=e.i(970065),s=e.i(167881),n=e.i(23750),l=e.i(10708),c=e.i(62870),o=e.i(994179),d=e.i(671428),u=e.i(120682),m=e.i(846932),x=e.i(662031),h=e.i(252754),p=e.i(595468),g=e.i(39312),f=e.i(635408),j=e.i(630374),v=e.i(330843),y=e.i(929054);function b(){var e;let{toast:b}=(0,u.useToast)(),[N,S]=(0,r.useState)(""),[C,w]=(0,r.useState)(""),[D,k]=(0,r.useState)(""),[F,P]=(0,r.useState)(0),[T,I]=(0,r.useState)(0),[L,A]=(0,r.useState)(null),[B,M]=(0,r.useState)(!1),[$,E]=(0,r.useState)(!0),[U,O]=(0,r.useState)(!1),[K,R]=(0,r.useState)(!1),[_,Z]=(0,r.useState)(""),[q,V]=(0,r.useState)(!1),[W,z]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=localStorage.getItem("ufriends_wallet_balance");P(e?Number.parseFloat(e):0),setTimeout(()=>E(!1),800)},[]);let{price:G,isLoading:H,error:Y,submitService:J}=(0,i.default)("airtime","share-n-sell","",N?{network:({MTN:"mtn",Airtel:"airtel",Glo:"glo","9mobile":"9mobile"})[e=String(N)]||e.toLowerCase()}:void 0);(0,r.useEffect)(()=>{if(!N||!D){A(null),I(0);return}let e=Number.parseFloat(D)||0;M(!0);let t="number"==typeof G?Number(G):null;null!=t?(A(t),I(Math.max(0,Math.round(e+t)))):(A(null),I(0)),M(!1)},[N,D,G]);let Q=async()=>{N&&C&&D?11!==C.length?b({title:"Invalid Number",description:"Phone number must be 11 digits",variant:"destructive"}):50>Number.parseFloat(D)?b({title:"Amount Too Low",description:"Minimum airtime amount is ₦50",variant:"destructive"}):F<T?b({title:"Insufficient Balance",description:`Your wallet balance (₦${F.toLocaleString()}) is less than ₦${T.toLocaleString()}`,variant:"destructive"}):"number"!=typeof G?b({title:"Pricing Unavailable",description:"Live pricing could not be fetched.",variant:"destructive"}):(z({amount:Number.parseFloat(D),phone:C,network:N,idempotencyKey:crypto.randomUUID(),category:"airtime",action:"share-n-sell"}),V(!0)):b({title:"Missing Information",description:"Please fill in all fields",variant:"destructive"})},X=async e=>{V(!1),O(!0);try{let t=await J({...W,pin:e});if(!t?.ok)return void(0,y.handleServiceError)(t,b,"Transaction Failed");Z(t?.reference||`SNS-${Date.now()}`),R(!0),b({title:"Airtime Sent Successfully!",description:`₦${D} airtime sent to ${C}`}),S(""),w(""),k("")}catch(e){b({title:"Transaction Failed",description:e?.message||"Unable to complete purchase",variant:"destructive"})}finally{O(!1)}};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,t.jsxs)(m.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,t.jsx)("div",{className:"p-3 rounded-2xl bg-[#3457D5]/10",children:(0,t.jsx)(x.Share2,{className:"h-8 w-8 text-[#3457D5]"})}),(0,t.jsx)("h1",{className:"text-4xl font-bold text-foreground",children:"Share 'n Sell"})]}),(0,t.jsx)("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Buy airtime instantly from UFriends automated system with discounted rates"})]}),(0,t.jsx)(m.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1},children:(0,t.jsx)(a.Card,{className:"bg-gradient-to-r from-[#3457D5]/10 to-[#CCCCFF]/20 border-[#3457D5]/30",children:(0,t.jsx)(a.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 rounded-full bg-[#3457D5]/20",children:(0,t.jsx)(h.Wallet,{className:"h-5 w-5 text-[#3457D5]"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Wallet Balance"}),$?(0,t.jsx)(d.Skeleton,{className:"h-8 w-32 mt-1"}):(0,t.jsxs)("p",{className:"text-2xl font-bold text-[#3457D5]",children:["₦",F.toLocaleString()]})]})]}),(0,t.jsxs)(o.Badge,{className:"bg-[#3457D5] text-white",children:[(0,t.jsx)(g.Zap,{className:"h-3 w-3 mr-1"}),"Instant"]})]})})})}),(0,t.jsx)(m.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,t.jsxs)(a.Card,{className:"border-2 border-[#3457D5]/20",children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{className:"text-2xl",children:"Buy Airtime"}),(0,t.jsx)(a.CardDescription,{children:"Select network, enter recipient number and amount"})]}),(0,t.jsxs)(a.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"network",children:"Network Provider"}),(0,t.jsxs)(c.Select,{value:N,onValueChange:e=>S(e),children:[(0,t.jsx)(c.SelectTrigger,{id:"network",className:"border-[#3457D5]/30",children:(0,t.jsx)(c.SelectValue,{placeholder:"Choose network"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"MTN",children:"MTN"}),(0,t.jsx)(c.SelectItem,{value:"Airtel",children:"Airtel"}),(0,t.jsx)(c.SelectItem,{value:"Glo",children:"Glo"}),(0,t.jsx)(c.SelectItem,{value:"9mobile",children:"9mobile"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"recipient",children:"Recipient Phone Number"}),(0,t.jsx)(n.Input,{id:"recipient",type:"tel",placeholder:"08012345678",value:C,onChange:e=>w(e.target.value.replace(/\D/g,"").slice(0,11)),className:"border-[#3457D5]/30"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"amount",children:"Airtime Amount (₦)"}),(0,t.jsx)(n.Input,{id:"amount",type:"number",placeholder:"Enter amount",value:D,onChange:e=>k(e.target.value),className:"border-[#3457D5]/30"})]}),N&&D&&(0,t.jsxs)(m.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"p-4 rounded-xl bg-[#CCCCFF]/20 border border-[#3457D5]/20 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Airtime Value:"}),(0,t.jsxs)("span",{className:"font-semibold",children:["₦",Number.parseFloat(D).toLocaleString()]})]}),null!=L?(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(f.TrendingDown,{className:"h-4 w-4 text-green-600"}),"Service Fee:"]}),(0,t.jsx)("span",{className:"font-semibold",children:B?"Loading...":`₦${L.toLocaleString()}`})]}):(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Fetching live price…"}),(0,t.jsx)("span",{className:"font-semibold",children:B?"Loading...":"—"})]}),(0,t.jsxs)("div",{className:"pt-2 border-t border-[#3457D5]/20 flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium",children:"You Pay:"}),(0,t.jsxs)("span",{className:"text-2xl font-bold text-[#3457D5]",children:["₦",T.toLocaleString()]})]})]}),(0,t.jsx)(s.Button,{onClick:Q,disabled:U||!N||!C||!D,className:"w-full h-12 text-lg bg-[#3457D5] hover:bg-[#3457D5]/90",children:U?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.motion.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"mr-2",children:(0,t.jsx)(g.Zap,{className:"h-5 w-5"})}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Share2,{className:"mr-2 h-5 w-5"}),"Buy Airtime"]})})]})]})}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,t.jsx)(a.Card,{className:"border-[#3457D5]/20",children:(0,t.jsxs)(a.CardContent,{className:"pt-6 text-center space-y-2",children:[(0,t.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-[#3457D5]/10 flex items-center justify-center",children:(0,t.jsx)(g.Zap,{className:"h-6 w-6 text-[#3457D5]"})}),(0,t.jsx)("h3",{className:"font-semibold",children:"Instant Delivery"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Airtime sent within seconds"})]})}),(0,t.jsx)(a.Card,{className:"border-[#3457D5]/20",children:(0,t.jsxs)(a.CardContent,{className:"pt-6 text-center space-y-2",children:[(0,t.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-green-500/10 flex items-center justify-center",children:(0,t.jsx)(f.TrendingDown,{className:"h-6 w-6 text-green-600"})}),(0,t.jsx)("h3",{className:"font-semibold",children:"Discounted Rates"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Save up to 6% on every purchase"})]})}),(0,t.jsx)(a.Card,{className:"border-[#3457D5]/20",children:(0,t.jsxs)(a.CardContent,{className:"pt-6 text-center space-y-2",children:[(0,t.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-[#CCCCFF]/30 flex items-center justify-center",children:(0,t.jsx)(h.Wallet,{className:"h-6 w-6 text-[#3457D5]"})}),(0,t.jsx)("h3",{className:"font-semibold",children:"Wallet Payment"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Secure and convenient"})]})})]}),(0,t.jsx)(j.Dialog,{open:K,onOpenChange:R,children:(0,t.jsxs)(j.DialogContent,{className:"border-[#3457D5]/30",children:[(0,t.jsxs)(j.DialogHeader,{children:[(0,t.jsx)("div",{className:"mx-auto w-16 h-16 rounded-full bg-green-500/10 flex items-center justify-center mb-4",children:(0,t.jsx)(p.CheckCircle2,{className:"h-10 w-10 text-green-600"})}),(0,t.jsx)(j.DialogTitle,{className:"text-center text-2xl",children:"Transaction Successful!"}),(0,t.jsxs)(j.DialogDescription,{className:"text-center space-y-3 pt-4",children:[(0,t.jsxs)("p",{className:"text-base",children:["₦",D," airtime has been sent to ",(0,t.jsx)("strong",{children:C})]}),(0,t.jsxs)("div",{className:"p-3 bg-[#F9F7F3] rounded-lg",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Transaction ID"}),(0,t.jsx)("p",{className:"font-mono font-semibold text-[#3457D5]",children:_})]})]})]}),(0,t.jsx)(j.DialogFooter,{children:(0,t.jsx)(s.Button,{onClick:()=>R(!1),className:"w-full bg-[#3457D5]",children:"Done"})})]})}),(0,t.jsx)(v.PinPrompt,{isOpen:q,onClose:()=>V(!1),onConfirm:X,isLoading:U})]})}e.s(["default",()=>b])}]);