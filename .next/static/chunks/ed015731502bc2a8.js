(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,750769,e=>{"use strict";var i=e.i(271645),t=e.i(692659);function a(e){try{let i=String(e?.role||"").toLowerCase(),t=Array.isArray(e?.roles)?e.roles.map(e=>String(e).toLowerCase()):[];return i.includes("marketer")||t.includes("marketer")||e?.isMarketer===!0?"marketer":"user"}catch{return"user"}}async function s(){try{let e=await fetch("/api/me");if(!e.ok)return"user";let i=await e.json().catch(()=>null);return a(i?.user||i)}catch{return"user"}}function r(e,r,l,n,c){let[o,d]=(0,i.useState)(()=>a(c)),[m,u]=(0,i.useState)(null),[h,p]=(0,i.useState)(!1),[y,g]=(0,i.useState)(null),[x,v]=(0,i.useState)(void 0),b=(0,i.useMemo)(()=>({category:String(e||"").trim(),subservice:String(r||"").trim(),variant:String(l||"").trim()}),[e,r,l]),f=(0,i.useMemo)(()=>{if(!n||"object"!=typeof n)return"";let e=Object.entries(n).filter(([e,i])=>null!=i);return e.length?(e.sort(([e],[i])=>e.localeCompare(i)),e.map(([e,i])=>`${e}=${String(i)}`).join("|")):""},[n]);return(0,i.useEffect)(()=>{let e=!1;return(async()=>{p(!0),g(null);try{let i=c?a(c):await s();e||d(i);let t=[["category",b.category],["subservice",b.subservice],["variant",b.variant],["role",i]];if(n&&"object"==typeof n){let e=Object.entries(n).filter(([e,i])=>null!=i);for(let[i,a]of(e.sort(([e],[i])=>e.localeCompare(i)),e))t.push([i,String(a)])}let r=new URLSearchParams(t),l=await fetch(`/api/pricing?${r.toString()}`,{cache:"no-store"}),o=await l.json().catch(()=>null);if(!l.ok)throw Error(String(o?.error||"Failed to load pricing"));let m=o?.price;u("number"==typeof m?m:null)}catch(e){g(e?.message||"Failed to fetch pricing"),u(null)}finally{e||p(!1)}})(),()=>{e=!0}},[b.category,b.subservice,b.variant,f,c]),{price:m,isLoading:h,error:y,reference:x,submitService:(0,i.useCallback)(async e=>{try{let i={amount:Number(e.amount),idempotencyKey:"string"==typeof e.idempotencyKey?e.idempotencyKey:void 0,params:{...e||{}},subServiceId:b.variant||void 0,action:function(e,i){let t=e.trim().toLowerCase(),a=i.trim().toLowerCase();if("nin"===t){if("slip"===a)return"nin.slip";if("printout"===a)return"nin.printout";if("advanced"===a||"verification"===a)return"nin.advanced"}if("bvn"===t){if("printout"===a)return"bvn.printout";if("retrieval"===a||"retrieval_phone"===a)return"bvn.retrieval_phone";if("advanced"===a||"verification"===a)return"bvn.advanced"}if("cac"===t){if("info"===a)return"cac.info";if("status"===a)return"cac.status"}return"passport"===t&&("verify"===a||"verification"===a||"basic"===a)?"passport.verify":"phone"===t&&("advanced"===a||"verification"===a||"basic"===a)?"phone.verify_advanced":("driver-license"===t||"drivers_license"===t)&&("basic"===a||"verification"===a)?"drivers_license.verify":("voters-card"===t||"voters"===t)&&("basic"===a||"full"===a||"verification"===a)?"voters.verify":("plate-number"===t||"plate"===t)&&("basic"===a||"verification"===a)?"plate.verify":"tin"===t&&("basic"===a||"certificate"===a||"verification"===a)?"tin.verify":null}(b.category,b.subservice)||void 0,pin:e.pin},a=await (0,t.authFetch)(`/api/service/${encodeURIComponent(b.category)}/${encodeURIComponent(b.subservice)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(i)}),s=await a.json().catch(()=>null);if(!a.ok)return{ok:!1,error:String(s?.error||`Service failed (${a.status})`),message:String(s?.message||"Failed"),data:s};return v(String(s?.reference||"")),{ok:!0,reference:String(s?.reference||""),message:String(s?.message||""),data:s}}catch(e){return{ok:!1,error:String(e?.message||e)}}},[b.category,b.subservice,b.variant])}}e.s(["default",0,r,"useDynamicPricing",()=>r])},330843,e=>{"use strict";var i=e.i(843476),t=e.i(271645),a=e.i(630374),s=e.i(167881),r=e.i(23750),l=e.i(10708),n=e.i(846696);function c({isOpen:e,onClose:c,onConfirm:o,isLoading:d}){let[m,u]=(0,t.useState)(""),h=()=>{4!==m.length?n.toast.error("Please enter a 4-digit PIN"):(o(m),u(""))};return(0,i.jsx)(a.Dialog,{open:e,onOpenChange:e=>!e&&c(),children:(0,i.jsxs)(a.DialogContent,{className:"sm:max-w-md",children:[(0,i.jsxs)(a.DialogHeader,{children:[(0,i.jsx)(a.DialogTitle,{children:"Enter Transaction PIN"}),(0,i.jsx)(a.DialogDescription,{children:"Please enter your 4-digit transaction PIN to authorize this request."})]}),(0,i.jsx)("div",{className:"space-y-4 py-4",children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(l.Label,{htmlFor:"pin",className:"text-center block",children:"PIN"}),(0,i.jsx)(r.Input,{id:"pin",type:"password",inputMode:"numeric",maxLength:4,value:m,onChange:e=>u(e.target.value.replace(/\D/g,"")),className:"text-center text-2xl tracking-[1em]",placeholder:"••••",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&h()}})]})}),(0,i.jsxs)(a.DialogFooter,{children:[(0,i.jsx)(s.Button,{variant:"outline",onClick:c,disabled:d,children:"Cancel"}),(0,i.jsx)(s.Button,{onClick:h,disabled:d||4!==m.length,className:"bg-[#3457D5]",children:d?"Verifying...":"Confirm PIN"})]})]})})}e.s(["PinPrompt",()=>c])},595468,e=>{"use strict";let i=(0,e.i(475254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>i],595468)},448361,e=>{"use strict";var i=e.i(843476),t=e.i(271645),a=e.i(167881),s=e.i(970065),r=e.i(23750),l=e.i(10708),n=e.i(62870),c=e.i(671428),o=e.i(120682),d=e.i(553475),m=e.i(252754),u=e.i(595468),h=e.i(846932),p=e.i(88653),y=e.i(750769),g=e.i(630374);let x="ufriends_ui_metrics";async function v(i,t={}){let a=performance.now(),s=await (await e.A(377642)).authFetch(i,t),r=performance.now()-a;var l={path:i,ok:s.ok,status:s.status,durationMs:r,timestamp:Date.now()};try{let e=JSON.parse(localStorage.getItem(x)||"[]");e.push(l);let i=e.slice(Math.max(0,e.length-500));localStorage.setItem(x,JSON.stringify(i))}catch{}return s}var b=e.i(330843);let f={MTN:[{id:"mtn-500mb",name:"500MB",size:"500MB",price:150,validity:"30 days"},{id:"mtn-1gb",name:"1GB",size:"1GB",price:280,validity:"30 days"},{id:"mtn-2gb",name:"2GB",size:"2GB",price:560,validity:"30 days"},{id:"mtn-3gb",name:"3GB",size:"3GB",price:840,validity:"30 days"},{id:"mtn-4gb",name:"4GB",size:"4GB",price:1120,validity:"30 days"},{id:"mtn-5gb",name:"5GB",size:"5GB",price:1400,validity:"30 days"},{id:"mtn-10gb",name:"10GB",size:"10GB",price:2800,validity:"30 days"}],Airtel:[{id:"airtel-500mb",name:"500MB",size:"500MB",price:140,validity:"30 days"},{id:"airtel-1gb",name:"1GB",size:"1GB",price:270,validity:"30 days"},{id:"airtel-2gb",name:"2GB",size:"2GB",price:540,validity:"30 days"},{id:"airtel-3gb",name:"3GB",size:"3GB",price:810,validity:"30 days"},{id:"airtel-4gb",name:"4GB",size:"4GB",price:1080,validity:"30 days"},{id:"airtel-5gb",name:"5GB",size:"5GB",price:1350,validity:"30 days"},{id:"airtel-10gb",name:"10GB",size:"10GB",price:2700,validity:"30 days"}],Glo:[{id:"glo-500mb",name:"500MB",size:"500MB",price:130,validity:"30 days"},{id:"glo-1gb",name:"1GB",size:"1GB",price:250,validity:"30 days"},{id:"glo-2gb",name:"2GB",size:"2GB",price:500,validity:"30 days"},{id:"glo-3gb",name:"3GB",size:"3GB",price:750,validity:"30 days"},{id:"glo-4gb",name:"4GB",size:"4GB",price:1e3,validity:"30 days"},{id:"glo-5gb",name:"5GB",size:"5GB",price:1250,validity:"30 days"},{id:"glo-10gb",name:"10GB",size:"10GB",price:2500,validity:"30 days"}],"9mobile":[{id:"9mobile-500mb",name:"500MB",size:"500MB",price:120,validity:"30 days"},{id:"9mobile-1gb",name:"1GB",size:"1GB",price:240,validity:"30 days"},{id:"9mobile-2gb",name:"2GB",size:"2GB",price:480,validity:"30 days"},{id:"9mobile-3gb",name:"3GB",size:"3GB",price:720,validity:"30 days"},{id:"9mobile-4gb",name:"4GB",size:"4GB",price:960,validity:"30 days"},{id:"9mobile-5gb",name:"5GB",size:"5GB",price:1200,validity:"30 days"},{id:"9mobile-10gb",name:"10GB",size:"10GB",price:2400,validity:"30 days"}]};function j(){let[e,x]=(0,t.useState)(!0),[j,N]=(0,t.useState)(!1),[C,S]=(0,t.useState)(0),[B,w]=(0,t.useState)(""),[G,D]=(0,t.useState)(null),F=B&&G?`${B.toLowerCase()}.${G.size.toLowerCase()}`:"",{price:z,isLoading:P,error:k,submitService:I}=(0,y.default)("data","sme",F,{network:B,size:G?.size||""}),[L,M]=(0,t.useState)(""),[T,$]=(0,t.useState)(!1),[A,O]=(0,t.useState)(""),[_,E]=(0,t.useState)(!1),{toast:U}=(0,o.useToast)();(0,t.useEffect)(()=>{let e=localStorage.getItem("ufriends_wallet_balance");S(e?Number.parseFloat(e):0),(async()=>{try{let e=await v("/api/wallet/balance");if(e.ok){let i=await e.json().catch(()=>({})),t=Number(i?.balance??0),a=Number.isFinite(t)?t:0;S(a);try{localStorage.setItem("ufriends_wallet_balance",String(a))}catch{}}}catch{}finally{x(!1)}})()},[]);let R=B&&f[B]||[];G&&G.price;let K="number"==typeof z?Math.round(z):null,V=async e=>{(e.preventDefault(),B&&G&&L)?11!==L.length?U({title:"Invalid Phone Number",description:"Phone number must be 11 digits",variant:"destructive"}):null==K?U({title:"Pricing unavailable",description:"Please wait for live price to load",variant:"destructive"}):C<K?U({title:"Insufficient Balance",description:`You need ₦${K.toLocaleString()} but have ₦${C.toLocaleString()}`,variant:"destructive"}):($(!1),E(!0)):U({title:"Missing Information",description:"Please fill in all required fields",variant:"destructive"})},q=async e=>{E(!1),N(!0);try{let i=await I({amount:K,phone:L,network:B,planCode:G?.size,pin:e});if(!i.ok)throw Error(i?.error||i?.message||"Request failed");O(i?.reference||crypto.randomUUID()),N(!1),$(!0),U({title:"Purchase Successful",description:`${G?.size} sent to ${L}`})}catch(e){N(!1),U({title:"Data Purchase Failed",description:e instanceof Error?e.message:"Failed to process request. Please try again.",variant:"destructive"})}};return e?(0,i.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,i.jsx)(c.Skeleton,{className:"h-32 w-full"}),(0,i.jsx)(c.Skeleton,{className:"h-96 w-full"})]}):(0,i.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,i.jsxs)(h.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[(0,i.jsxs)("div",{className:"flex items-center justify-center mb-4",children:[(0,i.jsx)(d.Wifi,{className:"h-12 w-12 text-[#3457D5] mr-3"}),(0,i.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"SME Data"})]}),(0,i.jsx)("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Affordable SME data bundles at wholesale prices"})]}),(0,i.jsx)("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:(0,i.jsx)(h.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,i.jsxs)(s.Card,{className:"bg-gradient-to-br from-[#3457D5] to-[#CCCCFF] text-white",children:[(0,i.jsx)(s.CardHeader,{children:(0,i.jsxs)(s.CardTitle,{className:"flex items-center text-white",children:[(0,i.jsx)(m.Wallet,{className:"h-5 w-5 mr-2"}),"Wallet Balance"]})}),(0,i.jsx)(s.CardContent,{children:(0,i.jsxs)("p",{className:"text-3xl font-bold",children:["₦",C.toLocaleString()]})})]})})}),(0,i.jsx)(h.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,i.jsxs)(s.Card,{className:"shadow-lg border-[#CCCCFF]",children:[(0,i.jsxs)(s.CardHeader,{className:"bg-[#F9F7F3]",children:[(0,i.jsx)(s.CardTitle,{className:"text-[#3457D5]",children:"Purchase SME Data"}),(0,i.jsx)(s.CardDescription,{children:"Get discounted data bundles instantly"})]}),(0,i.jsx)(s.CardContent,{className:"pt-6",children:(0,i.jsxs)("form",{onSubmit:V,className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(l.Label,{htmlFor:"network",children:"Select Network *"}),(0,i.jsxs)(n.Select,{value:B,onValueChange:w,children:[(0,i.jsx)(n.SelectTrigger,{className:"border-[#CCCCFF] focus:ring-[#3457D5]",children:(0,i.jsx)(n.SelectValue,{placeholder:"Choose network"})}),(0,i.jsxs)(n.SelectContent,{children:[(0,i.jsx)(n.SelectItem,{value:"MTN",children:"MTN"}),(0,i.jsx)(n.SelectItem,{value:"Airtel",children:"Airtel"}),(0,i.jsx)(n.SelectItem,{value:"Glo",children:"Glo"}),(0,i.jsx)(n.SelectItem,{value:"9mobile",children:"9mobile"})]})]})]}),(0,i.jsx)(p.AnimatePresence,{mode:"wait",children:B&&(0,i.jsxs)(h.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[(0,i.jsx)(l.Label,{htmlFor:"plan",children:"Select Data Plan *"}),(0,i.jsxs)(n.Select,{value:G?.id||"",onValueChange:e=>{D(R.find(i=>i.id===e)||null)},children:[(0,i.jsx)(n.SelectTrigger,{className:"border-[#CCCCFF] focus:ring-[#3457D5]",children:(0,i.jsx)(n.SelectValue,{placeholder:"Choose data plan"})}),(0,i.jsx)(n.SelectContent,{children:R.map(e=>(0,i.jsxs)(n.SelectItem,{value:e.id,children:[e.name," (",e.validity,")"]},e.id))})]}),G&&(0,i.jsx)("div",{className:"mt-3 text-sm text-gray-700",children:(0,i.jsxs)("p",{children:["Price: ",P?"Loading...":null!=K?`₦${K.toLocaleString()}`:"Unavailable"]})})]})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(l.Label,{htmlFor:"recipientNumber",children:"Recipient Phone Number *"}),(0,i.jsx)(r.Input,{id:"recipientNumber",type:"tel",placeholder:"08012345678",value:L,onChange:e=>M(e.target.value.replace(/\D/g,"").slice(0,11)),maxLength:11,className:"border-[#CCCCFF] focus:ring-[#3457D5]"})]}),G&&(0,i.jsxs)(h.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-4 bg-[#F9F7F3] rounded-lg border border-[#CCCCFF]",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"Data Plan:"}),(0,i.jsx)("span",{className:"font-semibold",children:G.size})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"Validity:"}),(0,i.jsx)("span",{className:"font-semibold",children:G.validity})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center text-lg font-bold text-[#3457D5]",children:[(0,i.jsx)("span",{children:"Total Amount:"}),(0,i.jsx)("span",{children:P?"Loading...":null!=K?`₦${K.toLocaleString()}`:"Unavailable"})]})]}),(0,i.jsx)(a.Button,{type:"submit",disabled:j||P||null==K||!B||!G||!L,className:"w-full bg-[#3457D5] hover:bg-[#2a4ab0] text-white",children:j?"Processing...":"Buy Data"})]})})]})}),(0,i.jsx)(g.Dialog,{open:T,onOpenChange:$,children:(0,i.jsxs)(g.DialogContent,{className:"border-[#CCCCFF]",children:[(0,i.jsxs)(g.DialogHeader,{children:[(0,i.jsx)("div",{className:"flex justify-center mb-4",children:(0,i.jsx)("div",{className:"rounded-full bg-green-100 p-3",children:(0,i.jsx)(u.CheckCircle2,{className:"h-12 w-12 text-green-600"})})}),(0,i.jsx)(g.DialogTitle,{className:"text-center text-2xl text-[#3457D5]",children:"Purchase Successful!"}),(0,i.jsxs)(g.DialogDescription,{className:"text-center space-y-4 pt-4",children:[(0,i.jsxs)("div",{className:"bg-[#F9F7F3] p-4 rounded-lg space-y-2",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"Transaction ID:"}),(0,i.jsx)("span",{className:"font-semibold",children:A})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"Network:"}),(0,i.jsx)("span",{className:"font-semibold",children:B})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"Data Plan:"}),(0,i.jsx)("span",{className:"font-semibold",children:G?.size})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"Recipient:"}),(0,i.jsx)("span",{className:"font-semibold",children:L})]}),(0,i.jsxs)("div",{className:"flex justify-between text-lg font-bold text-[#3457D5]",children:[(0,i.jsx)("span",{children:"Amount Paid:"}),(0,i.jsx)("span",{children:P?"Loading...":null!=K?`₦${K.toLocaleString()}`:"Unavailable"})]})]}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Data will be delivered within 5 minutes"})]})]}),(0,i.jsx)(a.Button,{onClick:()=>{w(""),D(null),M(""),$(!1),O("")},className:"w-full bg-[#3457D5] hover:bg-[#2a4ab0]",children:"Make Another Purchase"})]})}),(0,i.jsx)(b.PinPrompt,{isOpen:_,onClose:()=>E(!1),onConfirm:q,isLoading:j})]})}e.s(["default",()=>j],448361)},377642,e=>{e.v(e=>Promise.resolve().then(()=>e(692659)))}]);