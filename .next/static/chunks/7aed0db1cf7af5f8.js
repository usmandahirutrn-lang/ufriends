(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,750769,e=>{"use strict";var t=e.i(271645),r=e.i(692659);function i(e){try{let t=String(e?.role||"").toLowerCase(),r=Array.isArray(e?.roles)?e.roles.map(e=>String(e).toLowerCase()):[];return t.includes("marketer")||r.includes("marketer")||e?.isMarketer===!0?"marketer":"user"}catch{return"user"}}async function n(){try{let e=await fetch("/api/me");if(!e.ok)return"user";let t=await e.json().catch(()=>null);return i(t?.user||t)}catch{return"user"}}function a(e,a,s,l,c){let[o,d]=(0,t.useState)(()=>i(c)),[u,m]=(0,t.useState)(null),[h,p]=(0,t.useState)(!1),[f,v]=(0,t.useState)(null),[x,g]=(0,t.useState)(void 0),j=(0,t.useMemo)(()=>({category:String(e||"").trim(),subservice:String(a||"").trim(),variant:String(s||"").trim()}),[e,a,s]),b=(0,t.useMemo)(()=>{if(!l||"object"!=typeof l)return"";let e=Object.entries(l).filter(([e,t])=>null!=t);return e.length?(e.sort(([e],[t])=>e.localeCompare(t)),e.map(([e,t])=>`${e}=${String(t)}`).join("|")):""},[l]);return(0,t.useEffect)(()=>{let e=!1;return(async()=>{p(!0),v(null);try{let t=c?i(c):await n();e||d(t);let r=[["category",j.category],["subservice",j.subservice],["variant",j.variant],["role",t]];if(l&&"object"==typeof l){let e=Object.entries(l).filter(([e,t])=>null!=t);for(let[t,i]of(e.sort(([e],[t])=>e.localeCompare(t)),e))r.push([t,String(i)])}let a=new URLSearchParams(r),s=await fetch(`/api/pricing?${a.toString()}`,{cache:"no-store"}),o=await s.json().catch(()=>null);if(!s.ok)throw Error(String(o?.error||"Failed to load pricing"));let u=o?.price;m("number"==typeof u?u:null)}catch(e){v(e?.message||"Failed to fetch pricing"),m(null)}finally{e||p(!1)}})(),()=>{e=!0}},[j.category,j.subservice,j.variant,b,c]),{price:u,isLoading:h,error:f,reference:x,submitService:(0,t.useCallback)(async e=>{try{let t={amount:Number(e.amount),idempotencyKey:"string"==typeof e.idempotencyKey?e.idempotencyKey:void 0,params:{...e||{}},subServiceId:j.variant||void 0,action:function(e,t){let r=e.trim().toLowerCase(),i=t.trim().toLowerCase();if("nin"===r){if("slip"===i)return"nin.slip";if("printout"===i)return"nin.printout";if("advanced"===i||"verification"===i)return"nin.advanced"}if("bvn"===r){if("printout"===i)return"bvn.printout";if("retrieval"===i||"retrieval_phone"===i)return"bvn.retrieval_phone";if("advanced"===i||"verification"===i)return"bvn.advanced"}if("cac"===r){if("info"===i)return"cac.info";if("status"===i)return"cac.status"}return"passport"===r&&("verify"===i||"verification"===i||"basic"===i)?"passport.verify":"phone"===r&&("advanced"===i||"verification"===i||"basic"===i)?"phone.verify_advanced":("driver-license"===r||"drivers_license"===r)&&("basic"===i||"verification"===i)?"drivers_license.verify":("voters-card"===r||"voters"===r)&&("basic"===i||"full"===i||"verification"===i)?"voters.verify":("plate-number"===r||"plate"===r)&&("basic"===i||"verification"===i)?"plate.verify":"tin"===r&&("basic"===i||"certificate"===i||"verification"===i)?"tin.verify":null}(j.category,j.subservice)||void 0,pin:e.pin},i=await (0,r.authFetch)(`/api/service/${encodeURIComponent(j.category)}/${encodeURIComponent(j.subservice)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}),n=await i.json().catch(()=>null);if(!i.ok)return{ok:!1,error:String(n?.error||`Service failed (${i.status})`),message:String(n?.message||"Failed"),data:n};return g(String(n?.reference||"")),{ok:!0,reference:String(n?.reference||""),message:String(n?.message||""),data:n}}catch(e){return{ok:!1,error:String(e?.message||e)}}},[j.category,j.subservice,j.variant])}}e.s(["default",0,a,"useDynamicPricing",()=>a])},330843,e=>{"use strict";var t=e.i(843476),r=e.i(271645),i=e.i(630374),n=e.i(167881),a=e.i(23750),s=e.i(10708),l=e.i(846696);function c({isOpen:e,onClose:c,onConfirm:o,isLoading:d}){let[u,m]=(0,r.useState)(""),h=()=>{4!==u.length?l.toast.error("Please enter a 4-digit PIN"):(o(u),m(""))};return(0,t.jsx)(i.Dialog,{open:e,onOpenChange:e=>!e&&c(),children:(0,t.jsxs)(i.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(i.DialogHeader,{children:[(0,t.jsx)(i.DialogTitle,{children:"Enter Transaction PIN"}),(0,t.jsx)(i.DialogDescription,{children:"Please enter your 4-digit transaction PIN to authorize this request."})]}),(0,t.jsx)("div",{className:"space-y-4 py-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(s.Label,{htmlFor:"pin",className:"text-center block",children:"PIN"}),(0,t.jsx)(a.Input,{id:"pin",type:"password",inputMode:"numeric",maxLength:4,value:u,onChange:e=>m(e.target.value.replace(/\D/g,"")),className:"text-center text-2xl tracking-[1em]",placeholder:"••••",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&h()}})]})}),(0,t.jsxs)(i.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:c,disabled:d,children:"Cancel"}),(0,t.jsx)(n.Button,{onClick:h,disabled:d||4!==u.length,className:"bg-[#3457D5]",children:d?"Verifying...":"Confirm PIN"})]})]})})}e.s(["PinPrompt",()=>c])},595468,e=>{"use strict";let t=(0,e.i(475254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],595468)},404579,e=>{"use strict";var t=e.i(843476),r=e.i(271645),i=e.i(970065),n=e.i(167881),a=e.i(23750),s=e.i(10708),l=e.i(62870),c=e.i(826707),o=e.i(595468),d=e.i(120682),u=e.i(692659),m=e.i(750769),h=e.i(330843),p=e.i(618566);function f(){var e;let[f,v]=(0,r.useState)(""),[x,g]=(0,r.useState)(""),[j,b]=(0,r.useState)(""),[y,S]=(0,r.useState)(!1),[N,C]=(0,r.useState)(null),[w,k]=(0,r.useState)(!1);(0,p.useRouter)();let{toast:L}=(0,d.useToast)(),{price:P,isLoading:R,error:I,submitService:T}=(0,m.useDynamicPricing)("airtime","vtu","",f?{network:({MTN:"mtn",GLO:"glo",AIRTEL:"airtel","9MOBILE":"9mobile"})[e=f]||e.toLowerCase()}:void 0),[E,A]=(0,r.useState)(null),[D,F]=(0,r.useState)(!1),B=async e=>{(e.preventDefault(),!f||!x||!j||0>=Number(j))?L({title:"Missing details",description:"Fill network, phone and amount",variant:"destructive"}):k(!0)},O=async e=>{k(!1),S(!0),C(null),A(null);try{let t=await T({amount:Number(j),params:{phone:x,network:f},phone:x,network:f,pin:e});if(!t.ok)throw Error(t.error||"Airtime purchase failed");C({reference:String(t.reference||""),providerRef:String(t.data?.providerRef||"")||void 0}),L({title:"Airtime purchased",description:`Ref: ${String(t.reference||"")}.
      Viewing details below.`})}catch(e){console.error("API Error:",e),L({title:"Airtime Purchase Failed",description:e?.message||e?.error||"Failed to process request. Please try again.",variant:"destructive"})}finally{S(!1)}};return(0,r.useEffect)(()=>{},[f]),(0,r.useEffect)(()=>{N?.reference&&(async()=>{try{F(!0);let e=await (0,u.authFetch)(`/api/service/status/${encodeURIComponent(N.reference)}`),t=await e.json().catch(()=>null);e.ok&&t?.ok?A({status:String(t.status||"SUCCESS"),amount:Number(t.amount||0),wallet:t.wallet||null,meta:t.meta||{}}):(A(null),L({title:"Receipt unavailable",description:String(t?.error||"Unable to fetch status")}))}catch(e){A(null),L({title:"Receipt fetch failed",description:String(e)})}finally{F(!1)}})()},[N?.reference]),(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,t.jsx)(c.Smartphone,{className:"h-6 w-6 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Airtime VTU"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Buy instant airtime on all networks"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,t.jsxs)(i.Card,{children:[(0,t.jsxs)(i.CardHeader,{children:[(0,t.jsx)(i.CardTitle,{children:"Buy Airtime"}),(0,t.jsx)(i.CardDescription,{children:"Enter phone, network and amount"})]}),(0,t.jsxs)(i.CardContent,{children:[(0,t.jsxs)("form",{className:"space-y-4",onSubmit:B,children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(s.Label,{children:"Network"}),(0,t.jsxs)(l.Select,{value:f,onValueChange:v,children:[(0,t.jsx)(l.SelectTrigger,{children:(0,t.jsx)(l.SelectValue,{placeholder:"Select network"})}),(0,t.jsxs)(l.SelectContent,{children:[(0,t.jsx)(l.SelectItem,{value:"MTN",children:"MTN"}),(0,t.jsx)(l.SelectItem,{value:"GLO",children:"GLO"}),(0,t.jsx)(l.SelectItem,{value:"AIRTEL",children:"AIRTEL"}),(0,t.jsx)(l.SelectItem,{value:"9MOBILE",children:"9MOBILE"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(s.Label,{children:"Phone Number"}),(0,t.jsx)(a.Input,{value:x,onChange:e=>g(e.target.value),placeholder:"08012345678"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(s.Label,{children:"Amount (₦)"}),(0,t.jsx)(a.Input,{type:"number",value:j,onChange:e=>b(Number(e.target.value)),placeholder:"100"})]}),f?(0,t.jsxs)("div",{className:"bg-[#CCCCFF]/20 p-3 rounded-lg text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Service Fee"}),(0,t.jsx)("span",{children:R?"Loading...":`₦${Number(P||0).toLocaleString()}`})]}),(0,t.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,t.jsx)("span",{children:"Total Payable"}),(0,t.jsxs)("span",{children:["₦",((Number(j)||0)+Number(P||0)).toLocaleString()]})]})]}):null,(0,t.jsx)(n.Button,{className:"w-full",type:"submit",disabled:y,children:y?"Processing...":"Purchase Airtime"})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)(s.Label,{children:"Quick Amounts"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-3 mt-2",children:[100,200,500,1e3,2e3].map(e=>(0,t.jsxs)(n.Button,{variant:"outline",onClick:()=>b(e),children:["₦",e]},e))})]}),N&&(0,t.jsxs)("div",{className:"mt-6 p-3 rounded-lg bg-green-50 border border-green-200 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 font-medium text-green-700",children:[(0,t.jsx)(o.CheckCircle2,{className:"h-5 w-5"})," Purchase successful"]}),(0,t.jsxs)("div",{className:"mt-1 text-green-700",children:["Reference: ",N.reference]}),N.providerRef?(0,t.jsxs)("div",{className:"text-green-700",children:["Provider Ref: ",N.providerRef]}):null,(0,t.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,t.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>navigator.clipboard.writeText(N.reference),children:"Copy Reference"}),(0,t.jsx)(n.Button,{size:"sm",variant:"secondary",disabled:D,onClick:()=>{A(null),F(!0),(0,u.authFetch)(`/api/service/status/${encodeURIComponent(N.reference)}`).then(e=>e.json()).then(e=>{e?.ok?A({status:String(e.status||"SUCCESS"),amount:Number(e.amount||0),wallet:e.wallet||null,meta:e.meta||{}}):L({title:"Receipt unavailable",description:String(e?.error||"Unable to fetch status")})}).catch(e=>L({title:"Receipt fetch failed",description:String(e)})).finally(()=>F(!1))},children:D?"Loading...":"View Details"})]}),E&&(0,t.jsxs)("div",{className:"mt-3 bg-white border rounded p-3 text-green-700",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Status"}),(0,t.jsx)("span",{className:"font-medium",children:E.status})]}),(0,t.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,t.jsx)("span",{children:"Amount"}),(0,t.jsxs)("span",{className:"font-medium",children:["₦",Number(E.amount||0).toLocaleString()]})]}),E.wallet?(0,t.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,t.jsx)("span",{children:"Wallet Balance"}),(0,t.jsxs)("span",{className:"font-medium",children:["₦",Number(E.wallet.balance||0).toLocaleString()]})]}):null,E.meta?.providerRef?(0,t.jsxs)("div",{className:"mt-1",children:[(0,t.jsx)("span",{children:"Provider Ref:"})," ",String(E.meta.providerRef)]}):null]})]})]})]}),(0,t.jsxs)(i.Card,{children:[(0,t.jsxs)(i.CardHeader,{children:[(0,t.jsx)(i.CardTitle,{children:"Tips"}),(0,t.jsx)(i.CardDescription,{children:"Ensure correct phone and network"})]}),(0,t.jsx)(i.CardContent,{children:(0,t.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-2",children:[(0,t.jsx)("li",{children:"Use the exact network your SIM is on."}),(0,t.jsx)("li",{children:"Double-check phone number before submitting."}),(0,t.jsx)("li",{children:"Your wallet will be debited after a successful purchase."})]})})]})]}),(0,t.jsx)(h.PinPrompt,{isOpen:w,onClose:()=>k(!1),onConfirm:O,isLoading:y})]})}e.s(["default",()=>f])}]);