(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,595468,e=>{"use strict";let t=(0,e.i(475254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],595468)},750769,e=>{"use strict";var t=e.i(271645),a=e.i(692659);function s(e){try{let t=String(e?.role||"").toLowerCase(),a=Array.isArray(e?.roles)?e.roles.map(e=>String(e).toLowerCase()):[];return t.includes("marketer")||a.includes("marketer")||e?.isMarketer===!0?"marketer":"user"}catch{return"user"}}async function r(){try{let e=await fetch("/api/me");if(!e.ok)return"user";let t=await e.json().catch(()=>null);return s(t?.user||t)}catch{return"user"}}function i(e,i,l,n,c){let[o,d]=(0,t.useState)(()=>s(c)),[m,u]=(0,t.useState)(null),[x,p]=(0,t.useState)(!1),[h,v]=(0,t.useState)(null),[g,f]=(0,t.useState)(void 0),j=(0,t.useMemo)(()=>({category:String(e||"").trim(),subservice:String(i||"").trim(),variant:String(l||"").trim()}),[e,i,l]),b=(0,t.useMemo)(()=>{if(!n||"object"!=typeof n)return"";let e=Object.entries(n).filter(([e,t])=>null!=t);return e.length?(e.sort(([e],[t])=>e.localeCompare(t)),e.map(([e,t])=>`${e}=${String(t)}`).join("|")):""},[n]);return(0,t.useEffect)(()=>{let e=!1;return(async()=>{p(!0),v(null);try{let t=c?s(c):await r();e||d(t);let a=[["category",j.category],["subservice",j.subservice],["variant",j.variant],["role",t]];if(n&&"object"==typeof n){let e=Object.entries(n).filter(([e,t])=>null!=t);for(let[t,s]of(e.sort(([e],[t])=>e.localeCompare(t)),e))a.push([t,String(s)])}let i=new URLSearchParams(a),l=await fetch(`/api/pricing?${i.toString()}`,{cache:"no-store"}),o=await l.json().catch(()=>null);if(!l.ok)throw Error(String(o?.error||"Failed to load pricing"));let m=o?.price;u("number"==typeof m?m:null)}catch(e){v(e?.message||"Failed to fetch pricing"),u(null)}finally{e||p(!1)}})(),()=>{e=!0}},[j.category,j.subservice,j.variant,b,c]),{price:m,isLoading:x,error:h,reference:g,submitService:(0,t.useCallback)(async e=>{try{let t={amount:Number(e.amount),idempotencyKey:"string"==typeof e.idempotencyKey?e.idempotencyKey:void 0,params:{...e||{}},subServiceId:j.variant||void 0,action:function(e,t){let a=e.trim().toLowerCase(),s=t.trim().toLowerCase();if("nin"===a){if("slip"===s)return"nin.slip";if("printout"===s)return"nin.printout";if("advanced"===s||"verification"===s)return"nin.advanced"}if("bvn"===a){if("printout"===s)return"bvn.printout";if("retrieval"===s||"retrieval_phone"===s)return"bvn.retrieval_phone";if("advanced"===s||"verification"===s)return"bvn.advanced"}if("cac"===a){if("info"===s)return"cac.info";if("status"===s)return"cac.status"}return"passport"===a&&("verify"===s||"verification"===s||"basic"===s)?"passport.verify":"phone"===a&&("advanced"===s||"verification"===s||"basic"===s)?"phone.verify_advanced":("driver-license"===a||"drivers_license"===a)&&("basic"===s||"verification"===s)?"drivers_license.verify":("voters-card"===a||"voters"===a)&&("basic"===s||"full"===s||"verification"===s)?"voters.verify":("plate-number"===a||"plate"===a)&&("basic"===s||"verification"===s)?"plate.verify":"tin"===a&&("basic"===s||"certificate"===s||"verification"===s)?"tin.verify":null}(j.category,j.subservice)||void 0,pin:e.pin},s=await (0,a.authFetch)(`/api/service/${encodeURIComponent(j.category)}/${encodeURIComponent(j.subservice)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}),r=await s.json().catch(()=>null);if(!s.ok)return{ok:!1,error:String(r?.error||`Service failed (${s.status})`),message:String(r?.message||"Failed"),data:r};return f(String(r?.reference||"")),{ok:!0,reference:String(r?.reference||""),message:String(r?.message||""),data:r}}catch(e){return{ok:!1,error:String(e?.message||e)}}},[j.category,j.subservice,j.variant])}}e.s(["default",0,i,"useDynamicPricing",()=>i])},330843,e=>{"use strict";var t=e.i(843476),a=e.i(271645),s=e.i(630374),r=e.i(167881),i=e.i(23750),l=e.i(10708),n=e.i(846696);function c({isOpen:e,onClose:c,onConfirm:o,isLoading:d}){let[m,u]=(0,a.useState)(""),x=()=>{4!==m.length?n.toast.error("Please enter a 4-digit PIN"):(o(m),u(""))};return(0,t.jsx)(s.Dialog,{open:e,onOpenChange:e=>!e&&c(),children:(0,t.jsxs)(s.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(s.DialogHeader,{children:[(0,t.jsx)(s.DialogTitle,{children:"Enter Transaction PIN"}),(0,t.jsx)(s.DialogDescription,{children:"Please enter your 4-digit transaction PIN to authorize this request."})]}),(0,t.jsx)("div",{className:"space-y-4 py-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"pin",className:"text-center block",children:"PIN"}),(0,t.jsx)(i.Input,{id:"pin",type:"password",inputMode:"numeric",maxLength:4,value:m,onChange:e=>u(e.target.value.replace(/\D/g,"")),className:"text-center text-2xl tracking-[1em]",placeholder:"••••",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&x()}})]})}),(0,t.jsxs)(s.DialogFooter,{children:[(0,t.jsx)(r.Button,{variant:"outline",onClick:c,disabled:d,children:"Cancel"}),(0,t.jsx)(r.Button,{onClick:x,disabled:d||4!==m.length,className:"bg-[#3457D5]",children:d?"Verifying...":"Confirm PIN"})]})]})})}e.s(["PinPrompt",()=>c])},929054,e=>{"use strict";function t(e,a,s="Error"){a({title:s,description:e.error||e.message||"An unexpected error occurred",variant:"destructive"})}e.s(["handleServiceError",()=>t])},853013,e=>{"use strict";let t=(0,e.i(475254).default)("Tv",[["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",ry:"2",key:"10ag99"}],["polyline",{points:"17 2 12 7 7 2",key:"11pgbg"}]]);e.s(["Tv",()=>t],853013)},451392,e=>{"use strict";var t=e.i(843476),a=e.i(271645),s=e.i(846932),r=e.i(88653),i=e.i(167881),l=e.i(970065),n=e.i(23750),c=e.i(10708),o=e.i(62870),d=e.i(630374),m=e.i(671428),u=e.i(120682),x=e.i(853013),p=e.i(252754),h=e.i(595468),v=e.i(63209),g=e.i(531278),f=e.i(692659),j=e.i(750769),b=e.i(330843),y=e.i(929054);let N={dstv:[{id:"dstv-padi",name:"DStv Padi",price:2500},{id:"dstv-yanga",name:"DStv Yanga",price:3500},{id:"dstv-confam",name:"DStv Confam",price:6200},{id:"dstv-compact",name:"DStv Compact",price:10500},{id:"dstv-compact-plus",name:"DStv Compact Plus",price:16600},{id:"dstv-premium",name:"DStv Premium",price:24500}],gotv:[{id:"gotv-smallie",name:"GOtv Smallie",price:1300},{id:"gotv-jinja",name:"GOtv Jinja",price:2700},{id:"gotv-jolli",name:"GOtv Jolli",price:3950},{id:"gotv-max",name:"GOtv Max",price:5700},{id:"gotv-supa",name:"GOtv Supa",price:7600}],startimes:[{id:"startimes-nova",name:"Nova",price:1200},{id:"startimes-basic",name:"Basic",price:2200},{id:"startimes-smart",name:"Smart",price:3e3},{id:"startimes-classic",name:"Classic",price:3600},{id:"startimes-super",name:"Super",price:5500}]};function S(){let[e,S]=(0,a.useState)(!0),[C,D]=(0,a.useState)(!1),[w,k]=(0,a.useState)(0),[P,F]=(0,a.useState)(""),[T,I]=(0,a.useState)(""),[L,O]=(0,a.useState)(""),[A,$]=(0,a.useState)(""),[E,B]=(0,a.useState)(!1),[U,M]=(0,a.useState)(""),{toast:G}=(0,u.useToast)(),[R,V]=(0,a.useState)(!1),[K,_]=(0,a.useState)({}),[H,Y]=(0,a.useState)(!1),[z,J]=(0,a.useState)(!1),[q,W]=(0,a.useState)(null),{price:Q,isLoading:X,submitService:Z}=(0,j.default)("bills","cable",L);(0,a.useEffect)(()=>{let e=setTimeout(()=>{let e=localStorage.getItem("ufriends_wallet_balance");k(e?Number.parseFloat(e):5e4),S(!1)},800);return()=>clearTimeout(e)},[]),(0,a.useEffect)(()=>{(async()=>{try{let e=await (0,f.authFetch)("/api/me"),t=e.ok?await e.json():null;V("MARKETER"===(t?.user?.role||""))}catch{V(!1)}})()},[]);let ee=(e,t)=>{let a=e=>e.replace(/[^a-z0-9]+/gi,".").replace(/\.+/g,".").replace(/^\.|\.$/g,"").toLowerCase(),s=t.replace(/^dstv-|^gotv-|^startimes-/,"");return`bills.cable.${a(e)}.${a(s)}`};(0,a.useEffect)(()=>{(async()=>{if(!P)return _({});try{Y(!0);let e=R?"marketer":"user",t=N[P]||[],a=t.map(e=>ee(P,e.id)),s=await Promise.all(a.map(async t=>{let a=await fetch(`/api/pricing?serviceSlug=${encodeURIComponent(t)}&tier=${e}`),s=await a.json().catch(()=>null),r=a.ok&&s?.price?.price!=null?Number(s.price.price):null;return{slug:t,price:r}})),r={};for(let e of t){let t=ee(P,e.id),a=s.find(e=>e.slug===t);r[e.id]=a?.price??e.price}_(r)}catch{let e=N[P]||[],t={};for(let a of e)t[a.id]=a.price;_(t)}finally{Y(!1)}})()},[P,R]);let et=P&&N[P]||[],ea=et.find(e=>e.id===L),es=Q||K[L]||ea?.price||0,er=async e=>{J(!1),D(!0);try{let t=await Z({...q,pin:e});if(!t.ok)return void(0,y.handleServiceError)(t,G,"Payment Failed");if(M(t.reference||`CBL${Date.now()}`),w>=es){let e=w-es;k(e)}B(!0),G({title:"Payment Successful!",description:`Your ${P.toUpperCase()} subscription has been renewed.`})}catch(e){G({title:"Error",description:e?.message||"An unexpected error occurred",variant:"destructive"})}finally{D(!1)}};return e?(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,t.jsx)(m.Skeleton,{className:"h-32 w-full"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsx)(m.Skeleton,{className:"h-96 w-full"}),(0,t.jsx)(m.Skeleton,{className:"h-96 w-full"})]})]}):(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[(0,t.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,t.jsx)("div",{className:"p-3 bg-[#3457D5]/10 rounded-full",children:(0,t.jsx)(x.Tv,{className:"h-10 w-10 text-[#3457D5]"})})}),(0,t.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Cable TV Subscription"}),(0,t.jsx)("p",{className:"text-lg text-gray-600",children:"Pay for DStv, GOtv, and StarTimes subscriptions"})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsx)(s.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:(0,t.jsxs)(l.Card,{className:"border-[#3457D5]/20 shadow-lg",children:[(0,t.jsxs)(l.CardHeader,{className:"bg-gradient-to-r from-[#3457D5]/5 to-[#CCCCFF]/10",children:[(0,t.jsxs)(l.CardTitle,{className:"flex items-center gap-2 text-[#3457D5]",children:[(0,t.jsx)(x.Tv,{className:"h-5 w-5"}),"Pay Cable Bill"]}),(0,t.jsx)(l.CardDescription,{children:"Instant subscription renewal"})]}),(0,t.jsx)(l.CardContent,{className:"pt-6",children:(0,t.jsxs)("form",{onSubmit:e=>{(e.preventDefault(),P&&T&&L)?T.length<10?G({title:"Invalid Smartcard Number",description:"Please enter a valid smartcard/IUC number.",variant:"destructive"}):w<es?G({title:"Insufficient Balance",description:`You need ₦${es.toLocaleString()} but have ₦${w.toLocaleString()}.`,variant:"destructive"}):(W({amount:es,smartcardNumber:T,provider:P,planId:L,customerName:A}),J(!0)):G({title:"Missing Information",description:"Please fill in all required fields.",variant:"destructive"})},className:"space-y-4",children:[(0,t.jsx)("div",{className:"p-4 bg-[#F9F7F3] rounded-lg border border-[#3457D5]/10",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Wallet,{className:"h-5 w-5 text-[#3457D5]"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Wallet Balance"})]}),(0,t.jsxs)("span",{className:"text-lg font-bold text-[#3457D5]",children:["₦",w.toLocaleString()]})]})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"provider",children:"Cable Provider *"}),(0,t.jsxs)(o.Select,{value:P,onValueChange:F,children:[(0,t.jsx)(o.SelectTrigger,{className:"border-[#3457D5]/20 focus:ring-[#3457D5]",children:(0,t.jsx)(o.SelectValue,{placeholder:"Select provider"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"dstv",children:"DStv"}),(0,t.jsx)(o.SelectItem,{value:"gotv",children:"GOtv"}),(0,t.jsx)(o.SelectItem,{value:"startimes",children:"StarTimes"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"smartcard",children:"Smartcard/IUC Number *"}),(0,t.jsx)(n.Input,{id:"smartcard",value:T,onChange:e=>I(e.target.value),placeholder:"Enter smartcard number",className:"border-[#3457D5]/20 focus:ring-[#3457D5]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"plan",children:"Subscription Plan *"}),(0,t.jsxs)(o.Select,{value:L,onValueChange:O,disabled:!P,children:[(0,t.jsx)(o.SelectTrigger,{className:"border-[#3457D5]/20 focus:ring-[#3457D5]",children:(0,t.jsx)(o.SelectValue,{placeholder:"Select plan"})}),(0,t.jsx)(o.SelectContent,{children:et.map(e=>{let a=K[e.id]??e.price;return(0,t.jsxs)(o.SelectItem,{value:e.id,children:[e.name," - ₦",H?"...":a.toLocaleString()]},e.id)})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"customer-name",children:"Customer Name (Optional)"}),(0,t.jsx)(n.Input,{id:"customer-name",value:A,onChange:e=>$(e.target.value),placeholder:"Account holder name",className:"border-[#3457D5]/20 focus:ring-[#3457D5]"})]}),es>0&&(0,t.jsx)(s.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"p-4 bg-[#CCCCFF]/20 rounded-lg border border-[#3457D5]/20",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Total Amount"}),(0,t.jsxs)("span",{className:"text-2xl font-bold text-[#3457D5]",children:["₦",H?"...":es.toLocaleString()]})]})}),(0,t.jsx)(i.Button,{type:"submit",disabled:C,className:"w-full bg-[#3457D5] hover:bg-[#3457D5]/90 text-white",children:C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay Cable Bill"})]})})]})}),(0,t.jsxs)(s.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-4",children:[(0,t.jsxs)(l.Card,{className:"border-[#3457D5]/20",children:[(0,t.jsx)(l.CardHeader,{children:(0,t.jsx)(l.CardTitle,{className:"text-[#3457D5]",children:"Supported Providers"})}),(0,t.jsxs)(l.CardContent,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"p-3 bg-[#F9F7F3] rounded-lg border border-[#3457D5]/10",children:[(0,t.jsx)("div",{className:"font-semibold text-gray-900",children:"DStv"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"All packages available"})]}),(0,t.jsxs)("div",{className:"p-3 bg-[#F9F7F3] rounded-lg border border-[#3457D5]/10",children:[(0,t.jsx)("div",{className:"font-semibold text-gray-900",children:"GOtv"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"All packages available"})]}),(0,t.jsxs)("div",{className:"p-3 bg-[#F9F7F3] rounded-lg border border-[#3457D5]/10",children:[(0,t.jsx)("div",{className:"font-semibold text-gray-900",children:"StarTimes"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"All packages available"})]})]})]}),(0,t.jsxs)(l.Card,{className:"border-[#3457D5]/20",children:[(0,t.jsx)(l.CardHeader,{children:(0,t.jsxs)(l.CardTitle,{className:"flex items-center gap-2 text-[#3457D5]",children:[(0,t.jsx)(v.AlertCircle,{className:"h-5 w-5"}),"Important Notes"]})}),(0,t.jsx)(l.CardContent,{children:(0,t.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600",children:[(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)(h.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,t.jsx)("span",{children:"Instant activation after payment"})]}),(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)(h.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,t.jsx)("span",{children:"Verify smartcard number before payment"})]}),(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)(h.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,t.jsx)("span",{children:"SMS confirmation sent after successful payment"})]}),(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)(h.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,t.jsx)("span",{children:"24/7 payment availability"})]})]})})]})]})]}),(0,t.jsx)(r.AnimatePresence,{children:E&&(0,t.jsx)(d.Dialog,{open:E,onOpenChange:B,children:(0,t.jsxs)(d.DialogContent,{className:"border-[#3457D5]/20",children:[(0,t.jsxs)(d.DialogHeader,{children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)("div",{className:"p-3 bg-green-100 rounded-full",children:(0,t.jsx)(h.CheckCircle2,{className:"h-12 w-12 text-green-600"})})}),(0,t.jsx)(d.DialogTitle,{className:"text-center text-2xl",children:"Payment Successful!"}),(0,t.jsx)(d.DialogDescription,{className:"text-center",children:"Your cable TV subscription has been renewed successfully."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"p-4 bg-[#F9F7F3] rounded-lg space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Transaction ID:"}),(0,t.jsx)("span",{className:"font-mono font-semibold text-[#3457D5]",children:U})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Provider:"}),(0,t.jsx)("span",{className:"font-semibold",children:P.toUpperCase()})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Plan:"}),(0,t.jsx)("span",{className:"font-semibold",children:ea?.name})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Amount Paid:"}),(0,t.jsxs)("span",{className:"font-semibold text-[#3457D5]",children:["₦",es.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"New Balance:"}),(0,t.jsxs)("span",{className:"font-semibold",children:["₦",w.toLocaleString()]})]})]}),(0,t.jsx)(i.Button,{onClick:()=>{F(""),I(""),O(""),$(""),B(!1),M("")},className:"w-full bg-[#3457D5] hover:bg-[#3457D5]/90",children:"Make Another Payment"})]})]})})}),(0,t.jsx)(b.PinPrompt,{isOpen:z,onClose:()=>J(!1),onConfirm:er,isLoading:C})]})}e.s(["default",()=>S])}]);