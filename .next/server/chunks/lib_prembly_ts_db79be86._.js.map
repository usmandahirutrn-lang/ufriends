{"version":3,"sources":["turbopack:///[project]/lib/prembly.ts"],"sourcesContent":["/**\r\n * Prembly API Client\r\n * Documentation: https://docs.prembly.com/docs/welcome-to-prembly-documentation\r\n */\r\n\r\nconst PREMBLY_BASE_URL = process.env.PREMBLY_BASE_URL || 'https://api.prembly.com';\r\n\r\ninterface PremblyConfig {\r\n  apiKey: string;\r\n  appId: string;\r\n}\r\n\r\ninterface PremblyResponse<T> {\r\n  status: boolean;\r\n  detail: string;\r\n  data?: T;\r\n  error?: string;\r\n}\r\n\r\n// NIN Service Types\r\ninterface NINPrintoutParams {\r\n  nin: string;\r\n}\r\n\r\ninterface NINSlipParams {\r\n  nin: string;\r\n}\r\n\r\ninterface NINAdvancedParams {\r\n  nin: string;\r\n  phoneNumber?: string;\r\n  firstName?: string;\r\n  lastName?: string;\r\n  dateOfBirth?: string;\r\n  gender?: string;\r\n}\r\n\r\n// BVN Service Types\r\ninterface BVNPrintoutParams {\r\n  bvn: string;\r\n}\r\n\r\ninterface BVNByPhoneParams {\r\n  phoneNumber: string;\r\n}\r\n\r\ninterface BVNAdvancedParams {\r\n  bvn: string;\r\n}\r\n\r\n// Phone number advanced\r\ninterface PhoneAdvancedParams {\r\n  phoneNumber: string;\r\n}\r\n\r\n// TIN Service Types\r\ninterface TINVerificationParams {\r\n  tin: string;\r\n}\r\n\r\n// Driver's License\r\ninterface DriversLicenseAdvancedParams {\r\n  licenseNumber?: string;\r\n  expiryDate?: string;\r\n  firstName?: string;\r\n  lastName?: string;\r\n  dob?: string;\r\n}\r\n\r\n// Voters Card\r\ninterface VotersCardParams {\r\n  number: string;\r\n  lastName?: string;\r\n  firstName?: string;\r\n  dob?: string;\r\n  lga?: string;\r\n  state?: string;\r\n}\r\n\r\n// CAC Service Types (Advance)\r\ninterface CACAdvanceParams {\r\n  // unified params aligning to Prembly Advance CAC\r\n  number: string; // RC or BN or IT number\r\n  companyType?: 'RC' | 'BN' | 'IT';\r\n  companyName?: string;\r\n}\r\n\r\n// International Passport\r\ninterface InternationalPassportV2Params {\r\n  passportNumber: string;\r\n  lastName?: string;\r\n}\r\n\r\n// Plate Number\r\ninterface PlateNumberParams {\r\n  plateNumber: string;\r\n}\r\n\r\n/**\r\n * Prembly API Client for identity verification services\r\n */\r\nexport class PremblyClient {\r\n  private apiKey: string;\r\n  private appId: string;\r\n  \r\n  constructor(config: PremblyConfig) {\r\n    this.apiKey = config.apiKey;\r\n    this.appId = config.appId;\r\n  }\r\n\r\n  private async makeRequest<T>(endpoint: string, method: string, data?: any): Promise<PremblyResponse<T>> {\r\n    try {\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        console.log('[Prembly] env check', {\r\n          baseUrl: PREMBLY_BASE_URL,\r\n          endpoint,\r\n          hasApiKey: !!this.apiKey,\r\n          hasAppId: !!this.appId,\r\n        })\r\n      }\r\n      const response = await fetch(`${PREMBLY_BASE_URL}${endpoint}`, {\r\n        method,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Accept': 'application/json',\r\n          'x-api-key': this.apiKey,\r\n          'app-id': this.appId,\r\n        },\r\n        body: data ? JSON.stringify(data) : undefined,\r\n      });\r\n\r\n      const contentType = response.headers.get('content-type') || '';\r\n      let result: any;\r\n      if (contentType.includes('application/json')) {\r\n        result = await response.json();\r\n      } else {\r\n        const text = await response.text();\r\n        throw new Error(`Unexpected response from Prembly (${response.status}): ${text.slice(0, 200)}...`);\r\n      }\r\n      \r\n      if (!response.ok) {\r\n        const msg = typeof result?.error === 'string' ? result.error\r\n          : typeof result?.detail === 'string' ? result.detail\r\n          : typeof result?.message === 'string' ? result.message\r\n          : 'Failed to process request';\r\n        throw new Error(msg);\r\n      }\r\n      \r\n      return result;\r\n    } catch (error: any) {\r\n      console.error('Prembly API Error:', error);\r\n      return {\r\n        status: false,\r\n        detail: error.message || 'An error occurred while processing your request',\r\n        error: error.message,\r\n      };\r\n    }\r\n  }\r\n\r\n  // NIN Services\r\n  async getNINPrintout(params: NINPrintoutParams) {\r\n    const payload: any = { number_nin: params.nin }\r\n    return this.makeRequest('/verification/vnin', 'POST', payload);\r\n  }\r\n\r\n  async getNINSlip(params: NINSlipParams) {\r\n    const payload: any = { number_nin: params.nin }\r\n    return this.makeRequest('/verification/vnin', 'POST', payload);\r\n  }\r\n\r\n  async getNINAdvanced(params: NINAdvancedParams) {\r\n    const payload: any = { number_nin: params.nin }\r\n    if (params.phoneNumber) payload.phone_number = params.phoneNumber\r\n    if (params.firstName) payload.first_name = params.firstName\r\n    if (params.lastName) payload.last_name = params.lastName\r\n    if (params.dateOfBirth) payload.date_of_birth = params.dateOfBirth\r\n    if (params.gender) payload.gender = params.gender\r\n    return this.makeRequest('/verification/vnin', 'POST', payload)\r\n  }\r\n\r\n  // BVN Services (use documented endpoints)\r\n  async getBVNPrintout(params: BVNPrintoutParams) {\r\n    const payload = { number: params.bvn } as any\r\n    return this.makeRequest('/verification/bvn', 'POST', payload);\r\n  }\r\n\r\n  async getBVNByPhone(params: BVNByPhoneParams) {\r\n    // Per docs: POST /verification/bvn_with_phone_advance with payload { phone_number }\r\n    const payload = { phone_number: params.phoneNumber } as any;\r\n    return this.makeRequest('/verification/bvn_with_phone_advance', 'POST', payload);\r\n  }\r\n\r\n  async getBVNAdvanced(params: BVNAdvancedParams) {\r\n    return this.makeRequest('/verification/bvn/advance', 'POST', params);\r\n  }\r\n\r\n  // Phone Number (Advanced)\r\n  async verifyPhoneAdvanced(params: PhoneAdvancedParams) {\r\n    const payload = { phone_number: params.phoneNumber } as any\r\n    return this.makeRequest('/verification/phone_number/advance', 'POST', payload)\r\n  }\r\n\r\n  // TIN\r\n  async verifyTIN(params: TINVerificationParams) {\r\n    return this.makeRequest('/verification/global/tin-check', 'POST', params);\r\n  }\r\n\r\n  // Driver's License (Advanced)\r\n  async verifyDriversLicenseAdvanced(params: DriversLicenseAdvancedParams) {\r\n    const payload: any = {}\r\n    if (params.licenseNumber) payload.license_number = params.licenseNumber\r\n    if (params.expiryDate) payload.expiry_date = params.expiryDate\r\n    if (params.firstName) payload.first_name = params.firstName\r\n    if (params.lastName) payload.last_name = params.lastName\r\n    if (params.dob) payload.dob = params.dob\r\n    return this.makeRequest('/verification/drivers_license/advance/v2', 'POST', payload)\r\n  }\r\n\r\n  // Voters Card\r\n  async verifyVotersCard(params: VotersCardParams) {\r\n    const payload: any = { number: params.number }\r\n    if (params.lastName) payload.last_name = params.lastName\r\n    if (params.firstName) payload.first_name = params.firstName\r\n    if (params.dob) payload.dob = params.dob\r\n    if (params.lga) payload.lga = params.lga\r\n    if (params.state) payload.state = params.state\r\n    return this.makeRequest('/verification/voters_card', 'POST', payload)\r\n  }\r\n\r\n  // CAC Services (Advance)\r\n  async getCACInfo(params: CACAdvanceParams) {\r\n    // Docs: POST /verification/cac/advance with rc_number, company_type, company_name\r\n    const payload: any = {}\r\n    if (params.number) payload.rc_number = String(params.number)\r\n    if (params.companyType) payload.company_type = String(params.companyType)\r\n    if (params.companyName) payload.company_name = String(params.companyName)\r\n    return this.makeRequest('/verification/cac/advance', 'POST', payload)\r\n  }\r\n\r\n  async getCACAdvanced(params: CACAdvanceParams) {\r\n    const payload: any = {}\r\n    if (params.number) payload.rc_number = String(params.number)\r\n    if (params.companyType) payload.company_type = String(params.companyType)\r\n    if (params.companyName) payload.company_name = String(params.companyName)\r\n    return this.makeRequest('/verification/cac/advance', 'POST', payload)\r\n  }\r\n\r\n  async getCACStatusReport(params: CACAdvanceParams) {\r\n    const payload: any = {}\r\n    if (params.number) payload.rc_number = String(params.number)\r\n    if (params.companyType) payload.company_type = String(params.companyType)\r\n    if (params.companyName) payload.company_name = String(params.companyName)\r\n    return this.makeRequest('/verification/cac/advance', 'POST', payload)\r\n  }\r\n\r\n  // International Passport v2\r\n  async verifyInternationalPassportV2(params: InternationalPassportV2Params) {\r\n    const payload: any = { passport_number: params.passportNumber }\r\n    if (params.lastName) payload.last_name = params.lastName\r\n    return this.makeRequest('/verification/national_passport_v2', 'POST', payload)\r\n  }\r\n\r\n  // Plate Number\r\n  async verifyPlateNumber(params: PlateNumberParams) {\r\n    const payload = { plate_number: params.plateNumber } as any\r\n    return this.makeRequest('/verification/vehicle', 'POST', payload)\r\n  }\r\n}\r\n\r\n// Create and export a singleton instance with environment variables\r\nexport const premblyClient = new PremblyClient({\r\n  apiKey: process.env.PREMBLY_API_KEY || '',\r\n  appId: process.env.PREMBLY_APP_ID || '',\r\n});\r\n\r\nexport default premblyClient;\r\n"],"names":[],"mappings":"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"}