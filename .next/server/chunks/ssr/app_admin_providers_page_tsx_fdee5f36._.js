module.exports=[537932,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(703130),e=a.i(340695),f=a.i(205522),g=a.i(917171),h=a.i(254161),i=a.i(265602),j=a.i(965733),k=a.i(621958),l=a.i(915618),m=a.i(321161);let n=(0,a.i(170106).default)("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);var o=a.i(816201),p=a.i(862722),q=a.i(73570),r=a.i(781560),s=a.i(177156),t=a.i(141379),u=a.i(823292),v=a.i(677050);let w=[{id:"prembly",name:"Prembly",category:"verification",description:"Identity verification and background checks",baseUrl:"https://api.prembly.com",requiredFields:["api_key"],optionalFields:["app_id","app_username"],configTemplate:{adapter:"prembly"}},{id:"prembly-nin",name:"Prembly (NIN)",category:"nin",description:"Prembly for NIN services (slip, printout)",baseUrl:"https://api.prembly.com",requiredFields:["api_key"],optionalFields:["app_id","app_username"],configTemplate:{adapter:"prembly",service:"nin"}},{id:"prembly-bvn",name:"Prembly (BVN)",category:"bvn",description:"Prembly for BVN services (retrieval, printout)",baseUrl:"https://api.prembly.com",requiredFields:["api_key"],optionalFields:["app_id","app_username"],configTemplate:{adapter:"prembly",service:"bvn"}},{id:"prembly-cac",name:"Prembly (CAC)",category:"cac",description:"Prembly for CAC services (retrieval, status report)",baseUrl:"https://api.prembly.com",requiredFields:["api_key"],optionalFields:["app_id","app_username"],configTemplate:{adapter:"prembly",service:"cac"}},{id:"subandgain",name:"SubAndGain",category:"vtu",description:"Airtime, data, and bill payments",baseUrl:"https://subandgain.com",requiredFields:["api_key","username"],optionalFields:[],configTemplate:{adapter:"subandgain"}},{id:"subandgain-bills",name:"SubAndGain (Bills)",category:"bills",description:"SubAndGain for bills and education",baseUrl:"https://subandgain.com",requiredFields:["api_key","username"],optionalFields:[],configTemplate:{adapter:"subandgain"}},{id:"portedsim",name:"PortedSIM",category:"vtu",description:"Airtime and data services",baseUrl:"https://api.portedsim.com",requiredFields:["api_key"],optionalFields:["secret_key"],configTemplate:{adapter:"portedsim"}},{id:"maskawa",name:"Maskawa",category:"vtu",description:"Airtime, data, bills, and education",baseUrl:"",requiredFields:["api_key"],optionalFields:["username"],configTemplate:{adapter:"maskawa"}},{id:"maskawa-bills",name:"Maskawa (Bills)",category:"bills",description:"Maskawa for bills and education",baseUrl:"",requiredFields:["api_key"],optionalFields:["username"],configTemplate:{adapter:"maskawa"}}];function x(){let a,[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)({}),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)({}),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)(""),V=[{id:"vtu",name:"Airtime & Data",icon:"ðŸ“±"},{id:"bills",name:"Bills & Education",icon:"ðŸ’¡"},{id:"bvn",name:"BVN Services",icon:"ðŸ†”"},{id:"nin",name:"NIN Services",icon:"ðŸ†”"},{id:"cac",name:"CAC Services",icon:"ðŸ¢"},{id:"verification",name:"Verification Services",icon:"âœ…"}];(0,c.useEffect)(()=>{W()},[]);let W=async()=>{A(!0);try{let a=await (0,v.authFetch)("/api/admin/providers?flat=true");if(!a.ok)throw Error("Failed to fetch providers");let b=await a.json();y(Array.isArray(b.providers)?b.providers:[])}catch(a){u.toast.error("Failed to load providers"),console.error(a)}finally{A(!1)}},X=a=>{G(a),K({name:a.name,category:a.category,apiBaseUrl:a.baseUrl,priority:10,...a.configTemplate}),C(!0)},Y=async(a,b)=>{let c=b.filter(a=>"string"==typeof J[a]&&J[a]);0!==c.length&&await Promise.all(c.map(b=>(0,v.authFetch)(`/api/admin/providers/${a}/api-key`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyName:b,keyValue:String(J[b])})})))},Z=async(a=!1)=>{try{let b=a?`/api/admin/providers/${H?.id}`:"/api/admin/providers",c={name:J.name,category:J.category,apiBaseUrl:J.apiBaseUrl,priority:J.priority,configJson:{...J}},d=await (0,v.authFetch)(b,{method:a?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!d.ok)throw Error("Failed to save provider");let e=await d.json(),f=e?.provider?.id||H?.id;if(!a&&F&&f){let a=[...F.requiredFields,...F.optionalFields];await Y(f,a)}u.toast.success(`Provider ${a?"updated":"added"} successfully`),await W(),C(!1),E(!1),K({}),I(null),G(null),S(""),U("")}catch(b){u.toast.error(`Failed to ${a?"update":"add"} provider`),console.error(b)}},$=async(a,b)=>{try{if(!(await (0,v.authFetch)(`/api/admin/providers/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:b})})).ok)throw Error("Failed to update provider status");u.toast.success(`Provider ${b?"activated":"deactivated"}`),W()}catch(a){u.toast.error("Failed to update provider status"),console.error(a)}},_=async a=>{if(confirm("Are you sure you want to delete this provider?"))try{if(!(await (0,v.authFetch)(`/api/admin/providers/${a}`,{method:"DELETE"})).ok)throw Error("Failed to delete provider");u.toast.success("Provider deleted successfully"),W()}catch(a){u.toast.error("Failed to delete provider"),console.error(a)}},aa=async a=>{M(a.id),O(null);try{let b=await (0,v.authFetch)(`/api/admin/providers/${a.id}/test`,{method:"POST"}),c=await b.json();O(c),c.success?u.toast.success("Provider test successful"):u.toast.error("Provider test failed")}catch(a){u.toast.error("Failed to test provider"),O({success:!1,error:a.message})}finally{M(null)}},ab=a=>{Q(b=>({...b,[a]:!b[a]}))},ac=async()=>{if(!H?.id)return void u.toast.error("No provider selected");if(!R.trim()||!T.trim())return void u.toast.error("Enter key name and value");try{let a=await (0,v.authFetch)(`/api/admin/providers/${H.id}/api-key`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyName:R.trim(),keyValue:T.trim()})});if(!a.ok){let b=await a.json().catch(()=>({}));throw Error(b?.error||"Failed to create API key")}u.toast.success("API key saved"),S(""),U(""),await W()}catch(a){u.toast.error(String(a?.message||a||"Failed to save API key"))}},ad=async(a,b)=>{if(a&&b)try{let c=await (0,v.authFetch)(`/api/admin/providers/${a}/api-key?keyId=${encodeURIComponent(b)}`,{method:"DELETE"});if(!c.ok){let a=await c.json().catch(()=>({}));throw Error(a?.error||"Failed to delete API key")}u.toast.success("API key deleted"),await W()}catch(a){u.toast.error(String(a?.message||a||"Failed to delete API key"))}},ae=(a={},x.forEach(b=>{a[b.category]||(a[b.category]=[]),a[b.category].push(b)}),a);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Plus,{className:"h-5 w-5"}),"Quick Add Provider"]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:w.map(a=>(0,b.jsx)(d.Card,{className:"border-2 hover:border-blue-300 transition-colors",children:(0,b.jsxs)(d.CardContent,{className:"p-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:a.description}),(0,b.jsx)(h.Badge,{variant:"outline",className:"mb-3",children:V.find(b=>b.id===a.category)?.name}),(0,b.jsxs)(e.Button,{className:"w-full",size:"sm",onClick:()=>X(a),children:[(0,b.jsx)(l.Plus,{className:"h-4 w-4 mr-1"}),"Add Provider"]})]})},a.id))})})]}),(0,b.jsxs)(k.Tabs,{defaultValue:"all",className:"w-full",children:[(0,b.jsxs)(k.TabsList,{className:"grid grid-cols-3 md:grid-cols-6",children:[(0,b.jsx)(k.TabsTrigger,{value:"all",children:"All"}),V.map(a=>(0,b.jsxs)(k.TabsTrigger,{value:a.id,children:[a.icon," ",a.name]},a.id))]}),(0,b.jsx)(k.TabsContent,{value:"all",children:V.map(a=>{let c,f=ae[a.id]||[];return(0,b.jsxs)(d.Card,{className:"mb-4",children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center justify-between",children:[(0,b.jsxs)("span",{children:[a.icon," ",a.name]}),(0,b.jsx)("div",{className:"flex gap-2",children:(c=a.id,w.filter(a=>a.category===c)).map(a=>(0,b.jsxs)(e.Button,{size:"sm",variant:"outline",onClick:()=>X(a),children:[(0,b.jsx)(l.Plus,{className:"h-4 w-4 mr-1"}),"Add ",a.name]},a.id))})]})}),(0,b.jsx)(d.CardContent,{children:0===f.length?(0,b.jsxs)(i.Alert,{children:[(0,b.jsx)(q.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsxs)(i.AlertDescription,{children:["No providers configured for ",a.name,'. Click "Add Provider" to get started.']})]}):(0,b.jsx)("div",{className:"space-y-4",children:f.map(a=>(0,b.jsx)(d.Card,{className:a.isActive?"border-green-300":"border-gray-300",children:(0,b.jsxs)(d.CardContent,{className:"p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h4",{className:"font-semibold",children:a.name}),(0,b.jsx)(h.Badge,{variant:a.isActive?"default":"secondary",children:a.isActive?"Active":"Inactive"}),(0,b.jsxs)(h.Badge,{variant:"outline",children:["Priority: ",a.priority]})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a.apiBaseUrl}),a.apiKeys&&a.apiKeys.length>0&&(0,b.jsx)("div",{className:"space-y-1",children:a.apiKeys.map(c=>(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsxs)("span",{className:"font-medium",children:[c.keyName,":"]}),(0,b.jsx)("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:P[a.id]?c.keyValue:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),(0,b.jsx)(e.Button,{size:"sm",variant:"ghost",onClick:()=>ab(a.id),children:P[a.id]?(0,b.jsx)(t.EyeOff,{className:"h-3 w-3"}):(0,b.jsx)(s.Eye,{className:"h-3 w-3"})})]},c.id))})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(e.Button,{size:"sm",variant:"outline",onClick:()=>aa(a),disabled:L===a.id,children:[(0,b.jsx)(n,{className:"h-4 w-4 mr-1"}),L===a.id?"Testing...":"Test"]}),(0,b.jsxs)(e.Button,{size:"sm",variant:"outline",onClick:()=>{I(a),K({name:a.name,category:a.category,apiBaseUrl:a.apiBaseUrl,priority:a.priority,...a.configJson}),E(!0)},children:[(0,b.jsx)(m.Settings,{className:"h-4 w-4 mr-1"}),"Configure"]}),(0,b.jsx)(e.Button,{size:"sm",variant:a.isActive?"destructive":"default",onClick:()=>$(a.id,!a.isActive),children:a.isActive?"Deactivate":"Activate"}),(0,b.jsx)(e.Button,{size:"sm",variant:"destructive",onClick:()=>_(a.id),children:(0,b.jsx)(r.Trash2,{className:"h-4 w-4"})})]})]}),N&&null===L&&(0,b.jsx)(i.Alert,{className:"mt-3",children:N.success?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.CheckCircle,{className:"h-4 w-4"}),(0,b.jsxs)(i.AlertDescription,{children:["Provider test successful! Response: ",JSON.stringify(N.data)]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.XCircle,{className:"h-4 w-4"}),(0,b.jsxs)(i.AlertDescription,{children:["Provider test failed: ",N.error]})]})})]})},a.id))})})]},a.id)})}),V.map(a=>(0,b.jsx)(k.TabsContent,{value:a.id},a.id))]}),(0,b.jsx)(j.Dialog,{open:B,onOpenChange:C,children:(0,b.jsxs)(j.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(j.DialogHeader,{children:(0,b.jsxs)(j.DialogTitle,{children:["Add ",F?.name," Provider"]})}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Provider Name"}),(0,b.jsx)(f.Input,{value:J.name||"",onChange:a=>K({...J,name:a.target.value}),placeholder:"Enter provider name"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Priority"}),(0,b.jsx)(f.Input,{type:"number",value:J.priority||10,onChange:a=>K({...J,priority:Number(a.target.value)}),placeholder:"Priority (higher = first fallback)"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Base URL"}),(0,b.jsx)(f.Input,{value:J.apiBaseUrl||"",onChange:a=>K({...J,apiBaseUrl:a.target.value}),placeholder:"https://api.example.com"})]}),F?.requiredFields.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsxs)(g.Label,{className:"flex items-center gap-1",children:[a.charAt(0).toUpperCase()+a.slice(1).replace(/_/g," "),(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(f.Input,{value:J[a]||"",onChange:b=>K({...J,[a]:b.target.value}),placeholder:`Enter ${a.replace(/_/g," ")}`})]},a)),F?.optionalFields.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:a.charAt(0).toUpperCase()+a.slice(1).replace(/_/g," ")}),(0,b.jsx)(f.Input,{value:J[a]||"",onChange:b=>K({...J,[a]:b.target.value}),placeholder:`Enter ${a.replace(/_/g," ")} (optional)`})]},a))]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:()=>Z(!1),children:"Add Provider"})]})]})}),(0,b.jsx)(j.Dialog,{open:D,onOpenChange:E,children:(0,b.jsxs)(j.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(j.DialogHeader,{children:(0,b.jsxs)(j.DialogTitle,{children:["Edit ",H?.name]})}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Provider Name"}),(0,b.jsx)(f.Input,{value:J.name||"",onChange:a=>K({...J,name:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Priority"}),(0,b.jsx)(f.Input,{type:"number",value:J.priority||10,onChange:a=>K({...J,priority:Number(a.target.value)})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Base URL"}),(0,b.jsx)(f.Input,{value:J.apiBaseUrl||"",onChange:a=>K({...J,apiBaseUrl:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"API Keys"}),(0,b.jsx)("div",{className:"space-y-2",children:H?.apiKeys?.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Input,{value:a.keyName,readOnly:!0,className:"flex-1"}),(0,b.jsx)(f.Input,{value:H?.id&&P[H.id]?a.keyValue||"":"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",readOnly:!0,className:"flex-1"}),(0,b.jsx)(e.Button,{size:"sm",variant:"ghost",onClick:()=>H?.id&&ab(H.id),children:H?.id&&P[H.id]?(0,b.jsx)(t.EyeOff,{className:"h-3 w-3"}):(0,b.jsx)(s.Eye,{className:"h-3 w-3"})}),(0,b.jsx)(e.Button,{size:"sm",variant:"destructive",onClick:()=>a.id&&H?.id&&ad(H.id,a.id),children:"Delete"})]},a.id))}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[(0,b.jsx)(f.Input,{placeholder:"Key name (e.g., api_key)",value:R,onChange:a=>S(a.target.value)}),(0,b.jsx)(f.Input,{placeholder:"Key value",value:T,onChange:a=>U(a.target.value)})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(e.Button,{size:"sm",onClick:ac,children:"Add/Update Key"})})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:()=>Z(!0),children:"Save Changes"})]})]})})]})}function y(){return(0,b.jsxs)("div",{className:"space-y-6 p-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"API Providers"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage integration providers separately from services. Add, edit, activate, test, and remove providers."})})]}),(0,b.jsx)(x,{})]})}a.s(["default",()=>y],537932)}];

//# sourceMappingURL=app_admin_providers_page_tsx_fdee5f36._.js.map