module.exports=[914876,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944);function e(){(0,d.useRouter)();let[a,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)({category:"",subservice:"",variant:"",description:""});async function r(){try{g(!0);let a=j?`/api/service-catalog?category=${encodeURIComponent(j)}`:"/api/service-catalog",b=await fetch(a);if(!b.ok)throw Error(`Failed: ${b.status}`);let c=await b.json();e(c),i(null)}catch(a){i(a?.message||"Failed to load catalog")}finally{g(!1)}}(0,c.useEffect)(()=>{r()},[j]);let s=(0,c.useMemo)(()=>Array.from(new Set(a.map(a=>a.category))).sort(),[a]);function t(){m(!1)}async function u(){let b={category:p.category.trim(),subservice:p.subservice.trim(),variant:(p.variant||"").trim(),description:p.description?.trim()||void 0},c=n?`/api/admin/catalog/${n.id}`:"/api/admin/catalog",d=n?"PUT":"POST",e=await fetch(c,{method:d,headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!e.ok)return void alert((await e.json().catch(()=>({}))).error||`Request failed (${e.status})`);t(),await r();try{window.dispatchEvent(new CustomEvent("ufriends_catalog_updated")),localStorage.setItem("ufriends_service_catalog",JSON.stringify(a))}catch{}}async function v(b){if(!confirm(`Delete ${b.category} / ${b.subservice} / ${b.variant||"(no variant)"}?`))return;let c=await fetch(`/api/admin/catalog/${b.id}`,{method:"DELETE"});if(!c.ok)return void alert((await c.json().catch(()=>({}))).error||`Delete failed (${c.status})`);await r();try{window.dispatchEvent(new CustomEvent("ufriends_catalog_updated")),localStorage.setItem("ufriends_service_catalog",JSON.stringify(a))}catch{}}return(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h1",{className:"text-xl font-semibold",children:"Service Catalog"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("select",{className:"border rounded px-2 py-1",value:j,onChange:a=>k(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"All Categories"}),s.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsx)("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded",onClick:function(){o(null),q({category:"",subservice:"",variant:"",description:""}),m(!0)},children:"Add"})]})]}),f?(0,b.jsx)("div",{className:"space-y-2",children:[...Array(6)].map((a,c)=>(0,b.jsx)("div",{className:"h-10 bg-gray-100 animate-pulse rounded"},c))}):h?(0,b.jsx)("div",{className:"text-red-600",children:h}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full border",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-gray-50",children:[(0,b.jsx)("th",{className:"text-left p-2 border",children:"Category"}),(0,b.jsx)("th",{className:"text-left p-2 border",children:"Subservice"}),(0,b.jsx)("th",{className:"text-left p-2 border",children:"Variant"}),(0,b.jsx)("th",{className:"text-left p-2 border",children:"Description"}),(0,b.jsx)("th",{className:"text-left p-2 border",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:a.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"p-2 border",children:a.category}),(0,b.jsx)("td",{className:"p-2 border",children:a.subservice}),(0,b.jsx)("td",{className:"p-2 border",children:a.variant||""}),(0,b.jsx)("td",{className:"p-2 border",children:a.description||""}),(0,b.jsxs)("td",{className:"p-2 border",children:[(0,b.jsx)("button",{className:"text-blue-700 mr-3",onClick:()=>{o(a),q({category:a.category,subservice:a.subservice,variant:a.variant||"",description:a.description||""}),m(!0)},children:"Edit"}),(0,b.jsx)("button",{className:"text-red-700",onClick:()=>v(a),children:"Delete"})]})]},a.id))})]})}),l&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"bg-white rounded shadow-lg p-4 w-[480px]",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-3",children:n?"Edit Entry":"New Entry"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Category"}),(0,b.jsx)("input",{className:"w-full border rounded px-2 py-1",value:p.category,onChange:a=>q({...p,category:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Subservice"}),(0,b.jsx)("input",{className:"w-full border rounded px-2 py-1",value:p.subservice,onChange:a=>q({...p,subservice:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Variant (optional)"}),(0,b.jsx)("input",{className:"w-full border rounded px-2 py-1",value:p.variant,onChange:a=>q({...p,variant:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Description (optional)"}),(0,b.jsx)("textarea",{className:"w-full border rounded px-2 py-1",rows:3,value:p.description,onChange:a=>q({...p,description:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-end gap-2",children:[(0,b.jsx)("button",{className:"px-3 py-1 rounded border",onClick:t,children:"Cancel"}),(0,b.jsx)("button",{className:"px-3 py-1 rounded bg-blue-600 text-white",onClick:u,children:"Save"})]})]})})]})}a.s(["default",()=>e])}];

//# sourceMappingURL=app_admin_catalog_page_tsx_e65d0194._.js.map