module.exports=[155219,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(703130),e=a.i(340695),f=a.i(205522),g=a.i(887682),h=a.i(254161),i=a.i(790166),j=a.i(911156),k=a.i(816201),l=a.i(862722),m=a.i(641710),n=a.i(177156),o=a.i(965733),p=a.i(546893),q=a.i(917171),r=a.i(669520);let s=(0,a.i(170106).default)("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);var t=a.i(677050),u=a.i(277687);function v({payment:a,isOpen:d,onClose:f}){let[g,i]=(0,c.useState)(""),{toast:j}=(0,u.useToast)(),[n,v]=(0,c.useState)(!1),w=async()=>{try{if(n)return;v(!0);let b=await (0,t.authFetch)(`/api/admin/service/refund/${encodeURIComponent(a.reference)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:g||"Admin-initiated refund"})}),c=await b.json().catch(()=>({}));if(!b.ok){let a=c?.error||"Refund failed";j({title:"Refund Error",description:a,variant:"destructive"});return}j({title:"Refund Processed",description:`Reference ${a.reference} refunded successfully`}),f()}catch(a){j({title:"Refund Error",description:String(a),variant:"destructive"})}finally{v(!1)}},x=async()=>{try{if(n)return;v(!0);let b=await (0,t.authFetch)(`/api/admin/service/retry/${encodeURIComponent(a.reference)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:g||"Admin-initiated retry"})}),c=await b.json().catch(()=>({}));if(!b.ok){let a=c?.error||"Retry failed";j({title:"Retry Error",description:a,variant:"destructive"});return}j({title:"Retry Requested",description:`Reference ${a.reference} retry successful`}),f()}catch(a){j({title:"Retry Error",description:String(a),variant:"destructive"})}finally{v(!1)}};return(0,b.jsx)(o.Dialog,{open:d,onOpenChange:f,children:(0,b.jsxs)(o.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"Payment Details"}),(0,b.jsx)(o.DialogDescription,{children:"View and manage payment transaction"})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{className:"text-muted-foreground",children:"Reference"}),(0,b.jsx)("p",{className:"font-mono text-sm font-semibold",children:a.reference})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{className:"text-muted-foreground",children:"Status"}),(0,b.jsx)("div",{className:"mt-1",children:(a=>{switch(a){case"completed":return(0,b.jsxs)(h.Badge,{className:"bg-green-100 text-green-700 hover:bg-green-100",children:[(0,b.jsx)(k.CheckCircle,{className:"mr-1 h-3 w-3"}),"Completed"]});case"pending":return(0,b.jsxs)(h.Badge,{className:"bg-yellow-100 text-yellow-700 hover:bg-yellow-100",children:[(0,b.jsx)(m.Clock,{className:"mr-1 h-3 w-3"}),"Pending"]});case"failed":return(0,b.jsxs)(h.Badge,{className:"bg-red-100 text-red-700 hover:bg-red-100",children:[(0,b.jsx)(l.XCircle,{className:"mr-1 h-3 w-3"}),"Failed"]})}})(a.status)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{className:"text-muted-foreground",children:"User"}),(0,b.jsx)("p",{className:"font-medium",children:a.user}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{className:"text-muted-foreground",children:"Date"}),(0,b.jsx)("p",{className:"text-sm",children:a.date})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{className:"text-muted-foreground",children:"Service"}),(0,b.jsx)("p",{className:"text-sm",children:a.service})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{className:"text-muted-foreground",children:"Payment Method"}),(0,b.jsx)("p",{className:"text-sm",children:a.method})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{className:"text-muted-foreground",children:"Amount"}),(0,b.jsxs)("p",{className:"text-lg font-bold text-primary",children:["₦",a.amount.toLocaleString()]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"admin-notes",children:"Admin Notes"}),(0,b.jsx)(p.Textarea,{id:"admin-notes",placeholder:"Add notes about this payment...",value:g,onChange:a=>i(a.target.value),rows:3})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:["pending"===a.status&&(0,b.jsxs)(e.Button,{onClick:()=>{console.log("[v0] Marking payment as paid:",a.id),alert(`Payment ${a.reference} marked as paid`),f()},className:"flex items-center gap-2",children:[(0,b.jsx)(k.CheckCircle,{className:"h-4 w-4"}),"Mark as Paid"]}),"failed"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(e.Button,{onClick:x,className:"flex items-center gap-2",disabled:n,children:[(0,b.jsx)(s,{className:"h-4 w-4"}),n?"Processing...":"Retry Service"]}),(0,b.jsxs)(e.Button,{onClick:w,variant:"destructive",className:"flex items-center gap-2",disabled:n,children:[(0,b.jsx)(r.RefreshCw,{className:"h-4 w-4"}),n?"Processing...":"Process Refund"]})]}),(0,b.jsx)(e.Button,{variant:"outline",onClick:f,children:"Close"})]})]})]})})}function w(){let[a,o]=(0,c.useState)(""),[p,q]=(0,c.useState)("all"),[r,s]=(0,c.useState)("all"),[t,u]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)({totalPayments:0,pendingPayments:0,completedPayments:0,failedPayments:0}),[E,F]=(0,c.useState)([]);(0,c.useEffect)(()=>{let b=new AbortController;return(async()=>{try{z(!0),B(null);let c=new URLSearchParams;a&&c.set("q",a),"all"!==p&&c.set("status",p),"all"!==r&&c.set("method",r);let d=await fetch(`/api/admin/payments?${c.toString()}`,{method:"GET",signal:b.signal}),e=await d.json();if(!d.ok||!e.ok)throw Error(e.error||"Failed to load payments");F(e.payments||[]),D(e.summary||{totalPayments:0,pendingPayments:0,completedPayments:0,failedPayments:0})}catch(a){"AbortError"!==a.name&&B(a.message||String(a))}finally{z(!1)}})(),()=>b.abort()},[a,p,r]);let G=E.filter(b=>{let c=b.user.toLowerCase().includes(a.toLowerCase())||b.email.toLowerCase().includes(a.toLowerCase())||b.reference.toLowerCase().includes(a.toLowerCase()),d="all"===p||b.status===p,e="all"===r||b.method===r;return c&&d&&e});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Payments"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Track and manage all payment transactions"})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardDescription,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.DollarSign,{className:"h-4 w-4"}),"Total Payments"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["₦",C.totalPayments.toLocaleString()]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardDescription,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Clock,{className:"h-4 w-4"}),"Pending"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-yellow-600",children:["₦",C.pendingPayments.toLocaleString()]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Awaiting confirmation"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardDescription,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.CheckCircle,{className:"h-4 w-4"}),"Completed"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["₦",C.completedPayments.toLocaleString()]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Successfully processed"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardDescription,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.XCircle,{className:"h-4 w-4"}),"Failed"]})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-red-600",children:["₦",C.failedPayments.toLocaleString()]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Requires attention"})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Filter Payments"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsx)(f.Input,{placeholder:"Search by user, email, or reference...",value:a,onChange:a=>o(a.target.value)})}),(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsxs)(g.Select,{value:p,onValueChange:q,children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{placeholder:"Filter by status"})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"all",children:"All Statuses"}),(0,b.jsx)(g.SelectItem,{value:"completed",children:"Completed"}),(0,b.jsx)(g.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(g.SelectItem,{value:"failed",children:"Failed"})]})]})}),(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsxs)(g.Select,{value:r,onValueChange:s,children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{placeholder:"Filter by method"})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"all",children:"All Methods"}),(0,b.jsx)(g.SelectItem,{value:"Card",children:"Card"}),(0,b.jsx)(g.SelectItem,{value:"Bank Transfer",children:"Bank Transfer"}),(0,b.jsx)(g.SelectItem,{value:"Wallet",children:"Wallet"})]})]})})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Payment Transactions"}),(0,b.jsxs)(d.CardDescription,{children:[y?"Loading payments...":`Showing ${G.length} transactions`,A?` • Error: ${A}`:""]})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("th",{className:"pb-3 text-left text-sm font-medium text-muted-foreground",children:"Reference"}),(0,b.jsx)("th",{className:"pb-3 text-left text-sm font-medium text-muted-foreground",children:"User"}),(0,b.jsx)("th",{className:"pb-3 text-left text-sm font-medium text-muted-foreground",children:"Service"}),(0,b.jsx)("th",{className:"pb-3 text-left text-sm font-medium text-muted-foreground",children:"Amount"}),(0,b.jsx)("th",{className:"pb-3 text-left text-sm font-medium text-muted-foreground",children:"Method"}),(0,b.jsx)("th",{className:"pb-3 text-left text-sm font-medium text-muted-foreground",children:"Status"}),(0,b.jsx)("th",{className:"pb-3 text-left text-sm font-medium text-muted-foreground",children:"Date"}),(0,b.jsx)("th",{className:"pb-3 text-left text-sm font-medium text-muted-foreground",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:G.map(a=>(0,b.jsxs)("tr",{className:"border-b last:border-0",children:[(0,b.jsx)("td",{className:"py-3 text-sm font-mono",children:a.reference}),(0,b.jsxs)("td",{className:"py-3",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:a.user}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.email})]}),(0,b.jsx)("td",{className:"py-3 text-sm",children:a.service}),(0,b.jsxs)("td",{className:"py-3 text-sm font-semibold",children:["₦",a.amount.toLocaleString()]}),(0,b.jsx)("td",{className:"py-3",children:(0,b.jsxs)(h.Badge,{variant:"outline",className:"flex w-fit items-center gap-1",children:[(0,b.jsx)(j.CreditCard,{className:"h-3 w-3"}),a.method]})}),(0,b.jsx)("td",{className:"py-3",children:(a=>{switch(a){case"completed":return(0,b.jsxs)(h.Badge,{className:"bg-green-100 text-green-700 hover:bg-green-100",children:[(0,b.jsx)(k.CheckCircle,{className:"mr-1 h-3 w-3"}),"Completed"]});case"pending":return(0,b.jsxs)(h.Badge,{className:"bg-yellow-100 text-yellow-700 hover:bg-yellow-100",children:[(0,b.jsx)(m.Clock,{className:"mr-1 h-3 w-3"}),"Pending"]});case"failed":return(0,b.jsxs)(h.Badge,{className:"bg-red-100 text-red-700 hover:bg-red-100",children:[(0,b.jsx)(l.XCircle,{className:"mr-1 h-3 w-3"}),"Failed"]})}})(a.status)}),(0,b.jsx)("td",{className:"py-3 text-sm text-muted-foreground",children:a.date}),(0,b.jsx)("td",{className:"py-3",children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{u(a),x(!0)},children:(0,b.jsx)(n.Eye,{className:"h-4 w-4"})})})]},a.id))})]})})})]}),t&&(0,b.jsx)(v,{payment:t,isOpen:w,onClose:()=>x(!1)})]})}a.s(["default",()=>w],155219)}];

//# sourceMappingURL=app_admin_payments_page_tsx_d4709851._.js.map