module.exports=[167453,a=>{"use strict";let b=(0,a.i(170106).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],167453)},370975,a=>{"use strict";var b=a.i(572131),c=a.i(677050);function d(a){try{let b=String(a?.role||"").toLowerCase(),c=Array.isArray(a?.roles)?a.roles.map(a=>String(a).toLowerCase()):[];return b.includes("marketer")||c.includes("marketer")||a?.isMarketer===!0?"marketer":"user"}catch{return"user"}}async function e(){try{let a=await fetch("/api/me");if(!a.ok)return"user";let b=await a.json().catch(()=>null);return d(b?.user||b)}catch{return"user"}}function f(a,f,g,h,i){let[j,k]=(0,b.useState)(()=>d(i)),[l,m]=(0,b.useState)(null),[n,o]=(0,b.useState)(!1),[p,q]=(0,b.useState)(null),[r,s]=(0,b.useState)(void 0),t=(0,b.useMemo)(()=>({category:String(a||"").trim(),subservice:String(f||"").trim(),variant:String(g||"").trim()}),[a,f,g]),u=(0,b.useMemo)(()=>{if(!h||"object"!=typeof h)return"";let a=Object.entries(h).filter(([a,b])=>null!=b);return a.length?(a.sort(([a],[b])=>a.localeCompare(b)),a.map(([a,b])=>`${a}=${String(b)}`).join("|")):""},[h]);return(0,b.useEffect)(()=>{let a=!1;return(async()=>{o(!0),q(null);try{let b=i?d(i):await e();a||k(b);let c=[["category",t.category],["subservice",t.subservice],["variant",t.variant],["role",b]];if(h&&"object"==typeof h){let a=Object.entries(h).filter(([a,b])=>null!=b);for(let[b,d]of(a.sort(([a],[b])=>a.localeCompare(b)),a))c.push([b,String(d)])}let f=new URLSearchParams(c),g=await fetch(`/api/pricing?${f.toString()}`,{cache:"no-store"}),j=await g.json().catch(()=>null);if(!g.ok)throw Error(String(j?.error||"Failed to load pricing"));let l=j?.price;m("number"==typeof l?l:null)}catch(a){q(a?.message||"Failed to fetch pricing"),m(null)}finally{a||o(!1)}})(),()=>{a=!0}},[t.category,t.subservice,t.variant,u,i]),{price:l,isLoading:n,error:p,reference:r,submitService:(0,b.useCallback)(async a=>{try{let b={amount:Number(a.amount),idempotencyKey:"string"==typeof a.idempotencyKey?a.idempotencyKey:void 0,params:{...a||{}},subServiceId:t.variant||void 0,action:function(a,b){let c=a.trim().toLowerCase(),d=b.trim().toLowerCase();if("nin"===c){if("slip"===d)return"nin.slip";if("printout"===d)return"nin.printout";if("advanced"===d||"verification"===d)return"nin.advanced"}if("bvn"===c){if("printout"===d)return"bvn.printout";if("retrieval"===d||"retrieval_phone"===d)return"bvn.retrieval_phone";if("advanced"===d||"verification"===d)return"bvn.advanced"}if("cac"===c){if("info"===d)return"cac.info";if("status"===d)return"cac.status"}return"passport"===c&&("verify"===d||"verification"===d||"basic"===d)?"passport.verify":"phone"===c&&("advanced"===d||"verification"===d||"basic"===d)?"phone.verify_advanced":("driver-license"===c||"drivers_license"===c)&&("basic"===d||"verification"===d)?"drivers_license.verify":("voters-card"===c||"voters"===c)&&("basic"===d||"full"===d||"verification"===d)?"voters.verify":("plate-number"===c||"plate"===c)&&("basic"===d||"verification"===d)?"plate.verify":"tin"===c&&("basic"===d||"certificate"===d||"verification"===d)?"tin.verify":null}(t.category,t.subservice)||void 0,pin:a.pin},d=await (0,c.authFetch)(`/api/service/${encodeURIComponent(t.category)}/${encodeURIComponent(t.subservice)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(b)}),e=await d.json().catch(()=>null);if(!d.ok)return{ok:!1,error:String(e?.error||`Service failed (${d.status})`),message:String(e?.message||"Failed"),data:e};return s(String(e?.reference||"")),{ok:!0,reference:String(e?.reference||""),message:String(e?.message||""),data:e}}catch(a){return{ok:!1,error:String(a?.message||a)}}},[t.category,t.subservice,t.variant])}}a.s(["default",0,f,"useDynamicPricing",()=>f])},464286,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(965733),e=a.i(340695),f=a.i(205522),g=a.i(917171),h=a.i(823292);function i({isOpen:a,onClose:i,onConfirm:j,isLoading:k}){let[l,m]=(0,c.useState)(""),n=()=>{4!==l.length?h.toast.error("Please enter a 4-digit PIN"):(j(l),m(""))};return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:a=>!a&&i(),children:(0,b.jsxs)(d.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(d.DialogHeader,{children:[(0,b.jsx)(d.DialogTitle,{children:"Enter Transaction PIN"}),(0,b.jsx)(d.DialogDescription,{children:"Please enter your 4-digit transaction PIN to authorize this request."})]}),(0,b.jsx)("div",{className:"space-y-4 py-4",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"pin",className:"text-center block",children:"PIN"}),(0,b.jsx)(f.Input,{id:"pin",type:"password",inputMode:"numeric",maxLength:4,value:l,onChange:a=>m(a.target.value.replace(/\D/g,"")),className:"text-center text-2xl tracking-[1em]",placeholder:"••••",autoFocus:!0,onKeyDown:a=>{"Enter"===a.key&&n()}})]})}),(0,b.jsxs)(d.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:i,disabled:k,children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:n,disabled:k||4!==l.length,className:"bg-[#3457D5]",children:k?"Verifying...":"Confirm PIN"})]})]})})}a.s(["PinPrompt",()=>i])},487228,a=>{"use strict";function b(a,c,d="Error"){c({title:d,description:a.error||a.message||"An unexpected error occurred",variant:"destructive"})}a.s(["handleServiceError",()=>b])},501027,a=>{"use strict";let b=(0,a.i(170106).default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);a.s(["Zap",()=>b],501027)},653277,a=>{"use strict";let b=(0,a.i(170106).default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);a.s(["TrendingDown",()=>b],653277)},53569,a=>{"use strict";let b=(0,a.i(170106).default)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);a.s(["Share2",()=>b],53569)},83105,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(370975),e=a.i(703130),f=a.i(340695),g=a.i(205522),h=a.i(917171),i=a.i(887682),j=a.i(254161),k=a.i(950463),l=a.i(277687),m=a.i(346271),n=a.i(53569),o=a.i(856738),p=a.i(167453),q=a.i(501027),r=a.i(653277),s=a.i(965733),t=a.i(464286),u=a.i(487228);function v(){var a;let{toast:v}=(0,l.useToast)(),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(0),[E,F]=(0,c.useState)(0),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!0),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(null);(0,c.useEffect)(()=>{let a=localStorage.getItem("ufriends_wallet_balance");D(a?Number.parseFloat(a):0),setTimeout(()=>L(!1),800)},[]);let{price:W,isLoading:X,error:Y,submitService:Z}=(0,d.default)("airtime","share-n-sell","",w?{network:({MTN:"mtn",Airtel:"airtel",Glo:"glo","9mobile":"9mobile"})[a=String(w)]||a.toLowerCase()}:void 0);(0,c.useEffect)(()=>{if(!w||!A){H(null),F(0);return}let a=Number.parseFloat(A)||0;J(!0);let b="number"==typeof W?Number(W):null;null!=b?(H(b),F(Math.max(0,Math.round(a+b)))):(H(null),F(0)),J(!1)},[w,A,W]);let $=async()=>{w&&y&&A?11!==y.length?v({title:"Invalid Number",description:"Phone number must be 11 digits",variant:"destructive"}):50>Number.parseFloat(A)?v({title:"Amount Too Low",description:"Minimum airtime amount is ₦50",variant:"destructive"}):C<E?v({title:"Insufficient Balance",description:`Your wallet balance (₦${C.toLocaleString()}) is less than ₦${E.toLocaleString()}`,variant:"destructive"}):"number"!=typeof W?v({title:"Pricing Unavailable",description:"Live pricing could not be fetched.",variant:"destructive"}):(V({amount:Number.parseFloat(A),phone:y,network:w,idempotencyKey:crypto.randomUUID(),category:"airtime",action:"share-n-sell"}),T(!0)):v({title:"Missing Information",description:"Please fill in all fields",variant:"destructive"})},_=async a=>{T(!1),N(!0);try{let b=await Z({...U,pin:a});if(!b?.ok)return void(0,u.handleServiceError)(b,v,"Transaction Failed");R(b?.reference||`SNS-${Date.now()}`),P(!0),v({title:"Airtime Sent Successfully!",description:`₦${A} airtime sent to ${y}`}),x(""),z(""),B("")}catch(a){v({title:"Transaction Failed",description:a?.message||"Unable to complete purchase",variant:"destructive"})}finally{N(!1)}};return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,b.jsxs)(m.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,b.jsx)("div",{className:"p-3 rounded-2xl bg-[#3457D5]/10",children:(0,b.jsx)(n.Share2,{className:"h-8 w-8 text-[#3457D5]"})}),(0,b.jsx)("h1",{className:"text-4xl font-bold text-foreground",children:"Share 'n Sell"})]}),(0,b.jsx)("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Buy airtime instantly from UFriends automated system with discounted rates"})]}),(0,b.jsx)(m.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1},children:(0,b.jsx)(e.Card,{className:"bg-gradient-to-r from-[#3457D5]/10 to-[#CCCCFF]/20 border-[#3457D5]/30",children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-[#3457D5]/20",children:(0,b.jsx)(o.Wallet,{className:"h-5 w-5 text-[#3457D5]"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Wallet Balance"}),K?(0,b.jsx)(k.Skeleton,{className:"h-8 w-32 mt-1"}):(0,b.jsxs)("p",{className:"text-2xl font-bold text-[#3457D5]",children:["₦",C.toLocaleString()]})]})]}),(0,b.jsxs)(j.Badge,{className:"bg-[#3457D5] text-white",children:[(0,b.jsx)(q.Zap,{className:"h-3 w-3 mr-1"}),"Instant"]})]})})})}),(0,b.jsx)(m.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,b.jsxs)(e.Card,{className:"border-2 border-[#3457D5]/20",children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{className:"text-2xl",children:"Buy Airtime"}),(0,b.jsx)(e.CardDescription,{children:"Select network, enter recipient number and amount"})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"network",children:"Network Provider"}),(0,b.jsxs)(i.Select,{value:w,onValueChange:a=>x(a),children:[(0,b.jsx)(i.SelectTrigger,{id:"network",className:"border-[#3457D5]/30",children:(0,b.jsx)(i.SelectValue,{placeholder:"Choose network"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"MTN",children:"MTN"}),(0,b.jsx)(i.SelectItem,{value:"Airtel",children:"Airtel"}),(0,b.jsx)(i.SelectItem,{value:"Glo",children:"Glo"}),(0,b.jsx)(i.SelectItem,{value:"9mobile",children:"9mobile"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"recipient",children:"Recipient Phone Number"}),(0,b.jsx)(g.Input,{id:"recipient",type:"tel",placeholder:"08012345678",value:y,onChange:a=>z(a.target.value.replace(/\D/g,"").slice(0,11)),className:"border-[#3457D5]/30"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"amount",children:"Airtime Amount (₦)"}),(0,b.jsx)(g.Input,{id:"amount",type:"number",placeholder:"Enter amount",value:A,onChange:a=>B(a.target.value),className:"border-[#3457D5]/30"})]}),w&&A&&(0,b.jsxs)(m.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"p-4 rounded-xl bg-[#CCCCFF]/20 border border-[#3457D5]/20 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Airtime Value:"}),(0,b.jsxs)("span",{className:"font-semibold",children:["₦",Number.parseFloat(A).toLocaleString()]})]}),null!=G?(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,b.jsx)(r.TrendingDown,{className:"h-4 w-4 text-green-600"}),"Service Fee:"]}),(0,b.jsx)("span",{className:"font-semibold",children:I?"Loading...":`₦${G.toLocaleString()}`})]}):(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Fetching live price…"}),(0,b.jsx)("span",{className:"font-semibold",children:I?"Loading...":"—"})]}),(0,b.jsxs)("div",{className:"pt-2 border-t border-[#3457D5]/20 flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:"You Pay:"}),(0,b.jsxs)("span",{className:"text-2xl font-bold text-[#3457D5]",children:["₦",E.toLocaleString()]})]})]}),(0,b.jsx)(f.Button,{onClick:$,disabled:M||!w||!y||!A,className:"w-full h-12 text-lg bg-[#3457D5] hover:bg-[#3457D5]/90",children:M?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.motion.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"mr-2",children:(0,b.jsx)(q.Zap,{className:"h-5 w-5"})}),"Processing..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Share2,{className:"mr-2 h-5 w-5"}),"Buy Airtime"]})})]})]})}),(0,b.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,b.jsx)(e.Card,{className:"border-[#3457D5]/20",children:(0,b.jsxs)(e.CardContent,{className:"pt-6 text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-[#3457D5]/10 flex items-center justify-center",children:(0,b.jsx)(q.Zap,{className:"h-6 w-6 text-[#3457D5]"})}),(0,b.jsx)("h3",{className:"font-semibold",children:"Instant Delivery"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Airtime sent within seconds"})]})}),(0,b.jsx)(e.Card,{className:"border-[#3457D5]/20",children:(0,b.jsxs)(e.CardContent,{className:"pt-6 text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-green-500/10 flex items-center justify-center",children:(0,b.jsx)(r.TrendingDown,{className:"h-6 w-6 text-green-600"})}),(0,b.jsx)("h3",{className:"font-semibold",children:"Discounted Rates"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Save up to 6% on every purchase"})]})}),(0,b.jsx)(e.Card,{className:"border-[#3457D5]/20",children:(0,b.jsxs)(e.CardContent,{className:"pt-6 text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-[#CCCCFF]/30 flex items-center justify-center",children:(0,b.jsx)(o.Wallet,{className:"h-6 w-6 text-[#3457D5]"})}),(0,b.jsx)("h3",{className:"font-semibold",children:"Wallet Payment"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Secure and convenient"})]})})]}),(0,b.jsx)(s.Dialog,{open:O,onOpenChange:P,children:(0,b.jsxs)(s.DialogContent,{className:"border-[#3457D5]/30",children:[(0,b.jsxs)(s.DialogHeader,{children:[(0,b.jsx)("div",{className:"mx-auto w-16 h-16 rounded-full bg-green-500/10 flex items-center justify-center mb-4",children:(0,b.jsx)(p.CheckCircle2,{className:"h-10 w-10 text-green-600"})}),(0,b.jsx)(s.DialogTitle,{className:"text-center text-2xl",children:"Transaction Successful!"}),(0,b.jsxs)(s.DialogDescription,{className:"text-center space-y-3 pt-4",children:[(0,b.jsxs)("p",{className:"text-base",children:["₦",A," airtime has been sent to ",(0,b.jsx)("strong",{children:y})]}),(0,b.jsxs)("div",{className:"p-3 bg-[#F9F7F3] rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Transaction ID"}),(0,b.jsx)("p",{className:"font-mono font-semibold text-[#3457D5]",children:Q})]})]})]}),(0,b.jsx)(s.DialogFooter,{children:(0,b.jsx)(f.Button,{onClick:()=>P(!1),className:"w-full bg-[#3457D5]",children:"Done"})})]})}),(0,b.jsx)(t.PinPrompt,{isOpen:S,onClose:()=>T(!1),onConfirm:_,isLoading:M})]})}a.s(["default",()=>v])}];

//# sourceMappingURL=_f641e349._.js.map