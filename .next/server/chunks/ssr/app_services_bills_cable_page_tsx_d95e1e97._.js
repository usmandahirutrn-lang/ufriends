module.exports=[533524,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(346271),e=a.i(262036),f=a.i(340695),g=a.i(703130),h=a.i(205522),i=a.i(917171),j=a.i(887682),k=a.i(965733),l=a.i(950463),m=a.i(277687),n=a.i(136656),o=a.i(856738),p=a.i(167453),q=a.i(292e3),r=a.i(596221),s=a.i(677050),t=a.i(370975),u=a.i(464286),v=a.i(487228);let w={dstv:[{id:"dstv-padi",name:"DStv Padi",price:2500},{id:"dstv-yanga",name:"DStv Yanga",price:3500},{id:"dstv-confam",name:"DStv Confam",price:6200},{id:"dstv-compact",name:"DStv Compact",price:10500},{id:"dstv-compact-plus",name:"DStv Compact Plus",price:16600},{id:"dstv-premium",name:"DStv Premium",price:24500}],gotv:[{id:"gotv-smallie",name:"GOtv Smallie",price:1300},{id:"gotv-jinja",name:"GOtv Jinja",price:2700},{id:"gotv-jolli",name:"GOtv Jolli",price:3950},{id:"gotv-max",name:"GOtv Max",price:5700},{id:"gotv-supa",name:"GOtv Supa",price:7600}],startimes:[{id:"startimes-nova",name:"Nova",price:1200},{id:"startimes-basic",name:"Basic",price:2200},{id:"startimes-smart",name:"Smart",price:3e3},{id:"startimes-classic",name:"Classic",price:3600},{id:"startimes-super",name:"Super",price:5500}]};function x(){let[a,x]=(0,c.useState)(!0),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(0),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),{toast:O}=(0,m.useToast)(),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)({}),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(null),{price:Z,isLoading:$,submitService:_}=(0,t.default)("bills","cable",G);(0,c.useEffect)(()=>{let a=setTimeout(()=>{let a=localStorage.getItem("ufriends_wallet_balance");B(a?Number.parseFloat(a):5e4),x(!1)},800);return()=>clearTimeout(a)},[]),(0,c.useEffect)(()=>{(async()=>{try{let a=await (0,s.authFetch)("/api/me"),b=a.ok?await a.json():null;Q("MARKETER"===(b?.user?.role||""))}catch{Q(!1)}})()},[]);let aa=(a,b)=>{let c=a=>a.replace(/[^a-z0-9]+/gi,".").replace(/\.+/g,".").replace(/^\.|\.$/g,"").toLowerCase(),d=b.replace(/^dstv-|^gotv-|^startimes-/,"");return`bills.cable.${c(a)}.${c(d)}`};(0,c.useEffect)(()=>{(async()=>{if(!C)return S({});try{U(!0);let a=P?"marketer":"user",b=w[C]||[],c=b.map(a=>aa(C,a.id)),d=await Promise.all(c.map(async b=>{let c=await fetch(`/api/pricing?serviceSlug=${encodeURIComponent(b)}&tier=${a}`),d=await c.json().catch(()=>null),e=c.ok&&d?.price?.price!=null?Number(d.price.price):null;return{slug:b,price:e}})),e={};for(let a of b){let b=aa(C,a.id),c=d.find(a=>a.slug===b);e[a.id]=c?.price??a.price}S(e)}catch{let a=w[C]||[],b={};for(let c of a)b[c.id]=c.price;S(b)}finally{U(!1)}})()},[C,P]);let ab=C&&w[C]||[],ac=ab.find(a=>a.id===G),ad=Z||R[G]||ac?.price||0,ae=async a=>{W(!1),z(!0);try{let b=await _({...X,pin:a});if(!b.ok)return void(0,v.handleServiceError)(b,O,"Payment Failed");if(N(b.reference||`CBL${Date.now()}`),A>=ad){let a=A-ad;B(a)}L(!0),O({title:"Payment Successful!",description:`Your ${C.toUpperCase()} subscription has been renewed.`})}catch(a){O({title:"Error",description:a?.message||"An unexpected error occurred",variant:"destructive"})}finally{z(!1)}};return a?(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,b.jsx)(l.Skeleton,{className:"h-32 w-full"}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsx)(l.Skeleton,{className:"h-96 w-full"}),(0,b.jsx)(l.Skeleton,{className:"h-96 w-full"})]})]}):(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,b.jsx)("div",{className:"p-3 bg-[#3457D5]/10 rounded-full",children:(0,b.jsx)(n.Tv,{className:"h-10 w-10 text-[#3457D5]"})})}),(0,b.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Cable TV Subscription"}),(0,b.jsx)("p",{className:"text-lg text-gray-600",children:"Pay for DStv, GOtv, and StarTimes subscriptions"})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsx)(d.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:(0,b.jsxs)(g.Card,{className:"border-[#3457D5]/20 shadow-lg",children:[(0,b.jsxs)(g.CardHeader,{className:"bg-gradient-to-r from-[#3457D5]/5 to-[#CCCCFF]/10",children:[(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2 text-[#3457D5]",children:[(0,b.jsx)(n.Tv,{className:"h-5 w-5"}),"Pay Cable Bill"]}),(0,b.jsx)(g.CardDescription,{children:"Instant subscription renewal"})]}),(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("form",{onSubmit:a=>{(a.preventDefault(),C&&E&&G)?E.length<10?O({title:"Invalid Smartcard Number",description:"Please enter a valid smartcard/IUC number.",variant:"destructive"}):A<ad?O({title:"Insufficient Balance",description:`You need ₦${ad.toLocaleString()} but have ₦${A.toLocaleString()}.`,variant:"destructive"}):(Y({amount:ad,smartcardNumber:E,provider:C,planId:G,customerName:I}),W(!0)):O({title:"Missing Information",description:"Please fill in all required fields.",variant:"destructive"})},className:"space-y-4",children:[(0,b.jsx)("div",{className:"p-4 bg-[#F9F7F3] rounded-lg border border-[#3457D5]/10",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(o.Wallet,{className:"h-5 w-5 text-[#3457D5]"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Wallet Balance"})]}),(0,b.jsxs)("span",{className:"text-lg font-bold text-[#3457D5]",children:["₦",A.toLocaleString()]})]})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"provider",children:"Cable Provider *"}),(0,b.jsxs)(j.Select,{value:C,onValueChange:D,children:[(0,b.jsx)(j.SelectTrigger,{className:"border-[#3457D5]/20 focus:ring-[#3457D5]",children:(0,b.jsx)(j.SelectValue,{placeholder:"Select provider"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"dstv",children:"DStv"}),(0,b.jsx)(j.SelectItem,{value:"gotv",children:"GOtv"}),(0,b.jsx)(j.SelectItem,{value:"startimes",children:"StarTimes"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"smartcard",children:"Smartcard/IUC Number *"}),(0,b.jsx)(h.Input,{id:"smartcard",value:E,onChange:a=>F(a.target.value),placeholder:"Enter smartcard number",className:"border-[#3457D5]/20 focus:ring-[#3457D5]"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"plan",children:"Subscription Plan *"}),(0,b.jsxs)(j.Select,{value:G,onValueChange:H,disabled:!C,children:[(0,b.jsx)(j.SelectTrigger,{className:"border-[#3457D5]/20 focus:ring-[#3457D5]",children:(0,b.jsx)(j.SelectValue,{placeholder:"Select plan"})}),(0,b.jsx)(j.SelectContent,{children:ab.map(a=>{let c=R[a.id]??a.price;return(0,b.jsxs)(j.SelectItem,{value:a.id,children:[a.name," - ₦",T?"...":c.toLocaleString()]},a.id)})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"customer-name",children:"Customer Name (Optional)"}),(0,b.jsx)(h.Input,{id:"customer-name",value:I,onChange:a=>J(a.target.value),placeholder:"Account holder name",className:"border-[#3457D5]/20 focus:ring-[#3457D5]"})]}),ad>0&&(0,b.jsx)(d.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"p-4 bg-[#CCCCFF]/20 rounded-lg border border-[#3457D5]/20",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Total Amount"}),(0,b.jsxs)("span",{className:"text-2xl font-bold text-[#3457D5]",children:["₦",T?"...":ad.toLocaleString()]})]})}),(0,b.jsx)(f.Button,{type:"submit",disabled:y,className:"w-full bg-[#3457D5] hover:bg-[#3457D5]/90 text-white",children:y?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay Cable Bill"})]})})]})}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-4",children:[(0,b.jsxs)(g.Card,{className:"border-[#3457D5]/20",children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{className:"text-[#3457D5]",children:"Supported Providers"})}),(0,b.jsxs)(g.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 bg-[#F9F7F3] rounded-lg border border-[#3457D5]/10",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-900",children:"DStv"}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"All packages available"})]}),(0,b.jsxs)("div",{className:"p-3 bg-[#F9F7F3] rounded-lg border border-[#3457D5]/10",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-900",children:"GOtv"}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"All packages available"})]}),(0,b.jsxs)("div",{className:"p-3 bg-[#F9F7F3] rounded-lg border border-[#3457D5]/10",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-900",children:"StarTimes"}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"All packages available"})]})]})]}),(0,b.jsxs)(g.Card,{className:"border-[#3457D5]/20",children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2 text-[#3457D5]",children:[(0,b.jsx)(q.AlertCircle,{className:"h-5 w-5"}),"Important Notes"]})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600",children:[(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)(p.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,b.jsx)("span",{children:"Instant activation after payment"})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)(p.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,b.jsx)("span",{children:"Verify smartcard number before payment"})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)(p.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,b.jsx)("span",{children:"SMS confirmation sent after successful payment"})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)(p.CheckCircle2,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,b.jsx)("span",{children:"24/7 payment availability"})]})]})})]})]})]}),(0,b.jsx)(e.AnimatePresence,{children:K&&(0,b.jsx)(k.Dialog,{open:K,onOpenChange:L,children:(0,b.jsxs)(k.DialogContent,{className:"border-[#3457D5]/20",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)("div",{className:"flex justify-center mb-4",children:(0,b.jsx)("div",{className:"p-3 bg-green-100 rounded-full",children:(0,b.jsx)(p.CheckCircle2,{className:"h-12 w-12 text-green-600"})})}),(0,b.jsx)(k.DialogTitle,{className:"text-center text-2xl",children:"Payment Successful!"}),(0,b.jsx)(k.DialogDescription,{className:"text-center",children:"Your cable TV subscription has been renewed successfully."})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-[#F9F7F3] rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Transaction ID:"}),(0,b.jsx)("span",{className:"font-mono font-semibold text-[#3457D5]",children:M})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Provider:"}),(0,b.jsx)("span",{className:"font-semibold",children:C.toUpperCase()})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Plan:"}),(0,b.jsx)("span",{className:"font-semibold",children:ac?.name})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Amount Paid:"}),(0,b.jsxs)("span",{className:"font-semibold text-[#3457D5]",children:["₦",ad.toLocaleString()]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"New Balance:"}),(0,b.jsxs)("span",{className:"font-semibold",children:["₦",A.toLocaleString()]})]})]}),(0,b.jsx)(f.Button,{onClick:()=>{D(""),F(""),H(""),J(""),L(!1),N("")},className:"w-full bg-[#3457D5] hover:bg-[#3457D5]/90",children:"Make Another Payment"})]})]})})}),(0,b.jsx)(u.PinPrompt,{isOpen:V,onClose:()=>W(!1),onConfirm:ae,isLoading:y})]})}a.s(["default",()=>x])}];

//# sourceMappingURL=app_services_bills_cable_page_tsx_d95e1e97._.js.map