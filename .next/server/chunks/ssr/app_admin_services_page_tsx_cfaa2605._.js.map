{"version":3,"sources":["turbopack:///[project]/app/admin/services/page.tsx","turbopack:///[project]/components/admin/service-details-modal.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\"\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from \"@/components/ui/accordion\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\"\r\nimport { ServiceDetailsModal } from \"@/components/admin/service-details-modal\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\"\r\nimport { authFetch } from \"@/lib/client-auth\"\r\nimport { Badge as UIBadge } from \"@/components/ui/badge\"\r\nimport { EnhancedProviderManager } from \"@/components/admin/enhanced-provider-manager\"\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\"\r\n\r\ntype ServiceType = \"automated\" | \"manual\"\r\n\r\ninterface SubService {\r\n  id: string\r\n  name: string\r\n  type: ServiceType\r\n  status: \"up\" | \"down\" | \"manual\"\r\n  requests: number\r\n  successRate?: number\r\n  avgResponse?: string\r\n  _raw?: { serviceId: string; subServiceId?: string }\r\n}\r\n\r\ninterface ServiceCategory {\r\n  id: string\r\n  name: string\r\n  services: SubService[]\r\n}\r\n\r\nconst serviceCategories: ServiceCategory[] = [\r\n  {\r\n    id: \"vtu\",\r\n    name: \"Airtime & Data (VTU)\",\r\n    services: [\r\n      {\r\n        id: \"vtu-1\",\r\n        name: \"Airtime Purchase (Maskawa)\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 245,\r\n        successRate: 98,\r\n        avgResponse: \"85ms\",\r\n      },\r\n      {\r\n        id: \"vtu-2\",\r\n        name: \"Data Bundle (SubandGain)\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 198,\r\n        successRate: 96,\r\n        avgResponse: \"120ms\",\r\n      },\r\n      {\r\n        id: \"vtu-3\",\r\n        name: \"Ported SIM Activation\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 87,\r\n        successRate: 94,\r\n        avgResponse: \"150ms\",\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"bills\",\r\n    name: \"Bills & Education\",\r\n    services: [\r\n      {\r\n        id: \"bills-1\",\r\n        name: \"Electricity Payment (Maskawa)\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 156,\r\n        successRate: 97,\r\n        avgResponse: \"200ms\",\r\n      },\r\n      {\r\n        id: \"bills-2\",\r\n        name: \"Cable TV Subscription\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 134,\r\n        successRate: 95,\r\n        avgResponse: \"180ms\",\r\n      },\r\n      {\r\n        id: \"bills-3\",\r\n        name: \"WAEC Result Checker\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 89,\r\n        successRate: 99,\r\n        avgResponse: \"100ms\",\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"bvn\",\r\n    name: \"BVN Services\",\r\n    services: [\r\n      {\r\n        id: \"bvn-1\",\r\n        name: \"BVN Print-Out\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 342,\r\n        successRate: 97,\r\n        avgResponse: \"120ms\",\r\n      },\r\n      {\r\n        id: \"bvn-2\",\r\n        name: \"BVN Verification\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 278,\r\n        successRate: 98,\r\n        avgResponse: \"95ms\",\r\n      },\r\n      {\r\n        id: \"bvn-3\",\r\n        name: \"BVN Modification\",\r\n        type: \"manual\",\r\n        status: \"manual\",\r\n        requests: 45,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"nin\",\r\n    name: \"NIN Services\",\r\n    services: [\r\n      {\r\n        id: \"nin-1\",\r\n        name: \"NIN Slip\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 298,\r\n        successRate: 96,\r\n        avgResponse: \"110ms\",\r\n      },\r\n      {\r\n        id: \"nin-2\",\r\n        name: \"NIN Verification\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 234,\r\n        successRate: 97,\r\n        avgResponse: \"105ms\",\r\n      },\r\n      {\r\n        id: \"nin-3\",\r\n        name: \"NIN Modification\",\r\n        type: \"manual\",\r\n        status: \"manual\",\r\n        requests: 84,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"cac\",\r\n    name: \"CAC Services\",\r\n    services: [\r\n      {\r\n        id: \"cac-1\",\r\n        name: \"Business Name Registration\",\r\n        type: \"manual\",\r\n        status: \"manual\",\r\n        requests: 67,\r\n      },\r\n      {\r\n        id: \"cac-2\",\r\n        name: \"Company Registration\",\r\n        type: \"manual\",\r\n        status: \"manual\",\r\n        requests: 45,\r\n      },\r\n      {\r\n        id: \"cac-3\",\r\n        name: \"CAC Certificate Retrieval\",\r\n        type: \"manual\",\r\n        status: \"manual\",\r\n        requests: 38,\r\n      },\r\n      {\r\n        id: \"cac-4\",\r\n        name: \"CAC Status Report\",\r\n        type: \"manual\",\r\n        status: \"manual\",\r\n        requests: 27,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"verification\",\r\n    name: \"Verification Services\",\r\n    services: [\r\n      {\r\n        id: \"verify-1\",\r\n        name: \"Voters Card Verification\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 156,\r\n        successRate: 94,\r\n        avgResponse: \"140ms\",\r\n      },\r\n      {\r\n        id: \"verify-2\",\r\n        name: \"Driver's License Verification\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 123,\r\n        successRate: 96,\r\n        avgResponse: \"130ms\",\r\n      },\r\n      {\r\n        id: \"verify-3\",\r\n        name: \"International Passport Verification\",\r\n        type: \"automated\",\r\n        status: \"up\",\r\n        requests: 89,\r\n        successRate: 95,\r\n        avgResponse: \"150ms\",\r\n      },\r\n    ],\r\n  },\r\n]\r\n\r\n// Provider management types\r\ninterface ProviderMeta {\r\n  id: string\r\n  name: string\r\n  category: string\r\n  isActive: boolean\r\n  priority: number\r\n  apiBaseUrl?: string | null\r\n  apiKeys?: Array<{ id: string; keyName: string; createdAt: string; updatedAt: string }>\r\n}\r\n\r\nexport default function ServicesPage() {\r\n  const [selectedService, setSelectedService] = useState<SubService | null>(null)\r\n  const [isModalOpen, setIsModalOpen] = useState(false)\r\n\r\n  const handleViewService = (service: SubService) => {\r\n    setSelectedService(service)\r\n    setIsModalOpen(true)\r\n  }\r\n\r\n  const [providersByCategory, setProvidersByCategory] = useState<Record<string, ProviderMeta[]>>({})\r\n  const [loadingProviders, setLoadingProviders] = useState(false)\r\n  const [liveServices, setLiveServices] = useState<any[]>([])\r\n  const [metricsByService, setMetricsByService] = useState<Record<string, any>>({})\r\n  const [manualToggles, setManualToggles] = useState<Record<string, boolean>>({})\r\n  const [actionMsg, setActionMsg] = useState<string | null>(null)\r\n  const [editedPriorities, setEditedPriorities] = useState<Record<string, number>>({})\r\n  const [savingPriorityId, setSavingPriorityId] = useState<string | null>(null)\r\n  const [dragInfo, setDragInfo] = useState<{ category?: string; providerId?: string } | null>(null)\r\n  const categorySlugMap: Record<string, string> = {\r\n    vtu: \"airtime\",\r\n    bills: \"bills\",\r\n    bvn: \"bvn\",\r\n    nin: \"nin\",\r\n    cac: \"cac\",\r\n    verification: \"verification\",\r\n  }\r\n\r\n  const fetchProviders = async () => {\r\n    setLoadingProviders(true)\r\n    try {\r\n      const res = await authFetch(\"/api/admin/providers\")\r\n      if (!res.ok) throw new Error(\"Failed to fetch providers\")\r\n      const data = await res.json()\r\n      setProvidersByCategory(data.providersByCategory || {})\r\n    } catch (error) {\r\n      console.error(error)\r\n      setActionMsg(\"Failed to load providers\")\r\n    } finally {\r\n      setLoadingProviders(false)\r\n    }\r\n  }\r\n\r\n  const fetchServices = async () => {\r\n    try {\r\n      const res = await authFetch(\"/api/admin/services\", { method: \"GET\" })\r\n      const data = await res.json().catch(() => ({}))\r\n      const list = Array.isArray(data?.services) ? data.services : []\r\n      setLiveServices(list)\r\n    } catch (e) {\r\n      console.error(\"Failed to load services\", e)\r\n    }\r\n  }\r\n\r\n  const fetchMetrics = async () => {\r\n    try {\r\n      const res = await authFetch(\"/api/admin/services/metrics\", { method: \"GET\" })\r\n      const data = await res.json().catch(() => ({}))\r\n      const byService = (data?.byService || {}) as Record<string, any>\r\n      setMetricsByService(byService)\r\n    } catch (e) {\r\n      console.error(\"Failed to load metrics\", e)\r\n    }\r\n  }\r\n\r\n  const fetchManualToggles = async () => {\r\n    try {\r\n      const res = await authFetch(\"/api/admin/services/manual\", { method: \"GET\" })\r\n      const data = await res.json().catch(() => ({}))\r\n      const toggles = (data?.toggles || {}) as Record<string, boolean>\r\n      setManualToggles(toggles)\r\n    } catch (e) {\r\n      console.error(\"Failed to load manual toggles\", e)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchProviders()\r\n    fetchServices()\r\n    fetchMetrics()\r\n    fetchManualToggles()\r\n    const interval = setInterval(() => {\r\n      fetchMetrics()\r\n    }, 10000)\r\n    return () => clearInterval(interval)\r\n  }, [])\r\n\r\n  const setManualOnly = async (serviceId: string, subServiceId: string, enabled: boolean) => {\r\n    try {\r\n      const res = await authFetch(\"/api/admin/services/manual\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ serviceId, subServiceId, manualOnly: enabled })\r\n      })\r\n      const data = await res.json().catch(() => ({}))\r\n      if (res.ok) {\r\n        const key = `manual_only:${serviceId}:${subServiceId}`\r\n        setManualToggles((prev) => ({ ...prev, [key]: enabled }))\r\n        setActionMsg(`Manual-only ${enabled ? \"enabled\" : \"disabled\"} for ${serviceId}/${subServiceId}`)\r\n      } else {\r\n        setActionMsg(data?.error || \"Failed to set manual-only toggle\")\r\n      }\r\n    } catch (e) {\r\n      setActionMsg(\"Error updating manual-only toggle\")\r\n    }\r\n  }\r\n\r\n  const activateProvider = async (category: string, providerId: string) => {\r\n    try {\r\n      setActionMsg(null)\r\n      const res = await authFetch(`/api/admin/providers/category/${encodeURIComponent(category)}`, {\r\n        method: \"PATCH\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ activeProviderId: providerId })\r\n      })\r\n      const data = await res.json()\r\n      if (res.ok) {\r\n        setActionMsg(`Activated provider for ${category}`)\r\n        fetchProviders()\r\n      } else {\r\n        setActionMsg(data?.error || \"Failed to activate provider\")\r\n      }\r\n    } catch (e) {\r\n      setActionMsg(\"Error activating provider\")\r\n    }\r\n  }\r\n\r\n  const openApiKeyModal = (providerId: string, providerName: string) => {\r\n    setApiKeyModal({ open: true, providerId, providerName })\r\n    setNewKeyName(\"\")\r\n    setNewKeyValue(\"\")\r\n  }\r\n\r\n  const createApiKey = async () => {\r\n    if (!apiKeyModal.providerId) return\r\n    try {\r\n      setActionMsg(null)\r\n      const res = await authFetch(`/api/admin/providers/${apiKeyModal.providerId}/api-key`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ keyName: newKeyName, keyValue: newKeyValue })\r\n      })\r\n      const data = await res.json()\r\n      if (res.ok) {\r\n        setActionMsg(\"API key created\")\r\n        setApiKeyModal({ open: false })\r\n        fetchProviders()\r\n      } else {\r\n        setActionMsg(data?.error || \"Failed to create API key\")\r\n      }\r\n    } catch (e) {\r\n      setActionMsg(\"Error creating API key\")\r\n    }\r\n  }\r\n\r\n  const deleteApiKey = async (providerId: string, keyId: string) => {\r\n    try {\r\n      setActionMsg(null)\r\n      const res = await authFetch(`/api/admin/providers/${providerId}/api-key?keyId=${encodeURIComponent(keyId)}`, {\r\n        method: \"DELETE\"\r\n      })\r\n      const data = await res.json()\r\n      if (res.ok) {\r\n        setActionMsg(\"API key deleted\")\r\n        fetchProviders()\r\n      } else {\r\n        setActionMsg(data?.error || \"Failed to delete API key\")\r\n      }\r\n    } catch (e) {\r\n      setActionMsg(\"Error deleting API key\")\r\n    }\r\n  }\r\n\r\n  const setPriorityLocal = (providerId: string, value: number) => {\r\n    const safe = Number.isFinite(value) ? Math.max(0, Math.round(value)) : 0\r\n    setEditedPriorities((prev) => ({ ...prev, [providerId]: safe }))\r\n  }\r\n\r\n  const savePriority = async (providerId: string) => {\r\n    const value = editedPriorities[providerId]\r\n    if (value === undefined || value === null) return\r\n    try {\r\n      setSavingPriorityId(providerId)\r\n      setActionMsg(null)\r\n      const res = await authFetch(`/api/admin/providers/${providerId}`, {\r\n        method: \"PATCH\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ priority: Number(value) })\r\n      })\r\n      const data = await res.json().catch(() => ({}))\r\n      if (res.ok) {\r\n        setActionMsg(\"Priority updated\")\r\n        setSavingPriorityId(null)\r\n        // refresh and clear local edit\r\n        await fetchProviders()\r\n        setEditedPriorities((prev) => {\r\n          const next = { ...prev }\r\n          delete next[providerId]\r\n          return next\r\n        })\r\n      } else {\r\n        setSavingPriorityId(null)\r\n        setActionMsg(data?.error || \"Failed to update priority\")\r\n      }\r\n    } catch (e) {\r\n      setSavingPriorityId(null)\r\n      setActionMsg(\"Error updating priority\")\r\n    }\r\n  }\r\n\r\n  const onDragStart = (category: string, providerId: string) => {\r\n    setDragInfo({ category, providerId })\r\n  }\r\n\r\n  const onDragOver = (e: React.DragEvent) => {\r\n    e.preventDefault()\r\n  }\r\n\r\n  const onDropProvider = async (category: string, targetProviderId: string) => {\r\n    if (!dragInfo || dragInfo.category !== category || dragInfo.providerId === targetProviderId) return\r\n    const list = providersByCategory[category] || []\r\n    const fromIdx = list.findIndex((p) => p.id === dragInfo.providerId)\r\n    const toIdx = list.findIndex((p) => p.id === targetProviderId)\r\n    if (fromIdx < 0 || toIdx < 0) return\r\n    const newList = [...list]\r\n    const [moved] = newList.splice(fromIdx, 1)\r\n    newList.splice(toIdx, 0, moved)\r\n    setProvidersByCategory((prev) => ({ ...prev, [category]: newList }))\r\n\r\n    // Persist priorities: earlier rows get higher priority integers\r\n    const priorities: Record<string, number> = {}\r\n    for (let i = 0; i < newList.length; i++) {\r\n      const p = newList[i]\r\n      priorities[p.id] = newList.length - i // highest at top\r\n    }\r\n    try {\r\n      const res = await authFetch(`/api/admin/providers/category/${encodeURIComponent(category)}`, {\r\n        method: \"PATCH\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ priorities })\r\n      })\r\n      const data = await res.json().catch(() => ({}))\r\n      if (res.ok) {\r\n        setActionMsg(\"Provider order saved\")\r\n        fetchProviders()\r\n      } else {\r\n        setActionMsg(data?.error || \"Failed to save provider order\")\r\n      }\r\n    } catch (e) {\r\n      setActionMsg(\"Error saving provider order\")\r\n    } finally {\r\n      setDragInfo(null)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h1 className=\"text-3xl font-bold tracking-tight\">Service Management</h1>\r\n        <p className=\"text-muted-foreground\">Manage all UFriends services and monitor their performance.</p>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>All Services</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Accordion type=\"multiple\" className=\"w-full\">\r\n            {(liveServices.length\r\n              ? liveServices.map((svc: any) => ({\r\n                  id: svc.id,\r\n                  name: svc.name,\r\n                  services: (svc.subServices || []).map((sub: any, idx: number) => {\r\n                    const manualKey = `manual_only:${svc.id}:${sub?.id}`\r\n                    const manual = !!manualToggles[manualKey]\r\n                    const m = metricsByService[svc.id]\r\n                    const subMetrics = (m?.bySubService || {})[sub?.id ?? \"unknown\"]\r\n                    const total = subMetrics?.total || 0\r\n                    const success = subMetrics?.success || 0\r\n                    const successRate = total > 0 ? Math.round((success / total) * 100) : undefined\r\n                    return {\r\n                      id: `${svc.id}-${sub?.id ?? idx}`,\r\n                      name: sub?.name ?? \"Service\",\r\n                      type: manual ? \"manual\" : (\"automated\" as const),\r\n                      status: manual ? \"manual\" : (svc.isAvailable ? \"up\" : \"down\"),\r\n                      requests: total,\r\n                      successRate,\r\n                      avgResponse: undefined,\r\n                      _raw: { serviceId: svc.id, subServiceId: sub?.id },\r\n                    }\r\n                  }),\r\n                }))\r\n              : serviceCategories).map((category) => (\r\n              <AccordionItem key={category.id} value={category.id}>\r\n                <AccordionTrigger className=\"text-lg font-semibold\">{category.name}</AccordionTrigger>\r\n                <AccordionContent>\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Sub-Service</TableHead>\r\n                        <TableHead>Type</TableHead>\r\n                        <TableHead>Provider</TableHead>\r\n                        <TableHead>Status</TableHead>\r\n                        <TableHead>Requests</TableHead>\r\n                        <TableHead>Success Rate</TableHead>\r\n                        <TableHead>Avg Response</TableHead>\r\n                        <TableHead>Manual Only</TableHead>\r\n                        <TableHead>Actions</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {category.services.map((service) => (\r\n                        <TableRow key={service.id}>\r\n                          <TableCell className=\"font-medium\">{service.name}</TableCell>\r\n                          <TableCell>\r\n                            <Badge variant={service.type === \"automated\" ? \"default\" : \"secondary\"}>\r\n                              {service.type === \"automated\" ? \"Automated\" : \"Manual\"}\r\n                            </Badge>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            {(() => {\r\n                              // Prefer live provider info when available\r\n                              if (liveServices.length) {\r\n                                const live = liveServices.find((s: any) => s.id === category.id)\r\n                                const activeName = live?.providerInfo?.provider?.name\r\n                                const fallbacks = (live?.providerInfo?.fallbackProviders || [])\r\n                                if (activeName) {\r\n                                  return (\r\n                                    <span className=\"text-sm flex items-center gap-2\">\r\n                                      <UIBadge variant=\"default\" className=\"bg-green-600\">{activeName}</UIBadge>\r\n                                      {fallbacks.length > 0 && (\r\n                                        <span className=\"text-muted-foreground\">→ Fallbacks by priority</span>\r\n                                      )}\r\n                                    </span>\r\n                                  )\r\n                                }\r\n                                return <span className=\"text-sm text-muted-foreground\">No active provider</span>\r\n                              }\r\n                              // Fallback to providersByCategory mapping\r\n                              const slug = categorySlugMap[category.id]\r\n                              const providers = providersByCategory[slug] || providersByCategory[category.id] || []\r\n                              const active = providers.find((p) => p.isActive)\r\n                              return active ? (\r\n                                <span className=\"text-sm flex items-center gap-2\">\r\n                                  <UIBadge variant=\"default\" className=\"bg-green-600\">{active.name}</UIBadge>\r\n                                  {providers.filter((p) => !p.isActive && p.priority > 0).length > 0 && (\r\n                                    <span className=\"text-muted-foreground\">→ Fallbacks by priority</span>\r\n                                  )}\r\n                                </span>\r\n                              ) : (\r\n                                <span className=\"text-sm text-muted-foreground\">No active provider</span>\r\n                              )\r\n                            })()}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            {service.status === \"up\" && (\r\n                              <Badge variant=\"default\" className=\"bg-green-600\">\r\n                                Up\r\n                              </Badge>\r\n                            )}\r\n                            {service.status === \"down\" && <Badge variant=\"destructive\">Down</Badge>}\r\n                            {service.status === \"manual\" && <Badge variant=\"secondary\">Manual</Badge>}\r\n                          </TableCell>\r\n                          <TableCell>{service.requests}</TableCell>\r\n                          <TableCell>{service.successRate ? `${service.successRate}%` : \"—\"}</TableCell>\r\n                          <TableCell>{service.avgResponse || \"—\"}</TableCell>\r\n                          <TableCell>\r\n                            {(() => {\r\n                              const raw = (service as any)._raw\r\n                              if (!raw) return <span className=\"text-sm text-muted-foreground\">—</span>\r\n                              const manualKey = `manual_only:${raw.serviceId}:${raw.subServiceId}`\r\n                              const checked = !!manualToggles[manualKey]\r\n                              return (\r\n                                <label className=\"flex items-center gap-2 text-sm\">\r\n                                  <Input\r\n                                    type=\"checkbox\"\r\n                                    checked={checked}\r\n                                    onChange={(e) => setManualOnly(raw.serviceId, raw.subServiceId, e.target.checked)}\r\n                                  />\r\n                                  <span>{checked ? \"On\" : \"Off\"}</span>\r\n                                </label>\r\n                              )\r\n                            })()}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleViewService({\r\n                                ...service,\r\n                                _raw: { ...(service as any)._raw, serviceId: category.id }\r\n                              })}\r\n                            >\r\n                              View\r\n                            </Button>\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </AccordionContent>\r\n              </AccordionItem>\r\n            ))}\r\n          </Accordion>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {selectedService && (() => {\r\n        const svcId = (selectedService as any)._raw?.serviceId as string | undefined\r\n        const live = svcId ? liveServices.find((s: any) => s.id === svcId) : null\r\n        const activeProvider = live?.providerInfo?.provider\r\n        const providerName = activeProvider?.name as string | undefined\r\n        const providerBaseUrl = (activeProvider?.apiBaseUrl ?? null) as string | null\r\n        return (\r\n          <ServiceDetailsModal\r\n            service={selectedService}\r\n            open={isModalOpen}\r\n            onOpenChange={setIsModalOpen}\r\n            providerName={providerName}\r\n            providerBaseUrl={providerBaseUrl}\r\n          />\r\n        )\r\n      })()}\r\n\r\n      {/* Enhanced Provider Management */}\r\n      {/* Removed to keep provider management in dedicated /admin/providers page */}\r\n      {/* <EnhancedProviderManager /> */}\r\n\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Label } from \"@/components/ui/label\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Textarea } from \"@/components/ui/textarea\"\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\"\r\nimport { useState } from \"react\"\r\nimport { useToast } from \"@/hooks/use-toast\"\r\n\r\ninterface SubService {\r\n  id: string\r\n  name: string\r\n  type: \"automated\" | \"manual\"\r\n  status: \"up\" | \"down\" | \"manual\"\r\n  requests: number\r\n  successRate?: number\r\n  avgResponse?: string\r\n}\r\n\r\ninterface ServiceDetailsModalProps {\r\n  service: SubService\r\n  open: boolean\r\n  onOpenChange: (open: boolean) => void\r\n  providerName?: string\r\n  providerBaseUrl?: string | null\r\n}\r\n\r\nexport function ServiceDetailsModal({ service, open, onOpenChange, providerName, providerBaseUrl }: ServiceDetailsModalProps) {\r\n  const [status, setStatus] = useState(service.status)\r\n  const [assignedAgent, setAssignedAgent] = useState(\"\")\r\n  const { toast } = useToast()\r\n\r\n  const handleSave = () => {\r\n    toast({\r\n      title: \"Service Updated\",\r\n      description: `${service.name} has been updated successfully.`,\r\n    })\r\n    onOpenChange(false)\r\n  }\r\n\r\n  const handlePause = () => {\r\n    toast({\r\n      title: \"Service Paused\",\r\n      description: `${service.name} has been paused.`,\r\n      variant: \"destructive\",\r\n    })\r\n  }\r\n\r\n  const handleRetry = () => {\r\n    toast({\r\n      title: \"Retry Initiated\",\r\n      description: `Retrying ${service.name}...`,\r\n    })\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-2xl\">\r\n        <DialogHeader>\r\n          <DialogTitle>{service.name}</DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-6\">\r\n          {/* Service Info */}\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <div>\r\n              <Label>Service Type</Label>\r\n              <div className=\"mt-2\">\r\n                <Badge variant={service.type === \"automated\" ? \"default\" : \"secondary\"}>\r\n                  {service.type === \"automated\" ? \"Automated\" : \"Manual\"}\r\n                </Badge>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <Label>Current Status</Label>\r\n              <div className=\"mt-2\">\r\n                {status === \"up\" && (\r\n                  <Badge variant=\"default\" className=\"bg-green-600\">\r\n                    Up\r\n                  </Badge>\r\n                )}\r\n                {status === \"down\" && <Badge variant=\"destructive\">Down</Badge>}\r\n                {status === \"manual\" && <Badge variant=\"secondary\">Manual</Badge>}\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <Label>Total Requests</Label>\r\n              <p className=\"mt-2 text-2xl font-bold\">{service.requests}</p>\r\n            </div>\r\n\r\n            {service.successRate && (\r\n              <div>\r\n                <Label>Success Rate</Label>\r\n                <p className=\"mt-2 text-2xl font-bold text-green-600\">{service.successRate}%</p>\r\n              </div>\r\n            )}\r\n\r\n            {service.avgResponse && (\r\n              <div>\r\n                <Label>Average Response Time</Label>\r\n                <p className=\"mt-2 text-2xl font-bold\">{service.avgResponse}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Provider & API Endpoint (for automated services) */}\r\n          {service.type === \"automated\" && (\r\n            <div className=\"grid gap-4 md:grid-cols-2\">\r\n              <div>\r\n                <Label>Active Provider</Label>\r\n                <Input value={providerName || \"—\"} readOnly className=\"mt-2\" />\r\n              </div>\r\n              <div>\r\n                <Label>API Base URL</Label>\r\n                <Input value={providerBaseUrl || \"—\"} readOnly className=\"mt-2\" />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Cost Information */}\r\n          <div className=\"grid gap-4 md:grid-cols-3\">\r\n            <div>\r\n              <Label>Cost Price</Label>\r\n              <Input value=\"₦1,500\" readOnly className=\"mt-2\" />\r\n            </div>\r\n            <div>\r\n              <Label>User Price</Label>\r\n              <Input value=\"₦2,000\" readOnly className=\"mt-2\" />\r\n            </div>\r\n            <div>\r\n              <Label>Profit</Label>\r\n              <Input value=\"₦500\" readOnly className=\"mt-2 text-green-600\" />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Agent Assignment (for manual services) */}\r\n          {service.type === \"manual\" && (\r\n            <div>\r\n              <Label>Assign Agent</Label>\r\n              <Select value={assignedAgent} onValueChange={setAssignedAgent}>\r\n                <SelectTrigger className=\"mt-2\">\r\n                  <SelectValue placeholder=\"Select an agent\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"agent1\">Ahmed Musa</SelectItem>\r\n                  <SelectItem value=\"agent2\">Fatima Bello</SelectItem>\r\n                  <SelectItem value=\"agent3\">Chidi Okafor</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          )}\r\n\r\n          {/* Admin Notes */}\r\n          <div>\r\n            <Label>Admin Notes</Label>\r\n            <Textarea placeholder=\"Add notes about this service...\" className=\"mt-2\" />\r\n          </div>\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            <Button onClick={handleSave}>Save Changes</Button>\r\n            {service.type === \"automated\" && (\r\n              <>\r\n                <Button variant=\"outline\" onClick={handleRetry}>\r\n                  Retry\r\n                </Button>\r\n                <Button variant=\"destructive\" onClick={handlePause}>\r\n                  Pause Service\r\n                </Button>\r\n              </>\r\n            )}\r\n            <Button variant=\"secondary\" onClick={() => onOpenChange(false)}>\r\n              Close\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}