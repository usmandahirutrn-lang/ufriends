module.exports=[783431,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(703130),e=a.i(340695),f=a.i(254161),g=a.i(205522),h=a.i(917171),i=a.i(546893),j=a.i(588237),k=a.i(887682),l=a.i(965733),m=a.i(587532),n=a.i(177156),o=a.i(167453),p=a.i(641710),q=a.i(862722),r=a.i(104416),s=a.i(596221),t=a.i(823292);function u(){let[a,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)("ALL"),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(""),N=(0,c.useMemo)(()=>a.find(a=>a.id===D),[a,D]),O=(0,c.useMemo)(()=>{let b={total:0,pending:0,approved:0,rejected:0};return a.forEach(a=>{b.total+=1,"PENDING"===a.status?b.pending+=1:"APPROVED"===a.status?b.approved+=1:"REJECTED"===a.status&&(b.rejected+=1)}),b},[a]),P=(0,c.useMemo)(()=>{let b=[...a];if(z){let a=z.toLowerCase();b=b.filter(b=>b.userEmail?.toLowerCase().includes(a)||b.userId.toLowerCase().includes(a)||b.type.toLowerCase().includes(a))}return"ALL"!==B&&(b=b.filter(a=>a.status===B)),b},[a,z,B]),Q=async()=>{w(!0);try{let a=new URLSearchParams;B&&"ALL"!==B&&a.set("status",B),J&&a.set("from",J),L&&a.set("to",L);let b=await fetch(`/api/admin/kyc?${a.toString()}`),c=await b.json();if(!b.ok)throw Error(c?.error||"Failed to load KYC list");u(c.items||[])}catch(a){t.toast.error(a?.message||"Failed to load KYC requests")}finally{w(!1)}};(0,c.useEffect)(()=>{Q()},[B]);let R=async()=>{if(D){y(!0);try{let a=await fetch(`/api/kyc/${D}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"APPROVED",note:H||void 0})}),b=await a.json();if(!a.ok)throw Error(b?.error||"Failed to approve");t.toast.success("KYC Approved",{description:b?.reviewedByEmail?`By ${b.reviewedByEmail}`:""}),I(""),E(null),G(!1),await Q()}catch(a){t.toast.error("Error",{description:a.message})}finally{y(!1)}}},S=async()=>{if(D){if(!H.trim())return void t.toast.error("A note is required for rejection.");y(!0);try{let a=await fetch(`/api/kyc/${D}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"REJECTED",note:H||void 0})}),b=await a.json();if(!a.ok)throw Error(b?.error||"Failed to reject");t.toast.error("KYC Rejected",{description:b?.reviewedByEmail?`By ${b.reviewedByEmail}`:""}),I(""),E(null),G(!1),await Q()}catch(a){t.toast.error("Error",{description:a.message})}finally{y(!1)}}},T=a=>{switch(a){case"APPROVED":return(0,b.jsxs)(f.Badge,{className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,b.jsx)(o.CheckCircle2,{className:"h-3 w-3 mr-1"})," Approved"]});case"PENDING":return(0,b.jsxs)(f.Badge,{variant:"default",children:[(0,b.jsx)(p.Clock,{className:"h-3 w-3 mr-1"})," Pending"]});case"REJECTED":return(0,b.jsxs)(f.Badge,{variant:"destructive",children:[(0,b.jsx)(q.XCircle,{className:"h-3 w-3 mr-1"})," Rejected"]});default:return(0,b.jsx)(f.Badge,{children:a})}},U=a=>a?.documents.find(a=>"SELFIE"===a.type)?.fileUrl;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,b.jsx)(r.ShieldCheck,{className:"h-6 w-6 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"KYC Requests"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Review and manage user identity verification"})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,b.jsxs)(f.Badge,{variant:"secondary",children:["Total: ",O.total]}),(0,b.jsxs)(f.Badge,{children:["Pending: ",O.pending]}),(0,b.jsxs)(f.Badge,{className:"bg-green-600 text-white hover:bg-green-700",children:["Approved: ",O.approved]}),(0,b.jsxs)(f.Badge,{variant:"destructive",children:["Rejected: ",O.rejected]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"KYC Verification Requests"}),(0,b.jsx)(d.CardDescription,{children:"View and process identity verification submissions"})]}),(0,b.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto",children:[(0,b.jsxs)("div",{className:"relative flex-1 sm:w-64",children:[(0,b.jsx)(m.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(g.Input,{placeholder:"Search email, user ID...",value:z,onChange:a=>A(a.target.value),className:"pl-9"})]}),(0,b.jsxs)(k.Select,{value:B,onValueChange:C,children:[(0,b.jsx)(k.SelectTrigger,{className:"w-40",children:(0,b.jsx)(k.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"ALL",children:"All Status"}),(0,b.jsx)(k.SelectItem,{value:"PENDING",children:"Pending"}),(0,b.jsx)(k.SelectItem,{value:"APPROVED",children:"Approved"}),(0,b.jsx)(k.SelectItem,{value:"REJECTED",children:"Rejected"})]})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mt-4",children:[(0,b.jsx)(g.Input,{type:"date",value:J,onChange:a=>K(a.target.value),placeholder:"From Date",className:"w-auto"}),(0,b.jsx)(g.Input,{type:"date",value:L,onChange:a=>M(a.target.value),placeholder:"To Date",className:"w-auto"}),(0,b.jsxs)(e.Button,{onClick:Q,disabled:v,children:[v&&(0,b.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"})," Apply Filters"]})]})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"User"}),(0,b.jsx)(j.TableHead,{children:"Type"}),(0,b.jsx)(j.TableHead,{children:"Selfie"}),(0,b.jsx)(j.TableHead,{children:"Status"}),(0,b.jsx)(j.TableHead,{children:"Submitted"}),(0,b.jsx)(j.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(j.TableBody,{children:v?(0,b.jsx)(j.TableRow,{children:(0,b.jsx)(j.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:(0,b.jsx)(s.Loader2,{className:"mx-auto h-8 w-8 animate-spin"})})}):0===P.length?(0,b.jsx)(j.TableRow,{children:(0,b.jsx)(j.TableCell,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No KYC requests found"})}):P.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsxs)(j.TableCell,{className:"text-sm",children:[(0,b.jsx)("div",{className:"font-medium",children:a.userEmail||"Unknown"}),(0,b.jsx)("div",{className:"font-mono text-muted-foreground text-xs",children:a.userId})]}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(f.Badge,{variant:"outline",children:a.type})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)("img",{src:U(a)||"/placeholder.svg",alt:"Selfie",className:"h-10 w-10 rounded-full object-cover border"})}),(0,b.jsx)(j.TableCell,{children:T(a.status)}),(0,b.jsx)(j.TableCell,{className:"text-sm",children:new Date(a.submittedAt).toLocaleString()}),(0,b.jsx)(j.TableCell,{className:"text-right",children:(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>{E(a.id),I(""),G(!0)},children:[(0,b.jsx)(n.Eye,{className:"h-4 w-4 mr-2"})," View"]})})]},a.id))})]})})})]}),(0,b.jsx)(l.Dialog,{open:F,onOpenChange:G,children:(0,b.jsxs)(l.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(l.DialogHeader,{children:[(0,b.jsx)(l.DialogTitle,{children:"KYC Verification Details"}),(0,b.jsx)(l.DialogDescription,{children:"Review and process this verification request"})]}),N&&(0,b.jsxs)("div",{className:"space-y-6 py-4",children:[(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)("img",{src:U(N)||"/placeholder.svg",alt:"User selfie",className:"w-48 h-48 rounded-lg object-cover border"})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{className:"text-muted-foreground",children:"User"}),(0,b.jsx)("p",{className:"font-medium mt-1",children:N.userEmail||"Unknown"}),(0,b.jsx)("p",{className:"font-mono text-xs text-muted-foreground",children:N.userId})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{className:"text-muted-foreground",children:"Type"}),(0,b.jsx)("p",{className:"font-medium mt-1",children:N.type})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{className:"text-muted-foreground",children:"Status"}),(0,b.jsx)("div",{className:"mt-1",children:T(N.status)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{className:"text-muted-foreground",children:"Submitted At"}),(0,b.jsx)("p",{className:"text-sm mt-1",children:new Date(N.submittedAt).toLocaleString()})]}),N.reviewedAt&&(0,b.jsxs)("div",{children:[(0,b.jsx)(h.Label,{className:"text-muted-foreground",children:"Reviewed At"}),(0,b.jsx)("p",{className:"text-sm mt-1",children:new Date(N.reviewedAt).toLocaleString()})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{className:"text-muted-foreground",children:"Documents"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-3",children:N.documents.filter(a=>"SELFIE"!==a.type).length>0?N.documents.filter(a=>"SELFIE"!==a.type).map(a=>(0,b.jsxs)("a",{href:a.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"border rounded-md p-2 hover:bg-muted",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.type}),(0,b.jsx)("div",{className:"font-mono text-[11px] truncate",children:a.fileUrl})]},a.id)):(0,b.jsx)("div",{className:"text-sm text-muted-foreground col-span-2",children:"No supporting documents"})})]}),"PENDING"===N.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"approval-note",children:"Note (optional for approval, required for rejection)"}),(0,b.jsx)(i.Textarea,{id:"approval-note",value:H,onChange:a=>I(a.target.value),placeholder:"Add a note for this decision...",rows:3})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)(e.Button,{onClick:S,variant:"destructive",className:"flex-1",disabled:x,children:[x?(0,b.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(q.XCircle,{className:"mr-2 h-4 w-4"})," Reject"]}),(0,b.jsxs)(e.Button,{onClick:R,className:"flex-1",disabled:x,children:[x?(0,b.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(o.CheckCircle2,{className:"mr-2 h-4 w-4"})," Approve"]})]})]})]})]})})]})}a.s(["default",()=>u])}];

//# sourceMappingURL=app_admin_kyc-requests_page_tsx_9cb1d93a._.js.map