module.exports=[202098,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(703130),e=a.i(340695),f=a.i(205522),g=a.i(887682),h=a.i(546893),i=a.i(280281),j=a.i(970246),k=a.i(677050);let l=["generated_at","full_name","image","firstName","middleName","lastName","nin","dateOfBirth","gender","issueDate","qrCode","phone","address","stateOfOrigin","lga","trackingId","data.bvn","data.nin","data.firstName","data.lastName","data.middleName","data.dateOfBirth","data.gender","data.phoneNumber1","data.phoneNumber2","data.email","data.enrollmentBank","data.enrollmentBranch","data.registrationDate","data.residentialAddress","data.stateOfResidence","data.lgaOfResidence","data.stateOfOrigin","data.lgaOfOrigin","verification.status","verification.reference"],m=a=>!!a&&("photo"===a||"image"===a||"qrCode"===a);function n(){let[a,n]=(0,c.useState)(""),[p,q]=(0,c.useState)("digital"),[r,s]=(0,c.useState)(!0),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)("#ffffff"),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(l),B=(0,c.useRef)(null),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)({dx:0,dy:0}),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)("Segoe UI, Arial, sans-serif"),[M,N]=(0,c.useState)(12),[O,P]=(0,c.useState)("#000000"),[Q,R]=(0,c.useState)(794),[S,T]=(0,c.useState)(1123),[U,V]=(0,c.useState)("contain"),[W,X]=(0,c.useState)(!0),Y=a=>u(b=>[...b,a]),Z=(0,c.useCallback)(a=>{if(!C||!B.current)return;let b=B.current.getBoundingClientRect(),c=Math.max(0,Math.min(a.clientX-b.left-E.dx,b.width-10)),d=Math.max(0,Math.min(a.clientY-b.top-E.dy,b.height-10));u(a=>a.map(a=>a.id===C?{...a,x:c,y:d}:a))},[C,E]),$=(0,c.useMemo)(()=>t.find(a=>a.id===G)||null,[t,G]),_=()=>{let a=t.map(a=>{let b=`position:absolute; left:${Math.round(a.x)}px; top:${Math.round(a.y)}px;`,c=a.style?` font-family:${a.style.fontFamily||K}; font-size:${a.style.fontSize||M}px; color:${a.style.color||O}; ${a.style.fontWeight?`font-weight:${a.style.fontWeight};`:""}`:` font-family:${K}; font-size:${M}px; color:${O};`;if("text"===a.type){let d=` ${a.w?`width:${a.w}px;`:""}${a.h?`height:${a.h}px;`:""}`;return`<div style='${b};${c}${d}'>${a.content||"Text"}</div>`}if("image"===a.type){let c=a.content||"/placeholder.jpg";return`<img src='${c}' style='${b}; width:${a.w||100}px; height:${a.h||80}px; object-fit:cover;' />`}if("placeholder"===a.type){let d=a.content||"firstName";if(m(d))return`<img src='{{${d}}}' style='${b}; width:${a.w||100}px; height:${a.h||80}px; object-fit:cover;' />`;let e=` width:${a.w||160}px; height:${a.h||24}px;`;return`<div style='${b};${c}${e}'>{{${d}}}</div>`}return"box"===a.type?`<div style='${b}; width:${a.w||160}px; height:${a.h||80}px; border:1px solid #333;'></div>`:""}).join(""),b=o(x),c=b?`<img src='${b}' style='position:absolute;left:0;top:0;width:100%;height:100%;object-fit:${U};' />`:"",d=`<style>@page{size:${Q}px ${S}px;margin:0}html,body{margin:0;padding:0}</style>`;return`<!DOCTYPE html><html><head><meta charset='utf-8'>${d}</head><body style='background:${v};'><div style='position:relative;width:${Q}px;height:${S}px;'>${c}${a}</div></body></html>`},aa=async()=>{if(!a)return void(0,j.toast)({title:"Name required",description:"Enter a template name",variant:"destructive"});let b=_(),c=[...new Set(Array.from(b.matchAll(/\{\{\s*([a-zA-Z0-9_\.]+)\s*\}\}/g)).map(a=>`{{${a[1]}}}`))];try{let d=await (0,k.authFetch)("/api/admin/nin-templates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,type:p,templateContent:b,placeholders:c,isActive:r})});if(!d.ok){let a=await d.json().catch(()=>({}));throw Error(a?.error||`Failed (${d.status})`)}(0,j.toast)({title:"Template saved",description:a}),u([]),n(""),q("digital"),s(!0)}catch(a){(0,j.toast)({title:"Save failed",description:String(a?.message||a),variant:"destructive"})}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,b.jsx)("span",{className:"text-primary text-sm",children:"Builder"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"NIN Template Builder"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Drag placeholders and elements to compose a slip visually"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Canvas"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"grid md:grid-cols-[240px_1fr_260px] gap-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Name"}),(0,b.jsx)(f.Input,{value:a,onChange:a=>n(a.target.value),placeholder:"e.g., Digital Slip v2"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Type"}),(0,b.jsxs)(g.Select,{value:p,onValueChange:a=>q(a),children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"digital",children:"Digital"}),(0,b.jsx)(g.SelectItem,{value:"physical",children:"Physical"}),(0,b.jsx)(g.SelectItem,{value:"nims",children:"NIMS"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Switch,{checked:r,onCheckedChange:s}),(0,b.jsx)("span",{className:"text-sm",children:"Active"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Background"}),(0,b.jsx)(f.Input,{type:"color",value:v,onChange:a=>w(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Global Font"}),(0,b.jsxs)(g.Select,{value:K,onValueChange:a=>L(a),children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"Segoe UI, Arial, sans-serif",children:"Segoe UI"}),(0,b.jsx)(g.SelectItem,{value:"Arial, Helvetica, sans-serif",children:"Arial"}),(0,b.jsx)(g.SelectItem,{value:"Roboto, Arial, sans-serif",children:"Roboto"}),(0,b.jsx)(g.SelectItem,{value:"Times New Roman, Times, serif",children:"Times New Roman"}),(0,b.jsx)(g.SelectItem,{value:"Verdana, Geneva, sans-serif",children:"Verdana"}),(0,b.jsx)(g.SelectItem,{value:"Tahoma, Geneva, sans-serif",children:"Tahoma"}),(0,b.jsx)(g.SelectItem,{value:"Calibri, Arial, sans-serif",children:"Calibri"}),(0,b.jsx)(g.SelectItem,{value:"Georgia, Times, serif",children:"Georgia"}),(0,b.jsx)(g.SelectItem,{value:"Courier New, Courier, monospace",children:"Courier New"}),(0,b.jsx)(g.SelectItem,{value:"Open Sans, Arial, sans-serif",children:"Open Sans"}),(0,b.jsx)(g.SelectItem,{value:"Inter, Arial, sans-serif",children:"Inter"}),(0,b.jsx)(g.SelectItem,{value:"Poppins, Arial, sans-serif",children:"Poppins"}),(0,b.jsx)(g.SelectItem,{value:"Montserrat, Arial, sans-serif",children:"Montserrat"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"Size"}),(0,b.jsx)(f.Input,{type:"number",value:M,onChange:a=>N(Number(a.target.value)||12)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"Color"}),(0,b.jsx)(f.Input,{type:"color",value:O,onChange:a=>P(a.target.value)})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Background Image URL"}),(0,b.jsx)(f.Input,{value:x,onChange:a=>y(o(a.target.value)),placeholder:"/assets/nin/premium.png"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Upload in Admin → Assets, then paste the file URL here."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Canvas Size"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"Width"}),(0,b.jsx)(f.Input,{type:"number",value:Q,onChange:a=>R(Number(a.target.value)||794)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"Height"}),(0,b.jsx)(f.Input,{type:"number",value:S,onChange:a=>T(Number(a.target.value)||1123)})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Switch,{checked:W,onCheckedChange:X}),(0,b.jsx)("span",{className:"text-xs",children:"Use image intrinsic size"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Background Fit"}),(0,b.jsxs)(g.Select,{value:U,onValueChange:a=>V(a),children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"contain",children:"Contain"}),(0,b.jsx)(g.SelectItem,{value:"cover",children:"Cover"}),(0,b.jsx)(g.SelectItem,{value:"fill",children:"Fill"}),(0,b.jsx)(g.SelectItem,{value:"none",children:"None"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Add Element"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>Y({id:crypto.randomUUID(),type:"text",x:20,y:20,content:"Text"}),children:"Text"}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>Y({id:crypto.randomUUID(),type:"image",x:40,y:40,w:120,h:80,content:"/placeholder.jpg"}),children:"Image"}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>Y({id:crypto.randomUUID(),type:"box",x:60,y:60,w:160,h:80}),children:"Box"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Placeholders"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:z.map(a=>(0,b.jsx)(e.Button,{variant:"secondary",size:"sm",onClick:()=>Y({id:crypto.randomUUID(),type:"placeholder",x:80,y:80,content:a,w:m(a)?110:140,h:m(a)?110:20,style:{fontFamily:K,fontSize:M,color:O}}),children:`{{${a}}}`},a))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Custom Placeholder"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Input,{value:I,onChange:a=>J(a.target.value),placeholder:"e.g., nin"}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>I&&Y({id:crypto.randomUUID(),type:"placeholder",x:100,y:100,content:I,w:m(I)?110:140,h:m(I)?110:20,style:{fontFamily:K,fontSize:M,color:O}}),children:"Add"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Export HTML"}),(0,b.jsx)(h.Textarea,{readOnly:!0,rows:6,value:_()})]}),(0,b.jsx)(e.Button,{onClick:aa,children:"Save Template"})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("div",{ref:B,onMouseMove:Z,onMouseUp:()=>D(null),style:{background:v,width:Q,height:S},className:"relative border rounded-md overflow-hidden bg-white",children:[x?(0,b.jsx)("img",{src:o(x),alt:"bg",className:"absolute inset-0 w-full h-full",style:{objectFit:U},onLoad:a=>{if(!W)return;let b=a.currentTarget,c=b.naturalWidth||Q,d=b.naturalHeight||S;c&&d&&(R(c),T(d))}}):null,t.map(a=>(0,b.jsxs)("div",{onMouseDown:b=>{var c;let d;return c=a.id,d=b.currentTarget.getBoundingClientRect(),void(D(c),H(c),F({dx:b.clientX-d.left,dy:b.clientY-d.top}))},onClick:()=>H(a.id),className:`cursor-move ${G===a.id?"ring-2 ring-primary":""}`,style:{position:"absolute",left:a.x,top:a.y},children:["text"===a.type&&(0,b.jsx)("div",{className:"bg-white/70 px-2 py-1",style:{width:a.w||void 0,height:a.h||void 0,fontFamily:a.style?.fontFamily||K,fontSize:a.style?.fontSize||M,color:a.style?.color||O,fontWeight:a.style?.fontWeight},children:a.content||"Text"}),"image"===a.type&&(0,b.jsx)("img",{src:a.content||"/placeholder.jpg",width:a.w||100,height:a.h||80,alt:"img",className:"border"}),"placeholder"===a.type&&(m(a.content||"")?(0,b.jsx)("div",{style:{width:a.w||100,height:a.h||80},className:"border bg-amber-50 flex items-center justify-center text-xs",children:`{{${a.content}}}`}):(0,b.jsx)("div",{className:"bg-amber-50 border border-amber-200 px-2 py-1",style:{width:a.w||140,height:a.h||20,fontFamily:a.style?.fontFamily||K,fontSize:a.style?.fontSize||M,color:a.style?.color||O,fontWeight:a.style?.fontWeight},children:`{{${a.content}}}`})),"box"===a.type&&(0,b.jsx)("div",{style:{width:a.w||160,height:a.h||80},className:"border border-dashed bg-white/30"})]},a.id))]})}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Selected"}),$?(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{children:["Type: ",$.type]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"X"}),(0,b.jsx)(f.Input,{type:"number",value:Math.round($.x),onChange:a=>u(b=>b.map(b=>b.id===$.id?{...b,x:Number(a.target.value)}:b))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"Y"}),(0,b.jsx)(f.Input,{type:"number",value:Math.round($.y),onChange:a=>u(b=>b.map(b=>b.id===$.id?{...b,y:Number(a.target.value)}:b))})]}),("image"===$.type||"box"===$.type||"placeholder"===$.type)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"W"}),(0,b.jsx)(f.Input,{type:"number",value:$.w||0,onChange:a=>u(b=>b.map(b=>b.id===$.id?{...b,w:Number(a.target.value)}:b))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"H"}),(0,b.jsx)(f.Input,{type:"number",value:$.h||0,onChange:a=>u(b=>b.map(b=>b.id===$.id?{...b,h:Number(a.target.value)}:b))})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-xs",children:"Content"}),(0,b.jsx)(f.Input,{value:$.content||"",onChange:a=>{var b;return b=a.target.value,void(G&&u(a=>a.map(a=>a.id===G?{...a,content:b}:a)))}})]}),("text"===$.type||"placeholder"===$.type)&&!m($.content||"")&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"Font"}),(0,b.jsxs)(g.Select,{value:$.style?.fontFamily||K,onValueChange:a=>u(b=>b.map(b=>b.id===$.id?{...b,style:{...b.style||{},fontFamily:a}}:b)),children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"Segoe UI, Arial, sans-serif",children:"Segoe UI"}),(0,b.jsx)(g.SelectItem,{value:"Arial, Helvetica, sans-serif",children:"Arial"}),(0,b.jsx)(g.SelectItem,{value:"Roboto, Arial, sans-serif",children:"Roboto"}),(0,b.jsx)(g.SelectItem,{value:"Times New Roman, Times, serif",children:"Times New Roman"}),(0,b.jsx)(g.SelectItem,{value:"Verdana, Geneva, sans-serif",children:"Verdana"}),(0,b.jsx)(g.SelectItem,{value:"Tahoma, Geneva, sans-serif",children:"Tahoma"}),(0,b.jsx)(g.SelectItem,{value:"Calibri, Arial, sans-serif",children:"Calibri"}),(0,b.jsx)(g.SelectItem,{value:"Georgia, Times, serif",children:"Georgia"}),(0,b.jsx)(g.SelectItem,{value:"Courier New, Courier, monospace",children:"Courier New"}),(0,b.jsx)(g.SelectItem,{value:"Open Sans, Arial, sans-serif",children:"Open Sans"}),(0,b.jsx)(g.SelectItem,{value:"Inter, Arial, sans-serif",children:"Inter"}),(0,b.jsx)(g.SelectItem,{value:"Poppins, Arial, sans-serif",children:"Poppins"}),(0,b.jsx)(g.SelectItem,{value:"Montserrat, Arial, sans-serif",children:"Montserrat"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"Size"}),(0,b.jsx)(f.Input,{type:"number",value:$.style?.fontSize||M,onChange:a=>u(b=>b.map(b=>b.id===$.id?{...b,style:{...b.style||{},fontSize:Number(a.target.value)||M}}:b))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"Color"}),(0,b.jsx)(f.Input,{type:"color",value:$.style?.color||O,onChange:a=>u(b=>b.map(b=>b.id===$.id?{...b,style:{...b.style||{},color:a.target.value}}:b))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs",children:"Weight"}),(0,b.jsx)(f.Input,{type:"number",value:$.style?.fontWeight||400,onChange:a=>u(b=>b.map(b=>b.id===$.id?{...b,style:{...b.style||{},fontWeight:Number(a.target.value)||400}}:b))})]})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(e.Button,{variant:"destructive",size:"sm",onClick:()=>G&&u(a=>a.filter(a=>a.id!==G)),children:"Delete"})})]}):(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Click an element to edit"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Guidance"}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Use placeholders like ","{{data.bvn}}",", ","{{data.firstName}}",", ","{{data.dateOfBirth}}",". Dot paths are supported: e.g. ","{{verification.reference}}",". Saved templates appear in Admin → NIN Templates."]})]})]})]})})]})]})}let o=a=>{try{let b=String(a||"").trim();return b=b.replace(/\\\\/g,"/").replace(/\\/g,"/")}catch{return a}};a.s(["default",()=>n])}];

//# sourceMappingURL=app_admin_nin_templates_builder_page_tsx_ecf8a3e4._.js.map