module.exports=[370975,a=>{"use strict";var b=a.i(572131),c=a.i(677050);function d(a){try{let b=String(a?.role||"").toLowerCase(),c=Array.isArray(a?.roles)?a.roles.map(a=>String(a).toLowerCase()):[];return b.includes("marketer")||c.includes("marketer")||a?.isMarketer===!0?"marketer":"user"}catch{return"user"}}async function e(){try{let a=await fetch("/api/me");if(!a.ok)return"user";let b=await a.json().catch(()=>null);return d(b?.user||b)}catch{return"user"}}function f(a,f,g,h,i){let[j,k]=(0,b.useState)(()=>d(i)),[l,m]=(0,b.useState)(null),[n,o]=(0,b.useState)(!1),[p,q]=(0,b.useState)(null),[r,s]=(0,b.useState)(void 0),t=(0,b.useMemo)(()=>({category:String(a||"").trim(),subservice:String(f||"").trim(),variant:String(g||"").trim()}),[a,f,g]),u=(0,b.useMemo)(()=>{if(!h||"object"!=typeof h)return"";let a=Object.entries(h).filter(([a,b])=>null!=b);return a.length?(a.sort(([a],[b])=>a.localeCompare(b)),a.map(([a,b])=>`${a}=${String(b)}`).join("|")):""},[h]);return(0,b.useEffect)(()=>{let a=!1;return(async()=>{o(!0),q(null);try{let b=i?d(i):await e();a||k(b);let c=[["category",t.category],["subservice",t.subservice],["variant",t.variant],["role",b]];if(h&&"object"==typeof h){let a=Object.entries(h).filter(([a,b])=>null!=b);for(let[b,d]of(a.sort(([a],[b])=>a.localeCompare(b)),a))c.push([b,String(d)])}let f=new URLSearchParams(c),g=await fetch(`/api/pricing?${f.toString()}`,{cache:"no-store"}),j=await g.json().catch(()=>null);if(!g.ok)throw Error(String(j?.error||"Failed to load pricing"));let l=j?.price;m("number"==typeof l?l:null)}catch(a){q(a?.message||"Failed to fetch pricing"),m(null)}finally{a||o(!1)}})(),()=>{a=!0}},[t.category,t.subservice,t.variant,u,i]),{price:l,isLoading:n,error:p,reference:r,submitService:(0,b.useCallback)(async a=>{try{let b={amount:Number(a.amount),idempotencyKey:"string"==typeof a.idempotencyKey?a.idempotencyKey:void 0,params:{...a||{}},subServiceId:t.variant||void 0,action:function(a,b){let c=a.trim().toLowerCase(),d=b.trim().toLowerCase();if("nin"===c){if("slip"===d)return"nin.slip";if("printout"===d)return"nin.printout";if("advanced"===d||"verification"===d)return"nin.advanced"}if("bvn"===c){if("printout"===d)return"bvn.printout";if("retrieval"===d||"retrieval_phone"===d)return"bvn.retrieval_phone";if("advanced"===d||"verification"===d)return"bvn.advanced"}if("cac"===c){if("info"===d)return"cac.info";if("status"===d)return"cac.status"}return"passport"===c&&("verify"===d||"verification"===d||"basic"===d)?"passport.verify":"phone"===c&&("advanced"===d||"verification"===d||"basic"===d)?"phone.verify_advanced":("driver-license"===c||"drivers_license"===c)&&("basic"===d||"verification"===d)?"drivers_license.verify":("voters-card"===c||"voters"===c)&&("basic"===d||"full"===d||"verification"===d)?"voters.verify":("plate-number"===c||"plate"===c)&&("basic"===d||"verification"===d)?"plate.verify":"tin"===c&&("basic"===d||"certificate"===d||"verification"===d)?"tin.verify":null}(t.category,t.subservice)||void 0,pin:a.pin},d=await (0,c.authFetch)(`/api/service/${encodeURIComponent(t.category)}/${encodeURIComponent(t.subservice)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(b)}),e=await d.json().catch(()=>null);if(!d.ok)return{ok:!1,error:String(e?.error||`Service failed (${d.status})`),message:String(e?.message||"Failed"),data:e};return s(String(e?.reference||"")),{ok:!0,reference:String(e?.reference||""),message:String(e?.message||""),data:e}}catch(a){return{ok:!1,error:String(a?.message||a)}}},[t.category,t.subservice,t.variant])}}a.s(["default",0,f,"useDynamicPricing",()=>f])},464286,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(965733),e=a.i(340695),f=a.i(205522),g=a.i(917171),h=a.i(823292);function i({isOpen:a,onClose:i,onConfirm:j,isLoading:k}){let[l,m]=(0,c.useState)(""),n=()=>{4!==l.length?h.toast.error("Please enter a 4-digit PIN"):(j(l),m(""))};return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:a=>!a&&i(),children:(0,b.jsxs)(d.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(d.DialogHeader,{children:[(0,b.jsx)(d.DialogTitle,{children:"Enter Transaction PIN"}),(0,b.jsx)(d.DialogDescription,{children:"Please enter your 4-digit transaction PIN to authorize this request."})]}),(0,b.jsx)("div",{className:"space-y-4 py-4",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"pin",className:"text-center block",children:"PIN"}),(0,b.jsx)(f.Input,{id:"pin",type:"password",inputMode:"numeric",maxLength:4,value:l,onChange:a=>m(a.target.value.replace(/\D/g,"")),className:"text-center text-2xl tracking-[1em]",placeholder:"••••",autoFocus:!0,onKeyDown:a=>{"Enter"===a.key&&n()}})]})}),(0,b.jsxs)(d.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:i,disabled:k,children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:n,disabled:k||4!==l.length,className:"bg-[#3457D5]",children:k?"Verifying...":"Confirm PIN"})]})]})})}a.s(["PinPrompt",()=>i])},167453,a=>{"use strict";let b=(0,a.i(170106).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],167453)},591232,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(703130),e=a.i(340695),f=a.i(205522),g=a.i(917171),h=a.i(887682),i=a.i(1631),j=a.i(167453),k=a.i(277687),l=a.i(677050),m=a.i(370975),n=a.i(464286),o=a.i(50944);function p(){var a;let[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!1);(0,o.useRouter)();let{toast:B}=(0,k.useToast)(),{price:C,isLoading:D,error:E,submitService:F}=(0,m.useDynamicPricing)("airtime","vtu","",p?{network:({MTN:"mtn",GLO:"glo",AIRTEL:"airtel","9MOBILE":"9mobile"})[a=p]||a.toLowerCase()}:void 0),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),K=async a=>{(a.preventDefault(),!p||!r||!t||0>=Number(t))?B({title:"Missing details",description:"Fill network, phone and amount",variant:"destructive"}):A(!0)},L=async a=>{A(!1),w(!0),y(null),H(null);try{let b=await F({amount:Number(t),params:{phone:r,network:p},phone:r,network:p,pin:a});if(!b.ok)throw Error(b.error||"Airtime purchase failed");y({reference:String(b.reference||""),providerRef:String(b.data?.providerRef||"")||void 0}),B({title:"Airtime purchased",description:`Ref: ${String(b.reference||"")}.
      Viewing details below.`})}catch(a){console.error("API Error:",a),B({title:"Airtime Purchase Failed",description:a?.message||a?.error||"Failed to process request. Please try again.",variant:"destructive"})}finally{w(!1)}};return(0,c.useEffect)(()=>{},[p]),(0,c.useEffect)(()=>{x?.reference&&(async()=>{try{J(!0);let a=await (0,l.authFetch)(`/api/service/status/${encodeURIComponent(x.reference)}`),b=await a.json().catch(()=>null);a.ok&&b?.ok?H({status:String(b.status||"SUCCESS"),amount:Number(b.amount||0),wallet:b.wallet||null,meta:b.meta||{}}):(H(null),B({title:"Receipt unavailable",description:String(b?.error||"Unable to fetch status")}))}catch(a){H(null),B({title:"Receipt fetch failed",description:String(a)})}finally{J(!1)}})()},[x?.reference]),(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(i.Smartphone,{className:"h-6 w-6 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Airtime VTU"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Buy instant airtime on all networks"})]})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Buy Airtime"}),(0,b.jsx)(d.CardDescription,{children:"Enter phone, network and amount"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("form",{className:"space-y-4",onSubmit:K,children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Network"}),(0,b.jsxs)(h.Select,{value:p,onValueChange:q,children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{placeholder:"Select network"})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"MTN",children:"MTN"}),(0,b.jsx)(h.SelectItem,{value:"GLO",children:"GLO"}),(0,b.jsx)(h.SelectItem,{value:"AIRTEL",children:"AIRTEL"}),(0,b.jsx)(h.SelectItem,{value:"9MOBILE",children:"9MOBILE"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Phone Number"}),(0,b.jsx)(f.Input,{value:r,onChange:a=>s(a.target.value),placeholder:"08012345678"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Amount (₦)"}),(0,b.jsx)(f.Input,{type:"number",value:t,onChange:a=>u(Number(a.target.value)),placeholder:"100"})]}),p?(0,b.jsxs)("div",{className:"bg-[#CCCCFF]/20 p-3 rounded-lg text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Service Fee"}),(0,b.jsx)("span",{children:D?"Loading...":`₦${Number(C||0).toLocaleString()}`})]}),(0,b.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,b.jsx)("span",{children:"Total Payable"}),(0,b.jsxs)("span",{children:["₦",((Number(t)||0)+Number(C||0)).toLocaleString()]})]})]}):null,(0,b.jsx)(e.Button,{className:"w-full",type:"submit",disabled:v,children:v?"Processing...":"Purchase Airtime"})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)(g.Label,{children:"Quick Amounts"}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-3 mt-2",children:[100,200,500,1e3,2e3].map(a=>(0,b.jsxs)(e.Button,{variant:"outline",onClick:()=>u(a),children:["₦",a]},a))})]}),x&&(0,b.jsxs)("div",{className:"mt-6 p-3 rounded-lg bg-green-50 border border-green-200 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 font-medium text-green-700",children:[(0,b.jsx)(j.CheckCircle2,{className:"h-5 w-5"})," Purchase successful"]}),(0,b.jsxs)("div",{className:"mt-1 text-green-700",children:["Reference: ",x.reference]}),x.providerRef?(0,b.jsxs)("div",{className:"text-green-700",children:["Provider Ref: ",x.providerRef]}):null,(0,b.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,b.jsx)(e.Button,{size:"sm",variant:"outline",onClick:()=>navigator.clipboard.writeText(x.reference),children:"Copy Reference"}),(0,b.jsx)(e.Button,{size:"sm",variant:"secondary",disabled:I,onClick:()=>{H(null),J(!0),(0,l.authFetch)(`/api/service/status/${encodeURIComponent(x.reference)}`).then(a=>a.json()).then(a=>{a?.ok?H({status:String(a.status||"SUCCESS"),amount:Number(a.amount||0),wallet:a.wallet||null,meta:a.meta||{}}):B({title:"Receipt unavailable",description:String(a?.error||"Unable to fetch status")})}).catch(a=>B({title:"Receipt fetch failed",description:String(a)})).finally(()=>J(!1))},children:I?"Loading...":"View Details"})]}),G&&(0,b.jsxs)("div",{className:"mt-3 bg-white border rounded p-3 text-green-700",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Status"}),(0,b.jsx)("span",{className:"font-medium",children:G.status})]}),(0,b.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,b.jsx)("span",{children:"Amount"}),(0,b.jsxs)("span",{className:"font-medium",children:["₦",Number(G.amount||0).toLocaleString()]})]}),G.wallet?(0,b.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,b.jsx)("span",{children:"Wallet Balance"}),(0,b.jsxs)("span",{className:"font-medium",children:["₦",Number(G.wallet.balance||0).toLocaleString()]})]}):null,G.meta?.providerRef?(0,b.jsxs)("div",{className:"mt-1",children:[(0,b.jsx)("span",{children:"Provider Ref:"})," ",String(G.meta.providerRef)]}):null]})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Tips"}),(0,b.jsx)(d.CardDescription,{children:"Ensure correct phone and network"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-2",children:[(0,b.jsx)("li",{children:"Use the exact network your SIM is on."}),(0,b.jsx)("li",{children:"Double-check phone number before submitting."}),(0,b.jsx)("li",{children:"Your wallet will be debited after a successful purchase."})]})})]})]}),(0,b.jsx)(n.PinPrompt,{isOpen:z,onClose:()=>A(!1),onConfirm:L,isLoading:v})]})}a.s(["default",()=>p])}];

//# sourceMappingURL=_f61712a4._.js.map