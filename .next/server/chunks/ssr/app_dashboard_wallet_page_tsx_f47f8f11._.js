module.exports=[534988,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(346271),e=a.i(703130),f=a.i(340695),g=a.i(205522),h=a.i(917171),i=a.i(621958),j=a.i(588237),k=a.i(254161),l=a.i(965733),m=a.i(887682),n=a.i(950463),o=a.i(856738),p=a.i(705151),q=a.i(167453),r=a.i(724669),s=a.i(653277),t=a.i(915618);let u=(0,a.i(170106).default)("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);var v=a.i(823292),w=a.i(497895),x=a.i(677050);function y(){let[a,y]=(0,c.useState)(0),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)("monnify"),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(""),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)([]),[T,U]=(0,c.useState)(null),[V,W]=(0,c.useState)(null);(0,c.useEffect)(()=>{setTimeout(async()=>{try{let a=await (0,x.authFetch)("/api/wallet/balance");if(a.ok){let b=await a.json();y(Number(b?.balance??0))}else y(0)}catch{y(0)}try{let a=await (0,x.authFetch)("/api/wallet/virtual-account"),b=await a.json();a.ok&&(b?.monnify?.accountNumber&&U({accountNumber:b.monnify.accountNumber,bankName:b.monnify.bankName,accountName:P||"UFriends User",feesDisplay:b?.monnify?.feesDisplay||"Provider fees apply; BVN/NIN required."}),b?.paymentpoint?.accountNumber&&W({accountNumber:b.paymentpoint.accountNumber,bankName:b.paymentpoint.bankName,accountName:P||"UFriends User",feesDisplay:b?.paymentpoint?.feesDisplay||"Provider fees apply; see docs."}))}catch{let a=localStorage.getItem("ufriends_virtual_bank");a&&U(JSON.parse(a))}try{let a=await (0,x.authFetch)("/api/wallet/transactions?pageSize=50"),b=await a.json();if(a.ok&&Array.isArray(b?.transactions)){let a=b.transactions.map(a=>{let b=String(a?.type||""),c=b.endsWith("CREDIT")||b.endsWith("REFUND"),d=String(a?.status||"").toLowerCase(),e=a?.meta||{},f=String(e?.serviceId||""),g=c?b.endsWith("REFUND")?"Wallet Refund":"Wallet Top-up":f?`${f[0].toUpperCase()}${f.slice(1)} Purchase`:"Wallet Debit";return{id:String(a.id||a.reference),date:new Date(a.createdAt).toISOString().split("T")[0],description:g,amount:Number(a.amount||0),type:c?"credit":"debit",status:"success"===d||"failed"===d||"pending"===d?d:"pending"}});S(a)}}catch{}A(!1)},1e3)},[]);let X=a=>{let b="monnify"===a?T:V;if(!b)return void v.toast.error("Virtual account not available yet");let c=`Account Name: ${b.accountName||"UFriends User"}
Account Number: ${b.accountNumber}
Bank: ${b.bankName}`;navigator.clipboard.writeText(c),v.toast.success("Bank details copied to clipboard!")},Y=async()=>{let a=Number.parseFloat(F);if(!a||a<=0)return void v.toast.error("Please enter a valid amount");try{v.toast.info(`Initiating payment of ₦${a.toLocaleString()} via ${H}...`);let b="monnify"===H?"bank-transfer":H,c=await (0,x.authFetch)("/api/wallet/fund",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:a,provider:b})}),d=await c.json();if(!c.ok)throw Error(d?.error||"Funding failed");let e=d?.paymentUrl||d?.payment?.paymentUrl||d?.payment?.checkoutUrl;if(d?.provider==="Monnify"&&e){v.toast.success("Redirecting to Monnify checkout..."),window.location.href=e;return}let f=d?.instructions?`${d.instructions}`:`Reference: ${d?.reference}. Complete payment to receive credits.`;v.toast.success(`Funding initiated: ${f}`),"bank-transfer"===H&&d?.virtualAccount&&U({accountName:T?.accountName||"UFriends User",accountNumber:d.virtualAccount.accountNumber,bankName:d.virtualAccount.bankName,feesDisplay:T?.feesDisplay||"Provider fees apply; BVN/NIN required."}),C(!1),G("")}catch(a){v.toast.error(String(a))}},Z=a=>a?R.filter(b=>b.type===a):R;return z?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(n.Skeleton,{className:"h-10 w-48"}),(0,b.jsx)(n.Skeleton,{className:"h-48 w-full"}),(0,b.jsx)(n.Skeleton,{className:"h-32 w-full"}),(0,b.jsx)(n.Skeleton,{className:"h-96 w-full"})]}):(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"My Wallet"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage your wallet balance and transactions"})]}),(0,b.jsx)(d.motion.div,{whileHover:{scale:1.02},transition:{duration:.2},children:(0,b.jsxs)(e.Card,{className:"p-6 bg-gradient-to-r from-[#3457D5] to-[#CCCCFF] text-white border-0 shadow-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)(o.Wallet,{className:"h-6 w-6"}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Wallet Balance"})]}),(0,b.jsxs)("p",{className:"text-4xl font-bold mt-2",children:["₦",a.toLocaleString()]}),(0,b.jsxs)("div",{className:"mt-6 flex gap-3 flex-wrap",children:[(0,b.jsxs)(l.Dialog,{open:B,onOpenChange:C,children:[(0,b.jsx)(l.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{className:"bg-white text-[#3457D5] hover:bg-white/90 gap-2",children:[(0,b.jsx)(t.Plus,{className:"h-4 w-4"}),"Fund Wallet"]})}),(0,b.jsxs)(l.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(l.DialogHeader,{children:[(0,b.jsx)(l.DialogTitle,{children:"Fund Wallet"}),(0,b.jsx)(l.DialogDescription,{children:"Choose your preferred payment method and enter the amount"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"amount",children:"Amount (₦)"}),(0,b.jsx)(g.Input,{id:"amount",type:"number",placeholder:"Enter amount",value:F,onChange:a=>G(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"payment-method",children:"Payment Method"}),(0,b.jsxs)(m.Select,{value:H,onValueChange:I,children:[(0,b.jsx)(m.SelectTrigger,{id:"payment-method",children:(0,b.jsx)(m.SelectValue,{})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"monnify",children:"Monnify"}),(0,b.jsx)(m.SelectItem,{value:"paymentpoint",children:"PaymentPoint"}),(0,b.jsx)(m.SelectItem,{value:"bank-transfer",children:"Manual Bank Transfer"})]})]})]}),"bank-transfer"===H&&(0,b.jsxs)("div",{className:"space-y-3 p-4 bg-muted/50 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h4",{className:"font-medium text-sm",children:"Transfer to this account:"}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>X("monnify"),className:"h-8 px-3 text-xs",children:[(0,b.jsx)(p.Copy,{className:"h-3 w-3 mr-1"}),"Copy Details"]})]}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Account Name:"}),(0,b.jsx)("p",{className:"font-medium",children:T?.accountName||"UFriends User"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Account Number:"}),(0,b.jsx)("p",{className:"font-medium font-mono",children:T?.accountNumber||""})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Bank:"}),(0,b.jsx)("p",{className:"font-medium",children:T?.bankName||"Moniepoint Microfinance Bank"})]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Transfer the exact amount above and your wallet will be credited automatically."})]})]}),(0,b.jsx)(l.DialogFooter,{children:(0,b.jsx)(f.Button,{onClick:Y,className:"w-full bg-[#3457D5] hover:bg-[#3457D5]/90",children:"Proceed to Payment"})})]})]}),(0,b.jsxs)(l.Dialog,{open:D,onOpenChange:E,children:[(0,b.jsx)(l.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"outline",className:"text-white border-white hover:bg-white/10 gap-2 bg-transparent",children:[(0,b.jsx)(u,{className:"h-4 w-4"}),"Withdraw"]})}),(0,b.jsxs)(l.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(l.DialogHeader,{children:[(0,b.jsx)(l.DialogTitle,{children:"Withdraw to Bank"}),(0,b.jsx)(l.DialogDescription,{children:"Enter your bank details and withdrawal amount"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"withdraw-amount",children:"Amount (₦)"}),(0,b.jsx)(g.Input,{id:"withdraw-amount",type:"number",placeholder:"Enter amount",value:J,onChange:a=>K(a.target.value)}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Available: ₦",a.toLocaleString()]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"bank-name",children:"Bank Name"}),(0,b.jsx)(g.Input,{id:"bank-name",placeholder:"Enter bank name",value:L,onChange:a=>M(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"account-number",children:"Account Number"}),(0,b.jsx)(g.Input,{id:"account-number",placeholder:"Enter account number",value:N,onChange:a=>O(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"account-name",children:"Account Name"}),(0,b.jsx)(g.Input,{id:"account-name",placeholder:"Enter account name",value:P,onChange:a=>Q(a.target.value)})]})]}),(0,b.jsx)(l.DialogFooter,{children:(0,b.jsx)(f.Button,{onClick:()=>{let b=Number.parseFloat(J);!b||b<=0?v.toast.error("Please enter a valid amount"):b>a?v.toast.error("Insufficient balance"):L&&N&&P?(v.toast.success(`Processing withdrawal of ₦${b.toLocaleString()}...`),setTimeout(()=>{let c=a-b;y(c),localStorage.setItem("ufriends_wallet_balance",c.toString()),window.dispatchEvent(new CustomEvent("walletBalanceUpdate",{detail:{balance:c}})),S([{id:Date.now().toString(),date:new Date().toISOString().split("T")[0],description:`Withdrawal to ${L}`,amount:b,type:"debit",status:"success"},...R]),v.toast.success("Withdrawal successful!"),E(!1),K(""),M(""),O(""),Q("")},2e3)):v.toast.error("Please fill in all bank details")},className:"w-full bg-[#3457D5] hover:bg-[#3457D5]/90",children:"Confirm Withdrawal"})})]})]})]})]})}),(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{className:"text-[#3457D5]",children:"Virtual Account"}),(0,b.jsx)(e.CardDescription,{children:"Fund via reserved account"})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-3",children:[T?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Account Number"}),(0,b.jsx)("p",{className:"font-semibold text-lg",children:T.accountNumber})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bank"}),(0,b.jsx)("p",{className:"font-semibold",children:T.bankName})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Fees"}),(0,b.jsx)("p",{className:"font-semibold text-sm",children:T.feesDisplay||"Provider fees apply"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"BVN/NIN required to generate this account."})]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Not available yet"}),(0,b.jsxs)(f.Button,{variant:"link",className:"text-sm text-[#3457D5] p-0 h-auto gap-2",onClick:()=>X("monnify"),children:[(0,b.jsx)(p.Copy,{className:"h-4 w-4"}),"Copy Details"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{className:"text-[#3457D5]",children:"Virtual Account"}),(0,b.jsx)(e.CardDescription,{children:"Alternative funding via reserved account"})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-3",children:[V?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Account Number"}),(0,b.jsx)("p",{className:"font-semibold text-lg",children:V.accountNumber})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bank"}),(0,b.jsx)("p",{className:"font-semibold",children:V.bankName})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Fees"}),(0,b.jsx)("p",{className:"font-semibold text-sm",children:V.feesDisplay||"Provider fees apply"})]}),(0,b.jsx)("a",{href:"https://paymentpoint.gitbook.io/paymentpoint.co",target:"_blank",rel:"noreferrer",className:"text-xs text-blue-600",children:"View PaymentPoint fees"})]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Not available yet"}),(0,b.jsxs)(f.Button,{variant:"link",className:"text-sm text-[#3457D5] p-0 h-auto gap-2",onClick:()=>X("paymentpoint"),children:[(0,b.jsx)(p.Copy,{className:"h-4 w-4"}),"Copy Details"]})]})]})]})}),(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:(0,b.jsxs)(i.Tabs,{defaultValue:"all",className:"space-y-4",children:[(0,b.jsxs)(i.TabsList,{className:"grid grid-cols-3 bg-[#F9F7F3] dark:bg-slate-800",children:[(0,b.jsx)(i.TabsTrigger,{value:"all",children:"All"}),(0,b.jsxs)(i.TabsTrigger,{value:"credit",className:"gap-2",children:[(0,b.jsx)(r.TrendingUp,{className:"h-4 w-4"}),"Credits"]}),(0,b.jsxs)(i.TabsTrigger,{value:"debit",className:"gap-2",children:[(0,b.jsx)(s.TrendingDown,{className:"h-4 w-4"}),"Debits"]})]}),(0,b.jsx)(i.TabsContent,{value:"all",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Transaction History"}),(0,b.jsx)(e.CardDescription,{children:"View all your wallet transactions"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Date"}),(0,b.jsx)(j.TableHead,{children:"Description"}),(0,b.jsx)(j.TableHead,{children:"Type"}),(0,b.jsx)(j.TableHead,{className:"text-right",children:"Amount"}),(0,b.jsx)(j.TableHead,{children:"Status"})]})}),(0,b.jsx)(j.TableBody,{children:Z().map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{className:"font-medium",children:a.date}),(0,b.jsx)(j.TableCell,{children:a.description}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)(k.Badge,{variant:"credit"===a.type?"default":"secondary",className:(0,w.cn)("credit"===a.type?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100"),children:["credit"===a.type?(0,b.jsx)(r.TrendingUp,{className:"h-3 w-3 mr-1"}):(0,b.jsx)(s.TrendingDown,{className:"h-3 w-3 mr-1"}),a.type]})}),(0,b.jsxs)(j.TableCell,{className:"text-right font-semibold",children:["credit"===a.type?"+":"-","₦",a.amount.toLocaleString()]}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)(k.Badge,{variant:"success"===a.status?"default":"pending"===a.status?"secondary":"destructive",children:["success"===a.status&&(0,b.jsx)(q.CheckCircle2,{className:"h-3 w-3 mr-1"}),a.status]})})]},a.id))})]})})})]})}),(0,b.jsx)(i.TabsContent,{value:"credit",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Credit Transactions"}),(0,b.jsx)(e.CardDescription,{children:"View all money received in your wallet"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Date"}),(0,b.jsx)(j.TableHead,{children:"Description"}),(0,b.jsx)(j.TableHead,{className:"text-right",children:"Amount"}),(0,b.jsx)(j.TableHead,{children:"Status"})]})}),(0,b.jsx)(j.TableBody,{children:Z("credit").map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{className:"font-medium",children:a.date}),(0,b.jsx)(j.TableCell,{children:a.description}),(0,b.jsxs)(j.TableCell,{className:"text-right font-semibold text-green-600",children:["+₦",a.amount.toLocaleString()]}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)(k.Badge,{variant:"default",children:[(0,b.jsx)(q.CheckCircle2,{className:"h-3 w-3 mr-1"}),a.status]})})]},a.id))})]})})})]})}),(0,b.jsx)(i.TabsContent,{value:"debit",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Debit Transactions"}),(0,b.jsx)(e.CardDescription,{children:"View all money spent from your wallet"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Date"}),(0,b.jsx)(j.TableHead,{children:"Description"}),(0,b.jsx)(j.TableHead,{className:"text-right",children:"Amount"}),(0,b.jsx)(j.TableHead,{children:"Status"})]})}),(0,b.jsx)(j.TableBody,{children:Z("debit").map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{className:"font-medium",children:a.date}),(0,b.jsx)(j.TableCell,{children:a.description}),(0,b.jsxs)(j.TableCell,{className:"text-right font-semibold text-red-600",children:["-₦",a.amount.toLocaleString()]}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)(k.Badge,{variant:"default",children:[(0,b.jsx)(q.CheckCircle2,{className:"h-3 w-3 mr-1"}),a.status]})})]},a.id))})]})})})]})})]})})]})}a.s(["default",()=>y],534988)}];

//# sourceMappingURL=app_dashboard_wallet_page_tsx_f47f8f11._.js.map