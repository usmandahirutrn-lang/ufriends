module.exports=[786356,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(703130),e=a.i(586547),f=a.i(254161),g=a.i(340695),h=a.i(588237),i=a.i(965733),j=a.i(917171),k=a.i(205522),l=a.i(546893),m=a.i(887682),n=a.i(277687);function o({service:a,open:d,onOpenChange:e,providerName:h,providerBaseUrl:o}){let[p,q]=(0,c.useState)(a.status),[r,s]=(0,c.useState)(""),{toast:t}=(0,n.useToast)();return(0,b.jsx)(i.Dialog,{open:d,onOpenChange:e,children:(0,b.jsxs)(i.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(i.DialogHeader,{children:(0,b.jsx)(i.DialogTitle,{children:a.name})}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Service Type"}),(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)(f.Badge,{variant:"automated"===a.type?"default":"secondary",children:"automated"===a.type?"Automated":"Manual"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Current Status"}),(0,b.jsxs)("div",{className:"mt-2",children:["up"===p&&(0,b.jsx)(f.Badge,{variant:"default",className:"bg-green-600",children:"Up"}),"down"===p&&(0,b.jsx)(f.Badge,{variant:"destructive",children:"Down"}),"manual"===p&&(0,b.jsx)(f.Badge,{variant:"secondary",children:"Manual"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Total Requests"}),(0,b.jsx)("p",{className:"mt-2 text-2xl font-bold",children:a.requests})]}),a.successRate&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Success Rate"}),(0,b.jsxs)("p",{className:"mt-2 text-2xl font-bold text-green-600",children:[a.successRate,"%"]})]}),a.avgResponse&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Average Response Time"}),(0,b.jsx)("p",{className:"mt-2 text-2xl font-bold",children:a.avgResponse})]})]}),"automated"===a.type&&(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Active Provider"}),(0,b.jsx)(k.Input,{value:h||"—",readOnly:!0,className:"mt-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"API Base URL"}),(0,b.jsx)(k.Input,{value:o||"—",readOnly:!0,className:"mt-2"})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Cost Price"}),(0,b.jsx)(k.Input,{value:"₦1,500",readOnly:!0,className:"mt-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"User Price"}),(0,b.jsx)(k.Input,{value:"₦2,000",readOnly:!0,className:"mt-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Profit"}),(0,b.jsx)(k.Input,{value:"₦500",readOnly:!0,className:"mt-2 text-green-600"})]})]}),"manual"===a.type&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Assign Agent"}),(0,b.jsxs)(m.Select,{value:r,onValueChange:s,children:[(0,b.jsx)(m.SelectTrigger,{className:"mt-2",children:(0,b.jsx)(m.SelectValue,{placeholder:"Select an agent"})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"agent1",children:"Ahmed Musa"}),(0,b.jsx)(m.SelectItem,{value:"agent2",children:"Fatima Bello"}),(0,b.jsx)(m.SelectItem,{value:"agent3",children:"Chidi Okafor"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Admin Notes"}),(0,b.jsx)(l.Textarea,{placeholder:"Add notes about this service...",className:"mt-2"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(g.Button,{onClick:()=>{t({title:"Service Updated",description:`${a.name} has been updated successfully.`}),e(!1)},children:"Save Changes"}),"automated"===a.type&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>{t({title:"Retry Initiated",description:`Retrying ${a.name}...`})},children:"Retry"}),(0,b.jsx)(g.Button,{variant:"destructive",onClick:()=>{t({title:"Service Paused",description:`${a.name} has been paused.`,variant:"destructive"})},children:"Pause Service"})]}),(0,b.jsx)(g.Button,{variant:"secondary",onClick:()=>e(!1),children:"Close"})]})]})]})})}var p=a.i(677050);let q=[{id:"vtu",name:"Airtime & Data (VTU)",services:[{id:"vtu-1",name:"Airtime Purchase (Maskawa)",type:"automated",status:"up",requests:245,successRate:98,avgResponse:"85ms"},{id:"vtu-2",name:"Data Bundle (SubandGain)",type:"automated",status:"up",requests:198,successRate:96,avgResponse:"120ms"},{id:"vtu-3",name:"Ported SIM Activation",type:"automated",status:"up",requests:87,successRate:94,avgResponse:"150ms"}]},{id:"bills",name:"Bills & Education",services:[{id:"bills-1",name:"Electricity Payment (Maskawa)",type:"automated",status:"up",requests:156,successRate:97,avgResponse:"200ms"},{id:"bills-2",name:"Cable TV Subscription",type:"automated",status:"up",requests:134,successRate:95,avgResponse:"180ms"},{id:"bills-3",name:"WAEC Result Checker",type:"automated",status:"up",requests:89,successRate:99,avgResponse:"100ms"}]},{id:"bvn",name:"BVN Services",services:[{id:"bvn-1",name:"BVN Print-Out",type:"automated",status:"up",requests:342,successRate:97,avgResponse:"120ms"},{id:"bvn-2",name:"BVN Verification",type:"automated",status:"up",requests:278,successRate:98,avgResponse:"95ms"},{id:"bvn-3",name:"BVN Modification",type:"manual",status:"manual",requests:45}]},{id:"nin",name:"NIN Services",services:[{id:"nin-1",name:"NIN Slip",type:"automated",status:"up",requests:298,successRate:96,avgResponse:"110ms"},{id:"nin-2",name:"NIN Verification",type:"automated",status:"up",requests:234,successRate:97,avgResponse:"105ms"},{id:"nin-3",name:"NIN Modification",type:"manual",status:"manual",requests:84}]},{id:"cac",name:"CAC Services",services:[{id:"cac-1",name:"Business Name Registration",type:"manual",status:"manual",requests:67},{id:"cac-2",name:"Company Registration",type:"manual",status:"manual",requests:45},{id:"cac-3",name:"CAC Certificate Retrieval",type:"manual",status:"manual",requests:38},{id:"cac-4",name:"CAC Status Report",type:"manual",status:"manual",requests:27}]},{id:"verification",name:"Verification Services",services:[{id:"verify-1",name:"Voters Card Verification",type:"automated",status:"up",requests:156,successRate:94,avgResponse:"140ms"},{id:"verify-2",name:"Driver's License Verification",type:"automated",status:"up",requests:123,successRate:96,avgResponse:"130ms"},{id:"verify-3",name:"International Passport Verification",type:"automated",status:"up",requests:89,successRate:95,avgResponse:"150ms"}]}];function r(){let a,i,j,l,m,[n,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)({}),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)({}),[C,D]=(0,c.useState)({}),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)({}),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(null),M={vtu:"airtime",bills:"bills",bvn:"bvn",nin:"nin",cac:"cac",verification:"verification"},N=async()=>{x(!0);try{let a=await (0,p.authFetch)("/api/admin/providers");if(!a.ok)throw Error("Failed to fetch providers");let b=await a.json();v(b.providersByCategory||{})}catch(a){console.error(a),F("Failed to load providers")}finally{x(!1)}},O=async()=>{try{let a=await (0,p.authFetch)("/api/admin/services",{method:"GET"}),b=await a.json().catch(()=>({})),c=Array.isArray(b?.services)?b.services:[];z(c)}catch(a){console.error("Failed to load services",a)}},P=async()=>{try{let a=await (0,p.authFetch)("/api/admin/services/metrics",{method:"GET"}),b=await a.json().catch(()=>({})),c=b?.byService||{};B(c)}catch(a){console.error("Failed to load metrics",a)}},Q=async()=>{try{let a=await (0,p.authFetch)("/api/admin/services/manual",{method:"GET"}),b=await a.json().catch(()=>({})),c=b?.toggles||{};D(c)}catch(a){console.error("Failed to load manual toggles",a)}};(0,c.useEffect)(()=>{N(),O(),P(),Q();let a=setInterval(()=>{P()},1e4);return()=>clearInterval(a)},[]);let R=async(a,b,c)=>{try{let d=await (0,p.authFetch)("/api/admin/services/manual",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serviceId:a,subServiceId:b,manualOnly:c})}),e=await d.json().catch(()=>({}));if(d.ok){let d=`manual_only:${a}:${b}`;D(a=>({...a,[d]:c})),F(`Manual-only ${c?"enabled":"disabled"} for ${a}/${b}`)}else F(e?.error||"Failed to set manual-only toggle")}catch(a){F("Error updating manual-only toggle")}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Service Management"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage all UFriends services and monitor their performance."})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"All Services"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(e.Accordion,{type:"multiple",className:"w-full",children:(y.length?y.map(a=>({id:a.id,name:a.name,services:(a.subServices||[]).map((b,c)=>{let d=!!C[`manual_only:${a.id}:${b?.id}`],e=A[a.id],f=(e?.bySubService||{})[b?.id??"unknown"],g=f?.total||0,h=f?.success||0,i=g>0?Math.round(h/g*100):void 0;return{id:`${a.id}-${b?.id??c}`,name:b?.name??"Service",type:d?"manual":"automated",status:d?"manual":a.isAvailable?"up":"down",requests:g,successRate:i,avgResponse:void 0,_raw:{serviceId:a.id,subServiceId:b?.id}}})})):q).map(a=>(0,b.jsxs)(e.AccordionItem,{value:a.id,children:[(0,b.jsx)(e.AccordionTrigger,{className:"text-lg font-semibold",children:a.name}),(0,b.jsx)(e.AccordionContent,{children:(0,b.jsxs)(h.Table,{children:[(0,b.jsx)(h.TableHeader,{children:(0,b.jsxs)(h.TableRow,{children:[(0,b.jsx)(h.TableHead,{children:"Sub-Service"}),(0,b.jsx)(h.TableHead,{children:"Type"}),(0,b.jsx)(h.TableHead,{children:"Provider"}),(0,b.jsx)(h.TableHead,{children:"Status"}),(0,b.jsx)(h.TableHead,{children:"Requests"}),(0,b.jsx)(h.TableHead,{children:"Success Rate"}),(0,b.jsx)(h.TableHead,{children:"Avg Response"}),(0,b.jsx)(h.TableHead,{children:"Manual Only"}),(0,b.jsx)(h.TableHead,{children:"Actions"})]})}),(0,b.jsx)(h.TableBody,{children:a.services.map(c=>(0,b.jsxs)(h.TableRow,{children:[(0,b.jsx)(h.TableCell,{className:"font-medium",children:c.name}),(0,b.jsx)(h.TableCell,{children:(0,b.jsx)(f.Badge,{variant:"automated"===c.type?"default":"secondary",children:"automated"===c.type?"Automated":"Manual"})}),(0,b.jsx)(h.TableCell,{children:(()=>{if(y.length){let c=y.find(b=>b.id===a.id),d=c?.providerInfo?.provider?.name,e=c?.providerInfo?.fallbackProviders||[];return d?(0,b.jsxs)("span",{className:"text-sm flex items-center gap-2",children:[(0,b.jsx)(f.Badge,{variant:"default",className:"bg-green-600",children:d}),e.length>0&&(0,b.jsx)("span",{className:"text-muted-foreground",children:"→ Fallbacks by priority"})]}):(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"No active provider"})}let c=u[M[a.id]]||u[a.id]||[],d=c.find(a=>a.isActive);return d?(0,b.jsxs)("span",{className:"text-sm flex items-center gap-2",children:[(0,b.jsx)(f.Badge,{variant:"default",className:"bg-green-600",children:d.name}),c.filter(a=>!a.isActive&&a.priority>0).length>0&&(0,b.jsx)("span",{className:"text-muted-foreground",children:"→ Fallbacks by priority"})]}):(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"No active provider"})})()}),(0,b.jsxs)(h.TableCell,{children:["up"===c.status&&(0,b.jsx)(f.Badge,{variant:"default",className:"bg-green-600",children:"Up"}),"down"===c.status&&(0,b.jsx)(f.Badge,{variant:"destructive",children:"Down"}),"manual"===c.status&&(0,b.jsx)(f.Badge,{variant:"secondary",children:"Manual"})]}),(0,b.jsx)(h.TableCell,{children:c.requests}),(0,b.jsx)(h.TableCell,{children:c.successRate?`${c.successRate}%`:"—"}),(0,b.jsx)(h.TableCell,{children:c.avgResponse||"—"}),(0,b.jsx)(h.TableCell,{children:(()=>{let a=c._raw;if(!a)return(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"—"});let d=!!C[`manual_only:${a.serviceId}:${a.subServiceId}`];return(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(k.Input,{type:"checkbox",checked:d,onChange:b=>R(a.serviceId,a.subServiceId,b.target.checked)}),(0,b.jsx)("span",{children:d?"On":"Off"})]})})()}),(0,b.jsx)(h.TableCell,{children:(0,b.jsx)(g.Button,{variant:"outline",size:"sm",onClick:()=>{r({...c,_raw:{...c._raw,serviceId:a.id}}),t(!0)},children:"View"})})]},c.id))})]})})]},a.id))})})]}),n&&(i=(a=n._raw?.serviceId)?y.find(b=>b.id===a):null,j=i?.providerInfo?.provider,l=j?.name,m=j?.apiBaseUrl??null,(0,b.jsx)(o,{service:n,open:s,onOpenChange:t,providerName:l,providerBaseUrl:m}))]})}a.s(["default",()=>r],786356)}];

//# sourceMappingURL=app_admin_services_page_tsx_cfaa2605._.js.map