{"version":3,"sources":["turbopack:///[project]/lib/db.ts","turbopack:///[project]/lib/security.ts","turbopack:///[project]/node_modules/openid-client/package.json","turbopack:///[project]/node_modules/joi/package.json","turbopack:///[project]/lib/jwt-auth.ts","turbopack:///[project]/lib/require-auth.ts","turbopack:///[project]/lib/provider-manager.ts","turbopack:///[project]/lib/kyc-check.ts","turbopack:///[project]/lib/http-client.ts","turbopack:///[project]/lib/providers/airtime-ported.ts","turbopack:///[project]/lib/providers/data-ported.ts","turbopack:///[project]/lib/providers/bills-subandgain.ts","turbopack:///[project]/lib/providers/airtime-subandgain.ts","turbopack:///[project]/lib/providers/data-subandgain.ts","turbopack:///[project]/lib/providers/education-subandgain.ts","turbopack:///[project]/lib/service-utils.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient | undefined }\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: [\"error\", \"warn\"],\r\n  })\r\n\r\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma","import arcjet, { shield, validateEmail, detectBot, fixedWindow } from \"@arcjet/next\"\r\n\r\ntype AJInstance = ReturnType<typeof arcjet> | null\r\n\r\n// Create a shared Arcjet instance with common rules.\r\n// In development, ARCJET_KEY may be missing, so we fail open.\r\nexport const aj: AJInstance = process.env.ARCJET_KEY\r\n  ? arcjet({\r\n    key: process.env.ARCJET_KEY!,\r\n    rules: [\r\n      shield({ mode: \"LIVE\" }),\r\n      detectBot({ mode: \"LIVE\", allow: [\"CATEGORY:SEARCH_ENGINE\", \"CATEGORY:MONITOR\", \"CATEGORY:PREVIEW\"] }),\r\n      fixedWindow({ mode: \"LIVE\", window: \"60s\", max: 100 }),\r\n    ],\r\n  })\r\n  : null\r\n\r\n// Email-validation instance for routes that need email context\r\nexport const ajWithEmail: AJInstance = process.env.ARCJET_KEY\r\n  ? arcjet({\r\n    key: process.env.ARCJET_KEY!,\r\n    rules: [\r\n      shield({ mode: \"LIVE\" }),\r\n      detectBot({ mode: \"LIVE\", allow: [\"CATEGORY:SEARCH_ENGINE\", \"CATEGORY:MONITOR\", \"CATEGORY:PREVIEW\"] }),\r\n      fixedWindow({ mode: \"LIVE\", window: \"60s\", max: 100 }),\r\n      validateEmail({ mode: \"LIVE\", deny: [\"DISPOSABLE\", \"INVALID\", \"NO_MX_RECORDS\"] }),\r\n    ],\r\n  })\r\n  : null\r\n\r\nexport async function protect(req: Request, opts?: { email?: string }) {\r\n  if (!aj) return { allowed: true }\r\n  try {\r\n    const decision = await (opts?.email && ajWithEmail\r\n      ? (ajWithEmail as any).protect(req as any, { email: opts.email })\r\n      : (aj as any).protect(req as any))\r\n    if (decision?.isDenied?.()) return { allowed: false }\r\n    return { allowed: true }\r\n  } catch {\r\n    // Fail open in dev\r\n    return { allowed: true }\r\n  }\r\n}","{\"name\":\"openid-client\",\"version\":\"5.7.1\",\"description\":\"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs\",\"keywords\":[\"auth\",\"authentication\",\"basic\",\"certified\",\"client\",\"connect\",\"dynamic\",\"electron\",\"hybrid\",\"identity\",\"implicit\",\"oauth\",\"oauth2\",\"oidc\",\"openid\",\"passport\",\"relying party\",\"strategy\"],\"homepage\":\"https://github.com/panva/openid-client\",\"repository\":\"panva/openid-client\",\"funding\":{\"url\":\"https://github.com/sponsors/panva\"},\"license\":\"MIT\",\"author\":\"Filip Skokan <panva.ip@gmail.com>\",\"exports\":{\"types\":\"./types/index.d.ts\",\"import\":\"./lib/index.mjs\",\"require\":\"./lib/index.js\"},\"main\":\"./lib/index.js\",\"types\":\"./types/index.d.ts\",\"files\":[\"lib\",\"types/index.d.ts\"],\"scripts\":{\"format\":\"npx prettier --loglevel silent --write ./lib ./test ./certification ./types\",\"test\":\"mocha test/**/*.test.js\"},\"dependencies\":{\"jose\":\"^4.15.9\",\"lru-cache\":\"^6.0.0\",\"object-hash\":\"^2.2.0\",\"oidc-token-hash\":\"^5.0.3\"},\"devDependencies\":{\"@types/node\":\"^16.18.106\",\"@types/passport\":\"^1.0.16\",\"base64url\":\"^3.0.1\",\"chai\":\"^4.5.0\",\"mocha\":\"^10.7.3\",\"nock\":\"^13.5.5\",\"prettier\":\"^2.8.8\",\"readable-mock-req\":\"^0.2.2\",\"sinon\":\"^9.2.4\",\"timekeeper\":\"^2.3.1\"},\"standard-version\":{\"scripts\":{\"postchangelog\":\"sed -i '' -e 's/### \\\\[/## [/g' CHANGELOG.md\"},\"types\":[{\"type\":\"feat\",\"section\":\"Features\"},{\"type\":\"fix\",\"section\":\"Fixes\"},{\"type\":\"chore\",\"hidden\":true},{\"type\":\"docs\",\"hidden\":true},{\"type\":\"style\",\"hidden\":true},{\"type\":\"refactor\",\"section\":\"Refactor\",\"hidden\":false},{\"type\":\"perf\",\"section\":\"Performance\",\"hidden\":false},{\"type\":\"test\",\"hidden\":true}]}}","{\"name\":\"joi\",\"description\":\"Object schema validation\",\"version\":\"18.0.1\",\"repository\":{\"url\":\"git://github.com/hapijs/joi\",\"type\":\"git\"},\"engines\":{\"node\":\">= 20\"},\"main\":\"lib/index.js\",\"types\":\"lib/index.d.ts\",\"browser\":\"dist/joi-browser.min.js\",\"files\":[\"lib/**/*\",\"dist/*\"],\"keywords\":[\"schema\",\"validation\"],\"dependencies\":{\"@hapi/address\":\"^5.1.1\",\"@hapi/formula\":\"^3.0.2\",\"@hapi/hoek\":\"^11.0.7\",\"@hapi/pinpoint\":\"^2.0.1\",\"@hapi/tlds\":\"^1.1.1\",\"@hapi/topo\":\"^6.0.2\",\"@standard-schema/spec\":\"^1.0.0\"},\"devDependencies\":{\"@hapi/bourne\":\"^3.0.0\",\"@hapi/code\":\"^9.0.3\",\"@hapi/eslint-plugin\":\"^7.0.0\",\"@hapi/joi-legacy-test\":\"npm:@hapi/joi@15.x.x\",\"@hapi/lab\":\"^26.0.0\",\"@types/node\":\"^20.17.47\",\"typescript\":\"^5.8.3\"},\"scripts\":{\"prepublishOnly\":\"cd browser && npm install && npm run build\",\"test\":\"lab -t 100 -a @hapi/code -L -Y\",\"test-cov-html\":\"lab -r html -o coverage.html -a @hapi/code\"},\"license\":\"BSD-3-Clause\"}","import { verifyAccessToken } from \"./jwt\"\r\nimport { getServerSession } from \"next-auth\"\r\nimport { authOptions } from \"@/lib/auth\"\r\n\r\nexport type AuthUser = { id: string; email?: string | null; role?: string | null }\r\n\r\nexport async function getAuthUser(req: Request): Promise<AuthUser | null> {\r\n  // Prefer Authorization: Bearer access token\r\n  const authHeader = (req as any).headers?.get?.(\"authorization\") || \"\"\r\n  const [, token] = authHeader.split(\" \")\r\n  if (authHeader.toLowerCase().startsWith(\"bearer \") && token) {\r\n    try {\r\n      const payload: any = await verifyAccessToken(token)\r\n      return { id: payload.sub, email: payload.email, role: payload.role }\r\n    } catch {}\r\n  }\r\n\r\n  // Fallback to NextAuth session\r\n  try {\r\n    const session = await getServerSession(authOptions)\r\n    if (session?.user?.id) {\r\n      return { id: (session.user as any).id, email: session.user.email, role: (session.user as any).role }\r\n    }\r\n  } catch {}\r\n\r\n  return null\r\n}","import { NextResponse } from \"next/server\"\r\nimport { prisma } from \"@/lib/db\"\r\nimport { getAuthUser, AuthUser } from \"@/lib/jwt-auth\"\r\n\r\nexport type RequireAuthOptions = {\r\n  roles?: Array<string>\r\n}\r\n\r\nexport type RequireAuthResult = {\r\n  ok: true\r\n  user: AuthUser\r\n} | {\r\n  ok: false\r\n  response: NextResponse\r\n}\r\n\r\nexport async function requireAuth(req: Request, options: RequireAuthOptions = {}): Promise<RequireAuthResult> {\r\n  const tokenUser = await getAuthUser(req)\r\n  if (!tokenUser?.id) {\r\n    return { ok: false, response: NextResponse.json({ error: \"Unauthorized\" }, { status: 401 }) }\r\n  }\r\n\r\n  // Check DB for status and latest role\r\n  const user = await prisma.user.findUnique({\r\n    where: { id: tokenUser.id },\r\n    select: { id: true, email: true, role: true, status: true }\r\n  })\r\n\r\n  if (!user) {\r\n    return { ok: false, response: NextResponse.json({ error: \"Unauthorized\" }, { status: 401 }) }\r\n  }\r\n\r\n  if (user.status === \"suspended\") {\r\n    return { ok: false, response: NextResponse.json({ error: \"Account suspended\" }, { status: 403 }) }\r\n  }\r\n\r\n  // Enforce role check if required\r\n  if (options.roles && user.role && !options.roles.includes(user.role)) {\r\n    return { ok: false, response: NextResponse.json({ error: \"Forbidden\" }, { status: 403 }) }\r\n  }\r\n\r\n  // Return the DB user to ensure downstream consumers have up-to-date data\r\n  return { ok: true, user: { id: user.id, email: user.email, role: user.role } }\r\n}","import { prisma } from \"@/lib/db\"\r\n\r\nexport interface ProviderConfig {\r\n  id: string\r\n  name: string\r\n  category: string\r\n  isActive: boolean\r\n  priority: number\r\n  apiBaseUrl: string | null\r\n  configJson: Record<string, unknown>\r\n  apiKeys: Array<{\r\n    id: string\r\n    keyName: string\r\n    keyValue: string\r\n  }>\r\n}\r\n\r\nexport interface ServiceProviderInfo {\r\n  provider: ProviderConfig | null\r\n  fallbackProviders: ProviderConfig[]\r\n  hasActiveProvider: boolean\r\n}\r\n\r\n/**\r\n * Get the active provider for a specific service category\r\n */\r\nexport async function getActiveProvider(category: string): Promise<ServiceProviderInfo> {\r\n  try {\r\n    const providers = await prisma.serviceProvider.findMany({\r\n      where: { category },\r\n      include: {\r\n        apiKeys: {\r\n          select: {\r\n            id: true,\r\n            keyName: true,\r\n            keyValue: true\r\n          }\r\n        }\r\n      },\r\n      orderBy: [\r\n        { isActive: \"desc\" },\r\n        { priority: \"desc\" },\r\n        { name: \"asc\" }\r\n      ]\r\n    })\r\n\r\n    const toConfig = (p: typeof providers[number]): ProviderConfig => ({\r\n      id: p.id,\r\n      name: p.name,\r\n      category: p.category,\r\n      isActive: p.isActive,\r\n      priority: p.priority,\r\n      apiBaseUrl: p.apiBaseUrl,\r\n      configJson: p.configJson as Record<string, unknown>,\r\n      apiKeys: p.apiKeys\r\n    })\r\n\r\n    const activeProviderRaw = providers.find(p => p.isActive) || null\r\n    const fallbackProvidersRaw = providers.filter(p => !p.isActive && p.priority > 0)\r\n\r\n    return {\r\n      provider: activeProviderRaw ? toConfig(activeProviderRaw) : null,\r\n      fallbackProviders: fallbackProvidersRaw.map(toConfig),\r\n      hasActiveProvider: !!activeProviderRaw\r\n    }\r\n  } catch (error) {\r\n    console.error(`Failed to get active provider for category ${category}:`, error)\r\n    return {\r\n      provider: null,\r\n      fallbackProviders: [],\r\n      hasActiveProvider: false\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Get API key value by name for a specific provider\r\n */\r\nexport async function getProviderApiKey(providerId: string, keyName: string): Promise<string | null> {\r\n  try {\r\n    const apiKey = await prisma.providerApiKey.findFirst({\r\n      where: {\r\n        providerId,\r\n        keyName\r\n      },\r\n      select: {\r\n        keyValue: true\r\n      }\r\n    })\r\n\r\n    return apiKey?.keyValue || null\r\n  } catch (error) {\r\n    console.error(`Failed to get API key ${keyName} for provider ${providerId}:`, error)\r\n    return null\r\n  }\r\n}\r\n\r\n/**\r\n * Get all API keys for a provider as a key-value object\r\n */\r\nexport async function getProviderApiKeys(providerId: string): Promise<Record<string, string>> {\r\n  try {\r\n    const apiKeys = await prisma.providerApiKey.findMany({\r\n      where: { providerId },\r\n      select: {\r\n        keyName: true,\r\n        keyValue: true\r\n      }\r\n    })\r\n\r\n    return apiKeys.reduce<Record<string, string>>((acc, key) => {\r\n      acc[key.keyName] = key.keyValue\r\n      return acc\r\n    }, {})\r\n  } catch (error) {\r\n    console.error(`Failed to get API keys for provider ${providerId}:`, error)\r\n    return {}\r\n  }\r\n}\r\n\r\n/**\r\n * Check if a provider is available and active\r\n */\r\nexport async function isProviderAvailable(category: string): Promise<boolean> {\r\n  try {\r\n    const activeProvider = await prisma.serviceProvider.findFirst({\r\n      where: {\r\n        category,\r\n        isActive: true\r\n      }\r\n    })\r\n\r\n    return !!activeProvider\r\n  } catch (error) {\r\n    console.error(`Failed to check provider availability for category ${category}:`, error)\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * Get provider configuration with decrypted API keys\r\n */\r\nexport async function getProviderConfig(providerId: string): Promise<ProviderConfig | null> {\r\n  try {\r\n    const provider = await prisma.serviceProvider.findUnique({\r\n      where: { id: providerId },\r\n      include: {\r\n        apiKeys: {\r\n          select: {\r\n            id: true,\r\n            keyName: true,\r\n            keyValue: true\r\n          }\r\n        }\r\n      }\r\n    })\r\n\r\n    if (!provider) return null\r\n\r\n    return {\r\n      id: provider.id,\r\n      name: provider.name,\r\n      category: provider.category,\r\n      isActive: provider.isActive,\r\n      priority: provider.priority,\r\n      apiBaseUrl: provider.apiBaseUrl,\r\n      configJson: provider.configJson as Record<string, unknown>,\r\n      apiKeys: provider.apiKeys\r\n    }\r\n  } catch (error) {\r\n    console.error(`Failed to get provider config for ${providerId}:`, error)\r\n    return null\r\n  }\r\n}\r\n\r\n/**\r\n * Update provider status (activate/deactivate)\r\n */\r\nexport async function updateProviderStatus(providerId: string, isActive: boolean): Promise<boolean> {\r\n  try {\r\n    await prisma.serviceProvider.update({\r\n      where: { id: providerId },\r\n      data: { \r\n        isActive,\r\n        updatedAt: new Date()\r\n      }\r\n    })\r\n    return true\r\n  } catch (error) {\r\n    console.error(`Failed to update provider status for ${providerId}:`, error)\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * Get all providers for a category with their status\r\n */\r\nexport async function getCategoryProviders(category: string): Promise<ProviderConfig[]> {\r\n  try {\r\n    const providers = await prisma.serviceProvider.findMany({\r\n      where: { category },\r\n      include: {\r\n        apiKeys: {\r\n          select: {\r\n            id: true,\r\n            keyName: true,\r\n            keyValue: true\r\n          }\r\n        }\r\n      },\r\n      orderBy: [\r\n        { isActive: \"desc\" },\r\n        { priority: \"desc\" },\r\n        { name: \"asc\" }\r\n      ]\r\n    })\r\n\r\n    return providers.map((p) => ({\r\n      id: p.id,\r\n      name: p.name,\r\n      category: p.category,\r\n      isActive: p.isActive,\r\n      priority: p.priority,\r\n      apiBaseUrl: p.apiBaseUrl,\r\n      configJson: p.configJson as Record<string, unknown>,\r\n      apiKeys: p.apiKeys\r\n    }))\r\n  } catch (error) {\r\n    console.error(`Failed to get providers for category ${category}:`, error)\r\n    return []\r\n  }\r\n}","import { prisma } from \"@/lib/db\"\r\nimport { NextResponse } from \"next/server\"\r\n\r\n/**\r\n * Checks if a user has an approved KYC.\r\n * Returns null if verified, or a NextResponse error if blocked.\r\n */\r\nexport async function ensureKyc(userId: string) {\r\n    const user = await prisma.user.findUnique({\r\n        where: { id: userId },\r\n        select: { isKycVerified: true } as any,\r\n    }) as any\r\n\r\n    // If already flagged in user model, we are good\r\n    if (user?.isKycVerified) {\r\n        return null\r\n    }\r\n\r\n    // Fallback: Check if there's an APPROVED kycRequest (in case flag is out of sync)\r\n    const approvedKyc = await prisma.kycRequest.findFirst({\r\n        where: { userId, status: \"APPROVED\" },\r\n    })\r\n\r\n    if (approvedKyc) {\r\n        // Self-heal: Update the flag if it was false but an approved request exists\r\n        await prisma.user.update({\r\n            where: { id: userId },\r\n            data: { isKycVerified: true } as any,\r\n        })\r\n        return null\r\n    }\r\n\r\n    return NextResponse.json(\r\n        {\r\n            error: \"KYC Required\",\r\n            message: \"Please complete your KYC verification to access this service.\",\r\n            code: \"KYC_REQUIRED\",\r\n        },\r\n        { status: 403 }\r\n    )\r\n}\r\n","type RetryOptions = {\r\n  retries?: number\r\n  baseDelayMs?: number\r\n  maxDelayMs?: number\r\n  timeoutMs?: number\r\n  retryOnStatuses?: number[]\r\n}\r\n\r\nasync function withTimeout<T>(promise: Promise<T>, ms: number): Promise<T> {\r\n  return new Promise<T>((resolve, reject) => {\r\n    const timer = setTimeout(() => reject(new Error(`Request timed out after ${ms}ms`)), ms)\r\n    promise\r\n      .then((val) => {\r\n        clearTimeout(timer)\r\n        resolve(val)\r\n      })\r\n      .catch((err) => {\r\n        clearTimeout(timer)\r\n        reject(err)\r\n      })\r\n  })\r\n}\r\n\r\nfunction sleep(ms: number) {\r\n  return new Promise((r) => setTimeout(r, ms))\r\n}\r\n\r\nexport async function fetchJsonWithRetry(input: RequestInfo | URL, init: RequestInit = {}, opts: RetryOptions = {}) {\r\n  const {\r\n    retries = 3,\r\n    baseDelayMs = 300,\r\n    maxDelayMs = 3000,\r\n    timeoutMs = 8000,\r\n    retryOnStatuses = [408, 429, 500, 502, 503, 504],\r\n  } = opts\r\n\r\n  let attempt = 0\r\n  let lastError: any\r\n  while (attempt <= retries) {\r\n    try {\r\n      const res = await withTimeout(fetch(input, init), timeoutMs)\r\n      let data: any = null\r\n      try {\r\n        data = await res.json()\r\n      } catch {\r\n        data = null\r\n      }\r\n      if (!res.ok && retryOnStatuses.includes(res.status) && attempt < retries) {\r\n        const delay = Math.min(maxDelayMs, baseDelayMs * Math.pow(2, attempt))\r\n        await sleep(delay)\r\n        attempt++\r\n        continue\r\n      }\r\n      return { res, data }\r\n    } catch (err) {\r\n      lastError = err\r\n      if (attempt < retries) {\r\n        const delay = Math.min(maxDelayMs, baseDelayMs * Math.pow(2, attempt))\r\n        await sleep(delay)\r\n        attempt++\r\n        continue\r\n      }\r\n      throw err\r\n    }\r\n  }\r\n  throw lastError\r\n}\r\n\r\nexport function buildAuthHeaders(apiKey?: string, extra?: Record<string, string>) {\r\n  const headers: Record<string, string> = {\r\n    'Content-Type': 'application/json',\r\n    ...(extra || {}),\r\n  }\r\n  if (apiKey) {\r\n    headers['Authorization'] = `Bearer ${apiKey}`\r\n    headers['x-api-key'] = apiKey\r\n  }\r\n  return headers\r\n}","import { type AirtimeRequest, type AirtimeResponse } from \"@/lib/providers/airtime\"\r\nimport { type ProviderConfig } from \"@/lib/provider-manager\"\r\nimport { fetchJsonWithRetry, buildAuthHeaders } from \"@/lib/http-client\"\r\n\r\n/**\r\n * Real Airtime VTU adapter for PortedSIM-like providers.\r\n * Uses provider configuration (base URL + API keys) or environment fallbacks.\r\n *\r\n * Expected provider config:\r\n * - apiBaseUrl: string (e.g., https://api.portedsim.com)\r\n * - apiKeys: [{ keyName: \"apiKey\", keyValue: \"...\" }]\r\n * - configJson may include { adapter: \"ported\", endpoints: { vtu: \"/airtime/vtu\" } }\r\n */\r\nexport async function sendAirtimeViaPorted(\r\n  req: AirtimeRequest,\r\n  provider?: ProviderConfig,\r\n): Promise<AirtimeResponse> {\r\n  const apiBase = provider?.apiBaseUrl || process.env.PORTEDSIM_BASE_URL || \"\"\r\n  const apiKey = (provider?.apiKeys || []).find((k) => k.keyName.toLowerCase() === \"apikey\")?.keyValue ||\r\n    process.env.PORTEDSIM_API_KEY || \"\"\r\n\r\n  const vtuPath = (provider?.configJson as any)?.endpoints?.vtu || \"/airtime/vtu\"\r\n  const url = `${apiBase}${vtuPath}`\r\n\r\n  if (!apiBase || !apiKey) {\r\n    return { ok: false, code: \"MISSING_CONFIG\", message: \"Missing provider base URL or API key\" }\r\n  }\r\n\r\n  if (!req.params?.phone || !req.params?.network) {\r\n    return { ok: false, code: \"BAD_INPUT\", message: \"Missing phone or network\" }\r\n  }\r\n\r\n  try {\r\n    const payload = {\r\n      phone: req.params.phone,\r\n      network: req.params.network,\r\n      amount: req.amount,\r\n      subServiceId: req.subServiceId,\r\n    }\r\n\r\n    const { res, data } = await fetchJsonWithRetry(url, {\r\n      method: \"POST\",\r\n      headers: buildAuthHeaders(apiKey),\r\n      body: JSON.stringify(payload),\r\n    }, { retries: 3, baseDelayMs: 400, timeoutMs: 10000 })\r\n\r\n    if (!res.ok) {\r\n      const message = data?.message || data?.error || `Provider error (${res.status})`\r\n      const code = data?.code || \"PROVIDER_ERROR\"\r\n      return { ok: false, code, message }\r\n    }\r\n\r\n    const providerReference = data?.reference || data?.providerRef || data?.transactionId\r\n    if (!providerReference) {\r\n      return { ok: false, code: \"NO_REFERENCE\", message: \"Missing provider reference\" }\r\n    }\r\n\r\n    return {\r\n      ok: true,\r\n      providerReference,\r\n      message: data?.message || \"Airtime delivered\",\r\n    }\r\n  } catch (err) {\r\n    return { ok: false, code: \"NETWORK_ERROR\", message: String(err) }\r\n  }\r\n}","import { type DataRequest, type DataResponse } from \"@/lib/providers/data\"\r\nimport { type ProviderConfig } from \"@/lib/provider-manager\"\r\nimport { fetchJsonWithRetry, buildAuthHeaders } from \"@/lib/http-client\"\r\n\r\n/**\r\n * Real Data Bundle adapter for PortedSIM-like providers.\r\n * Uses provider configuration (base URL + API keys) or environment fallbacks.\r\n *\r\n * Expected provider config:\r\n * - apiBaseUrl: string (e.g., https://api.portedsim.com)\r\n * - apiKeys: [{ keyName: \"apiKey\", keyValue: \"...\" }]\r\n * - configJson may include { adapter: \"ported\", endpoints: { bundle: \"/data/bundle\" } }\r\n */\r\nexport async function sendDataBundleViaPorted(\r\n  req: DataRequest,\r\n  provider?: ProviderConfig,\r\n): Promise<DataResponse> {\r\n  const apiBase = provider?.apiBaseUrl || process.env.PORTEDSIM_BASE_URL || \"\"\r\n  const apiKey = (provider?.apiKeys || []).find((k) => k.keyName.toLowerCase() === \"apikey\")?.keyValue ||\r\n    process.env.PORTEDSIM_API_KEY || \"\"\r\n\r\n  const bundlePath = (provider?.configJson as any)?.endpoints?.bundle || \"/data/bundle\"\r\n  const url = `${apiBase}${bundlePath}`\r\n\r\n  if (!apiBase || !apiKey) {\r\n    return { ok: false, code: \"MISSING_CONFIG\", message: \"Missing provider base URL or API key\" }\r\n  }\r\n\r\n  if (!req.params?.phone || !req.params?.network || !req.params?.planCode) {\r\n    return { ok: false, code: \"BAD_INPUT\", message: \"Missing phone, network, or planCode\" }\r\n  }\r\n\r\n  try {\r\n    const payload = {\r\n      phone: req.params.phone,\r\n      network: req.params.network,\r\n      planCode: req.params.planCode,\r\n      amount: req.amount,\r\n      subServiceId: req.subServiceId,\r\n    }\r\n\r\n    const { res, data } = await fetchJsonWithRetry(url, {\r\n      method: \"POST\",\r\n      headers: buildAuthHeaders(apiKey),\r\n      body: JSON.stringify(payload),\r\n    }, { retries: 3, baseDelayMs: 400, timeoutMs: 10000 })\r\n\r\n    if (!res.ok) {\r\n      const message = data?.message || data?.error || `Provider error (${res.status})`\r\n      const code = data?.code || \"PROVIDER_ERROR\"\r\n      return { ok: false, code, message }\r\n    }\r\n\r\n    const providerReference = data?.reference || data?.providerRef || data?.transactionId\r\n\r\n    if (!providerReference) {\r\n      return { ok: false, code: \"NO_REFERENCE\", message: \"Missing provider reference\" }\r\n    }\r\n\r\n    return {\r\n      ok: true,\r\n      providerReference,\r\n      message: data?.message || \"Data bundle activated\",\r\n    }\r\n  } catch (err) {\r\n    return { ok: false, code: \"NETWORK_ERROR\", message: String(err) }\r\n  }\r\n}","import { type BillsRequest, type BillsResponse } from \"@/lib/providers/bills\"\r\nimport { type ProviderConfig } from \"@/lib/provider-manager\"\r\nimport { fetchJsonWithRetry, buildAuthHeaders } from \"@/lib/http-client\"\r\n\r\n/**\r\n * Real Bills/Electricity adapter for SubAndGain provider.\r\n * Uses provider configuration (base URL + API keys) or environment fallbacks.\r\n *\r\n * Expected provider config:\r\n * - apiBaseUrl: string (e.g., https://subandgain.com)\r\n * - apiKeys: [{ keyName: \"apiKey\", keyValue: \"...\" }]\r\n * - configJson may include { adapter: \"subandgain\", endpoints: { purchase: \"/electricity/purchase\" } }\r\n */\r\nexport async function payBillViaSubAndGain(\r\n  req: BillsRequest,\r\n  provider?: ProviderConfig,\r\n): Promise<BillsResponse> {\r\n  const apiBase = provider?.apiBaseUrl || process.env.SUBANDGAIN_BASE_URL || \"https://subandgain.com\"\r\n  const apiKey = (provider?.apiKeys || []).find((k) => k.keyName.toLowerCase() === \"apikey\")?.keyValue ||\r\n    process.env.SUBANDGAIN_API_KEY || \"\"\r\n\r\n  const purchasePath = (provider?.configJson as any)?.endpoints?.purchase || \"/electricity/purchase\"\r\n  const url = `${apiBase}${purchasePath}`\r\n\r\n  if (!apiBase || !apiKey) {\r\n    return { ok: false, code: \"MISSING_CONFIG\", message: \"Missing provider base URL or API key\" }\r\n  }\r\n\r\n  // Basic validation mirroring the mock adapter\r\n  if (!req.params?.meterNumber || !req.params?.serviceProvider) {\r\n    return { ok: false, code: \"BAD_INPUT\", message: \"Missing meter number or service provider\" }\r\n  }\r\n\r\n  try {\r\n    const payload = {\r\n      meterNumber: req.params.meterNumber,\r\n      disco: req.params.serviceProvider, // provider code/name per upstream API\r\n      amount: req.amount,\r\n      // Additional optional fields\r\n      customerName: req.params.customerName,\r\n      customerAddress: req.params.customerAddress,\r\n      // Pass through subServiceId if upstream supports variants\r\n      subServiceId: req.subServiceId,\r\n    }\r\n\r\n    const { res, data } = await fetchJsonWithRetry(url, {\r\n      method: \"POST\",\r\n      headers: buildAuthHeaders(apiKey),\r\n      body: JSON.stringify(payload),\r\n    }, { retries: 3, baseDelayMs: 400, timeoutMs: 10000 })\r\n\r\n    if (!res.ok) {\r\n      const errorCode = data?.error || \"PROVIDER_ERROR\";\r\n      let message = data?.message || data?.error || `Provider error (${res.status})`;\r\n      \r\n      // Map SubAndGain specific error codes to user-friendly messages\r\n      switch (errorCode) {\r\n        case \"ERR200\":\r\n          return { ok: false, code: \"INVALID_USERNAME\", message: \"Username field is empty\" };\r\n        case \"ERR201\":\r\n          return { ok: false, code: \"INVALID_CREDENTIALS\", message: \"Invalid username or API key\" };\r\n        case \"ERR203\":\r\n          return { ok: false, code: \"INSUFFICIENT_BALANCE\", message: \"Insufficient balance to complete transaction\" };\r\n        case \"ERR206\":\r\n          return { ok: false, code: \"TRANSACTION_FAILED\", message: \"Order could not be processed. Please try again later\" };\r\n        case \"ERR208\":\r\n          return { ok: false, code: \"INVALID_METER\", message: \"Invalid meter number provided\" };\r\n        case \"ERR209\":\r\n          return { ok: false, code: \"INVALID_DISCO\", message: \"Invalid electricity provider specified\" };\r\n        case \"ERR210\":\r\n          return { ok: false, code: \"INVALID_AMOUNT\", message: \"Invalid amount specified\" };\r\n        default:\r\n          return { ok: false, code: errorCode || data?.code || \"PROVIDER_ERROR\", message };\r\n      }\r\n    }\r\n\r\n    // Map common fields from provider response\r\n    const providerReference = data?.reference || data?.providerRef || data?.transactionId\r\n    const token = data?.token || data?.tokenUnits || data?.unitsToken\r\n    const units = data?.units || (data?.energyUnits ? `${data.energyUnits} kWh` : undefined)\r\n\r\n    if (!providerReference) {\r\n      return { ok: false, code: \"NO_REFERENCE\", message: \"Missing provider reference\" }\r\n    }\r\n\r\n    return {\r\n      ok: true,\r\n      providerReference,\r\n      token,\r\n      units,\r\n      message: data?.message || \"Electricity purchase successful\",\r\n    }\r\n  } catch (err) {\r\n    return { ok: false, code: \"NETWORK_ERROR\", message: String(err) }\r\n  }\r\n}","import { type AirtimeRequest, type AirtimeResponse } from \"@/lib/providers/airtime\"\r\nimport { type ProviderConfig } from \"@/lib/provider-manager\"\r\nimport { fetchJsonWithRetry } from \"@/lib/http-client\"\r\n\r\n// Normalize common Nigerian network names to SubAndGain-expected values\r\nfunction normalizeNetwork(input: string): string {\r\n  const n = input.trim().toUpperCase()\r\n  if (!n) return n\r\n  if (n === \"ETISALAT\") return \"9MOBILE\"\r\n  if (n === \"9 MOBILE\" || n === \"9-MOBILE\") return \"9MOBILE\"\r\n  if (n === \"AIRTEL NG\") return \"AIRTEL\"\r\n  return n\r\n}\r\n\r\n/**\r\n * Real Airtime VTU adapter for SubAndGain providers.\r\n * Uses provider configuration (base URL + API keys) or environment fallbacks.\r\n *\r\n * SubAndGain docs: https://subandgain.com/APIAirtime.php (pattern similar to data/bills)\r\n * Endpoint (typical): GET https://subandgain.com/api/airtime.php?username=...&apiKey=...&network=...&amount=...&phoneNumber=...\r\n */\r\nexport async function sendAirtimeViaSubAndGain(\r\n  req: AirtimeRequest,\r\n  provider?: ProviderConfig,\r\n): Promise<AirtimeResponse> {\r\n  const apiBase = provider?.apiBaseUrl || process.env.SUBANDGAIN_BASE_URL || \"https://subandgain.com\"\r\n\r\n  const apiKey = (provider?.apiKeys || []).find((k) => k.keyName.toLowerCase() === \"apikey\")?.keyValue ||\r\n    process.env.SUBANDGAIN_API_KEY || \"\"\r\n  const username = (provider?.apiKeys || []).find((k) => k.keyName.toLowerCase() === \"username\")?.keyValue ||\r\n    process.env.SUBANDGAIN_USERNAME || \"\"\r\n\r\n  if (!apiBase || !apiKey || !username) {\r\n    return { ok: false, code: \"MISSING_CONFIG\", message: \"Missing provider base URL, username, or API key\" }\r\n  }\r\n\r\n  const phoneNumber = String((req.params as any)?.phone || (req.params as any)?.phoneNumber || \"\").trim()\r\n  const rawNetwork = String(req.params?.network || \"\")\r\n  const normalizedNetwork = normalizeNetwork(rawNetwork)\r\n\r\n  if (!phoneNumber || !normalizedNetwork || !(req.amount > 0)) {\r\n    return { ok: false, code: \"BAD_INPUT\", message: \"Missing phone, network, or amount\" }\r\n  }\r\n\r\n  const validNetworks = [\"MTN\", \"GLO\", \"AIRTEL\", \"9MOBILE\"]\r\n  if (!validNetworks.includes(normalizedNetwork)) {\r\n    return { ok: false, code: \"INVALID_NETWORK\", message: `Unsupported network: ${rawNetwork}` }\r\n  }\r\n\r\n  try {\r\n    const network = normalizedNetwork\r\n    \r\n    // Ensure amount is an integer Naira value\r\n    const amount = Math.round(Number(req.amount))\r\n\r\n    const airtimePath = \"/api/airtime.php\"\r\n    const url = `${apiBase}${airtimePath}?username=${encodeURIComponent(username)}&apiKey=${encodeURIComponent(apiKey)}&network=${encodeURIComponent(network)}&amount=${encodeURIComponent(String(amount))}&phoneNumber=${encodeURIComponent(phoneNumber)}`\r\n\r\n    const { res, data } = await fetchJsonWithRetry(url, { method: \"GET\" }, { retries: 3, baseDelayMs: 400, timeoutMs: 10000 })\r\n\r\n    // Robust provider error detection: treat \"0\" or 0 as success\r\n    const rawErr = (data as any)?.error\r\n    const errStr = typeof rawErr === \"string\" ? rawErr.trim().toLowerCase() : rawErr\r\n    const looksSuccessText = String((data as any)?.api_response || (data as any)?.message || \"\").toLowerCase()\r\n    const isProviderError = !res.ok || (\r\n      rawErr != null &&\r\n      errStr !== 0 && errStr !== \"0\" && errStr !== \"\" && errStr !== \"ok\" && errStr !== \"success\" && !/success/.test(looksSuccessText)\r\n    )\r\n\r\n    if (isProviderError) {\r\n      const errorCode = (data as any)?.error || \"PROVIDER_ERROR\"\r\n      const message = (data as any)?.description || (data as any)?.message || (data as any)?.api_response || `Provider error (${res.status})`\r\n      switch (errorCode) {\r\n        case \"ERR200\":\r\n          return { ok: false, code: \"INVALID_USERNAME\", message: \"Username field is empty\" }\r\n        case \"ERR201\":\r\n          return { ok: false, code: \"INVALID_CREDENTIALS\", message: \"Invalid username or API key\" }\r\n        case \"ERR202\":\r\n          return { ok: false, code: \"INVALID_PHONE\", message: \"Invalid recipient phone number\" }\r\n        case \"ERR203\":\r\n          return { ok: false, code: \"INSUFFICIENT_BALANCE\", message: \"Insufficient balance to complete transaction\" }\r\n        case \"ERR204\":\r\n          return { ok: false, code: \"INVALID_NETWORK\", message: \"Invalid network provider specified\" }\r\n        case \"ERR206\":\r\n          return { ok: false, code: \"TRANSACTION_FAILED\", message: \"Order could not be processed. Please try again later\" }\r\n        default:\r\n          return { ok: false, code: String(errorCode), message }\r\n      }\r\n    }\r\n\r\n    const providerReference = (data as any)?.trans_id || (data as any)?.reference || (data as any)?.transactionId || (data as any)?.transaction_id\r\n    if (!providerReference) {\r\n      return { ok: false, code: \"NO_REFERENCE\", message: \"Missing provider reference\" }\r\n    }\r\n\r\n    return {\r\n      ok: true,\r\n      providerReference,\r\n      message: (data as any)?.api_response || (data as any)?.message || \"Airtime delivered\",\r\n    }\r\n  } catch (err) {\r\n    return { ok: false, code: \"NETWORK_ERROR\", message: String(err) }\r\n  }\r\n}","import { type DataRequest, type DataResponse } from \"@/lib/providers/data\"\r\nimport { type ProviderConfig } from \"@/lib/provider-manager\"\r\nimport { fetchJsonWithRetry } from \"@/lib/http-client\"\r\n\r\n// Normalize common Nigerian network names to SubAndGain-expected values\r\nfunction normalizeNetwork(input: string): string {\r\n  const n = input.trim().toUpperCase()\r\n  if (!n) return n\r\n  if (n === \"ETISALAT\") return \"9MOBILE\"\r\n  if (n === \"9 MOBILE\" || n === \"9-MOBILE\") return \"9MOBILE\"\r\n  if (n === \"AIRTEL NG\") return \"AIRTEL\"\r\n  return n\r\n}\r\n\r\n/**\r\n * Real Data Bundle adapter for SubAndGain providers.\r\n * Uses provider configuration (base URL + API keys) or environment fallbacks.\r\n *\r\n * Docs: https://subandgain.com/APIBuyData.php\r\n * Endpoint: GET https://subandgain.com/api/data.php?username=...&apiKey=...&network=...&dataPlan=...&phoneNumber=...\r\n */\r\nexport async function sendDataBundleViaSubAndGain(\r\n  req: DataRequest,\r\n  provider?: ProviderConfig,\r\n): Promise<DataResponse> {\r\n  const apiBase = provider?.apiBaseUrl || process.env.SUBANDGAIN_BASE_URL || \"https://subandgain.com\"\r\n\r\n  const apiKey = (provider?.apiKeys || []).find((k) => k.keyName.toLowerCase() === \"apikey\")?.keyValue ||\r\n    process.env.SUBANDGAIN_API_KEY || \"\"\r\n  const username = (provider?.apiKeys || []).find((k) => k.keyName.toLowerCase() === \"username\")?.keyValue ||\r\n    process.env.SUBANDGAIN_USERNAME || \"\"\r\n\r\n  if (!apiBase || !apiKey || !username) {\r\n    return { ok: false, code: \"MISSING_CONFIG\", message: \"Missing provider base URL, username, or API key\" }\r\n  }\r\n\r\n  const phoneNumber = String((req.params as any)?.phone || (req.params as any)?.phoneNumber || \"\").trim()\r\n  const rawNetwork = String(req.params?.network || \"\")\r\n  const normalizedNetwork = normalizeNetwork(rawNetwork)\r\n  const planCode = String((req.params as any)?.planCode || (req.params as any)?.plan || (req.params as any)?.dataPlan || \"\").trim()\r\n\r\n  if (!phoneNumber || !normalizedNetwork || !planCode) {\r\n    return { ok: false, code: \"BAD_INPUT\", message: \"Missing phone, network, or planCode\" }\r\n  }\r\n\r\n  const validNetworks = [\"MTN\", \"GLO\", \"AIRTEL\", \"9MOBILE\"]\r\n  if (!validNetworks.includes(normalizedNetwork)) {\r\n    return { ok: false, code: \"INVALID_NETWORK\", message: `Unsupported network: ${rawNetwork}` }\r\n  }\r\n\r\n  try {\r\n    const network = normalizedNetwork\r\n    const dataPlan = planCode\r\n\r\n    const dataPath = \"/api/data.php\"\r\n    const url = `${apiBase}${dataPath}?username=${encodeURIComponent(username)}&apiKey=${encodeURIComponent(apiKey)}&network=${encodeURIComponent(network)}&dataPlan=${encodeURIComponent(dataPlan)}&phoneNumber=${encodeURIComponent(phoneNumber)}`\r\n\r\n    const { res, data } = await fetchJsonWithRetry(url, { method: \"GET\" }, { retries: 3, baseDelayMs: 400, timeoutMs: 10000 })\r\n\r\n    if (!res.ok || data?.error) {\r\n      const errorCode = data?.error || \"PROVIDER_ERROR\";\r\n      let message = data?.description || data?.message || data?.error || `Provider error (${res.status})`;\r\n      \r\n      // Map SubAndGain specific error codes to user-friendly messages\r\n      switch (errorCode) {\r\n        case \"ERR200\":\r\n          return { ok: false, code: \"INVALID_USERNAME\", message: \"Username field is empty\" };\r\n        case \"ERR201\":\r\n          return { ok: false, code: \"INVALID_CREDENTIALS\", message: \"Invalid username or API key\" };\r\n        case \"ERR202\":\r\n          return { ok: false, code: \"INVALID_PHONE\", message: \"Invalid recipient phone number\" };\r\n        case \"ERR203\":\r\n          return { ok: false, code: \"INSUFFICIENT_BALANCE\", message: \"Insufficient balance to complete transaction\" };\r\n        case \"ERR204\":\r\n          return { ok: false, code: \"INVALID_NETWORK\", message: \"Invalid network provider specified\" };\r\n        case \"ERR206\":\r\n          return { ok: false, code: \"TRANSACTION_FAILED\", message: \"Order could not be processed. Please try again later\" };\r\n        case \"ERR207\":\r\n          return { ok: false, code: \"INVALID_PLAN\", message: \"Invalid data plan selected\" };\r\n        default:\r\n          return { ok: false, code: errorCode, message };\r\n      }\r\n    }\r\n\r\n    const providerReference = data?.trans_id || data?.reference || data?.transactionId\r\n    if (!providerReference) {\r\n      return { ok: false, code: \"NO_REFERENCE\", message: \"Missing provider reference\" }\r\n    }\r\n\r\n    return {\r\n      ok: true,\r\n      providerReference,\r\n      message: data?.api_response || data?.message || \"Data bundle activated\",\r\n    }\r\n  } catch (err) {\r\n    return { ok: false, code: \"NETWORK_ERROR\", message: String(err) }\r\n  }\r\n}","import { type ProviderConfig } from \"@/lib/provider-manager\"\r\nimport { fetchJsonWithRetry } from \"@/lib/http-client\"\r\n\r\nexport type EducationParams = {\r\n  eduType: string // e.g. NEONE, WAEONE, etc (see docs)\r\n}\r\n\r\nexport type EducationRequest = {\r\n  amount: number\r\n  params: EducationParams\r\n  providerId: string\r\n  subServiceId?: string\r\n}\r\n\r\nexport type EducationResponse = {\r\n  ok: boolean\r\n  providerReference?: string\r\n  token?: string\r\n  code?: string\r\n  message?: string\r\n}\r\n\r\n/**\r\n * Real Education Bills adapter for SubAndGain providers.\r\n * Uses provider configuration (base URL + API keys) or environment fallbacks.\r\n *\r\n * Docs: https://subandgain.com/APIEducation.php\r\n * Endpoint: GET https://subandgain.com/api/education.php?username=...&apiKey=...&eduType=...\r\n */\r\nexport async function payEducationViaSubAndGain(\r\n  req: EducationRequest,\r\n  provider?: ProviderConfig,\r\n): Promise<EducationResponse> {\r\n  const apiBase = provider?.apiBaseUrl || process.env.SUBANDGAIN_BASE_URL || \"https://subandgain.com\"\r\n\r\n  const apiKey = (provider?.apiKeys || []).find((k) => k.keyName.toLowerCase() === \"apikey\")?.keyValue ||\r\n    process.env.SUBANDGAIN_API_KEY || \"\"\r\n  const username = (provider?.apiKeys || []).find((k) => k.keyName.toLowerCase() === \"username\")?.keyValue ||\r\n    process.env.SUBANDGAIN_USERNAME || \"\"\r\n\r\n  if (!apiBase || !apiKey || !username) {\r\n    return { ok: false, code: \"MISSING_CONFIG\", message: \"Missing provider base URL, username, or API key\" }\r\n  }\r\n\r\n  if (!req.params?.eduType) {\r\n    return { ok: false, code: \"BAD_INPUT\", message: \"Missing eduType\" }\r\n  }\r\n\r\n  try {\r\n    const eduType = String(req.params.eduType).toUpperCase()\r\n\r\n    const eduPath = \"/api/education.php\"\r\n    const url = `${apiBase}${eduPath}?username=${encodeURIComponent(username)}&apiKey=${encodeURIComponent(apiKey)}&eduType=${encodeURIComponent(eduType)}`\r\n\r\n    const { res, data } = await fetchJsonWithRetry(url, { method: \"GET\" }, { retries: 3, baseDelayMs: 400, timeoutMs: 10000 })\r\n\r\n    if (!res.ok || data?.error) {\r\n      const errorCode = data?.error || \"PROVIDER_ERROR\";\r\n      let message = data?.description || data?.message || data?.error || `Provider error (${res.status})`;\r\n      \r\n      // Map SubAndGain specific error codes to user-friendly messages\r\n      switch (errorCode) {\r\n        case \"ERR200\":\r\n          return { ok: false, code: \"INVALID_USERNAME\", message: \"Username field is empty\" };\r\n        case \"ERR201\":\r\n          return { ok: false, code: \"INVALID_CREDENTIALS\", message: \"Invalid username or API key\" };\r\n        case \"ERR203\":\r\n          return { ok: false, code: \"INSUFFICIENT_BALANCE\", message: \"Insufficient balance to complete transaction\" };\r\n        case \"ERR206\":\r\n          return { ok: false, code: \"TRANSACTION_FAILED\", message: \"Order could not be processed. Please try again later\" };\r\n        case \"ERR207\":\r\n          return { ok: false, code: \"INVALID_EDU_TYPE\", message: \"Invalid education type specified\" };\r\n        default:\r\n          return { ok: false, code: errorCode, message };\r\n      }\r\n    }\r\n\r\n    const providerReference = data?.trans_id || data?.reference || data?.transactionId\r\n    const token = data?.token\r\n    if (!providerReference) {\r\n      return { ok: false, code: \"NO_REFERENCE\", message: \"Missing provider reference\" }\r\n    }\r\n\r\n    return {\r\n      ok: true,\r\n      providerReference,\r\n      token,\r\n      message: data?.message || \"Education token purchase successful\",\r\n    }\r\n  } catch (err) {\r\n    return { ok: false, code: \"NETWORK_ERROR\", message: String(err) }\r\n  }\r\n}","export function isManualService(serviceId: string, subServiceId?: string): boolean {\r\n    const sId = serviceId.toLowerCase()\r\n    const subId = subServiceId?.toLowerCase()\r\n\r\n    // BVN: printout, advanced, retrieval_phone are automated\r\n    if (sId === \"bvn\") {\r\n        const auto = [\"printout\", \"retrieval\"]\r\n        return !subId || !auto.includes(subId)\r\n    }\r\n\r\n    // NIN: slip, printout, advanced are automated\r\n    if (sId === \"nin\") {\r\n        const auto = [\"slip\", \"printout\", \"advanced\"]\r\n        return !subId || !auto.includes(subId)\r\n    }\r\n\r\n    // CAC: status-report, certification, info, status are automated\r\n    if (sId === \"cac\") {\r\n        const auto = [\"status-report\", \"certification\", \"status\", \"info\"]\r\n        return !subId || !auto.includes(subId)\r\n    }\r\n\r\n    // POS and Software: Always manual\r\n    if (sId === \"pos-requests\" || sId === \"software-development\") return true\r\n\r\n    return false\r\n}\r\n\r\nexport function handleServiceError(resp: any, toast: any, title = \"Error\") {\r\n    const message = resp.error || resp.message || \"An unexpected error occurred\"\r\n    toast({\r\n        title,\r\n        description: message,\r\n        variant: \"destructive\",\r\n    })\r\n}\r\n"],"names":[],"mappings":"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"}