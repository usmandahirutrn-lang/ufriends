module.exports = [
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/util [external] (util, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}),
"[externals]/url [external] (url, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}),
"[externals]/http [external] (http, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}),
"[externals]/crypto [external] (crypto, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}),
"[externals]/assert [external] (assert, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("assert", () => require("assert"));

module.exports = mod;
}),
"[externals]/querystring [external] (querystring, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("querystring", () => require("querystring"));

module.exports = mod;
}),
"[externals]/buffer [external] (buffer, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}),
"[externals]/zlib [external] (zlib, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}),
"[externals]/https [external] (https, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}),
"[externals]/events [external] (events, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}),
"[externals]/@prisma/client [external] (@prisma/client, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("@prisma/client", () => require("@prisma/client"));

module.exports = mod;
}),
"[project]/lib/db.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "prisma",
    ()=>prisma
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f40$prisma$2f$client__$5b$external$5d$__$2840$prisma$2f$client$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/@prisma/client [external] (@prisma/client, cjs)");
;
const globalForPrisma = /*TURBOPACK member replacement*/ __turbopack_context__.g;
const prisma = globalForPrisma.prisma ?? new __TURBOPACK__imported__module__$5b$externals$5d2f40$prisma$2f$client__$5b$external$5d$__$2840$prisma$2f$client$2c$__cjs$29$__["PrismaClient"]({
    log: [
        "error",
        "warn"
    ]
});
if ("TURBOPACK compile-time truthy", 1) globalForPrisma.prisma = prisma;
}),
"[externals]/node:crypto [external] (node:crypto, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:crypto", () => require("node:crypto"));

module.exports = mod;
}),
"[externals]/stream [external] (stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}),
"[externals]/net [external] (net, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("net", () => require("net"));

module.exports = mod;
}),
"[externals]/stream/web [external] (stream/web, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("stream/web", () => require("stream/web"));

module.exports = mod;
}),
"[externals]/worker_threads [external] (worker_threads, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("worker_threads", () => require("worker_threads"));

module.exports = mod;
}),
"[externals]/perf_hooks [external] (perf_hooks, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("perf_hooks", () => require("perf_hooks"));

module.exports = mod;
}),
"[externals]/util/types [external] (util/types, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("util/types", () => require("util/types"));

module.exports = mod;
}),
"[externals]/node:stream [external] (node:stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:stream", () => require("node:stream"));

module.exports = mod;
}),
"[externals]/node:util [external] (node:util, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:util", () => require("node:util"));

module.exports = mod;
}),
"[externals]/node:events [external] (node:events, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:events", () => require("node:events"));

module.exports = mod;
}),
"[externals]/diagnostics_channel [external] (diagnostics_channel, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("diagnostics_channel", () => require("diagnostics_channel"));

module.exports = mod;
}),
"[externals]/tls [external] (tls, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("tls", () => require("tls"));

module.exports = mod;
}),
"[externals]/http2 [external] (http2, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("http2", () => require("http2"));

module.exports = mod;
}),
"[externals]/string_decoder [external] (string_decoder, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("string_decoder", () => require("string_decoder"));

module.exports = mod;
}),
"[externals]/async_hooks [external] (async_hooks, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("async_hooks", () => require("async_hooks"));

module.exports = mod;
}),
"[externals]/console [external] (console, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("console", () => require("console"));

module.exports = mod;
}),
"[project]/lib/security.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "aj",
    ()=>aj,
    "ajWithEmail",
    ()=>ajWithEmail,
    "protect",
    ()=>protect
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$arcjet$2f$next$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@arcjet/next/index.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$arcjet$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/arcjet/index.js [app-route] (ecmascript)");
;
const aj = process.env.ARCJET_KEY ? (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$arcjet$2f$next$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["default"])({
    key: process.env.ARCJET_KEY,
    rules: [
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$arcjet$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["shield"])({
            mode: "LIVE"
        })
    ]
}) : null;
const ajWithEmail = process.env.ARCJET_KEY ? (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$arcjet$2f$next$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["default"])({
    key: process.env.ARCJET_KEY,
    rules: [
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$arcjet$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["shield"])({
            mode: "LIVE"
        }),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$arcjet$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["validateEmail"])({
            mode: "LIVE",
            deny: [
                "DISPOSABLE",
                "INVALID",
                "NO_MX_RECORDS"
            ]
        })
    ]
}) : null;
async function protect(req, opts) {
    if (!aj) return {
        allowed: true
    };
    try {
        const decision = await (opts?.email && ajWithEmail ? ajWithEmail.protect(req, {
            email: opts.email
        }) : aj.protect(req));
        if (decision?.isDenied?.()) return {
            allowed: false
        };
        return {
            allowed: true
        };
    } catch  {
        // Fail open in dev
        return {
            allowed: true
        };
    }
}
}),
"[externals]/postcss [external] (postcss, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("postcss", () => require("postcss"));

module.exports = mod;
}),
"[project]/lib/validation.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "isValidUrl",
    ()=>isValidUrl,
    "sanitizeEmail",
    ()=>sanitizeEmail,
    "sanitizePhone",
    ()=>sanitizePhone,
    "sanitizeString",
    ()=>sanitizeString,
    "sanitizer",
    ()=>sanitizer
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__ = __turbopack_context__.i("[project]/node_modules/zod/v3/external.js [app-route] (ecmascript) <export * as z>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2d$xss$2d$sanitizer$2f$build$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/zod-xss-sanitizer/build/index.js [app-route] (ecmascript)");
;
;
const sanitizer = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2d$xss$2d$sanitizer$2f$build$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ZodXssSanitizer"].sanitizer({
    actionLevel: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2d$xss$2d$sanitizer$2f$build$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ACTION_LEVELS"].SANITIZE
});
function sanitizeEmail(input) {
    return sanitizer.parse(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().trim().toLowerCase().email().parse(input));
}
function sanitizeString(input) {
    return sanitizer.parse(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().trim().min(1).parse(input));
}
function sanitizePhone(input) {
    const schema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().trim().regex(/^\+?[0-9]{10,15}$/i, {
        message: "Invalid phone"
    });
    return sanitizer.parse(schema.parse(input));
}
function isValidUrl(input) {
    const res = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().url().safeParse(input);
    return res.success;
}
}),
"[project]/lib/auth.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "authOptions",
    ()=>authOptions
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$auth$2f$providers$2f$credentials$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-auth/providers/credentials.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$db$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/db.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$bcryptjs$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/bcryptjs/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$security$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/security.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$joi$2f$lib$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/joi/lib/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$validation$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/validation.ts [app-route] (ecmascript)");
;
;
;
;
;
;
const isProd = ("TURBOPACK compile-time value", "development") === "production";
const authOptions = {
    session: {
        strategy: "jwt"
    },
    providers: [
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$auth$2f$providers$2f$credentials$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"])({
            name: "Credentials",
            credentials: {
                email: {
                    label: "Email",
                    type: "email"
                },
                password: {
                    label: "Password",
                    type: "password"
                }
            },
            async authorize (credentials, req) {
                // Basic input validation with Joi
                const schema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$joi$2f$lib$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].object({
                    // Allow non-public TLDs (e.g., .local) in development; enforce strict in production
                    email: ("TURBOPACK compile-time falsy", 0) ? "TURBOPACK unreachable" : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$joi$2f$lib$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].string().email({
                        tlds: {
                            allow: false
                        }
                    }).required(),
                    password: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$joi$2f$lib$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].string().min(6).required()
                });
                const { error, value } = schema.validate({
                    email: credentials?.email,
                    password: credentials?.password
                });
                if (error) return null;
                // Sanitize email using shared sanitizer
                const safeEmail = __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$validation$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["sanitizer"].parse(value.email.trim().toLowerCase());
                // Centralized protection: Shield/email validation handled by shared helper
                try {
                    const sec = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$security$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["protect"])(req, {
                        email: safeEmail
                    });
                    if (!sec.allowed) return null;
                } catch  {
                // Fail open to avoid login lockouts if Arcjet fails
                }
                // Credentials auth
                const user = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$db$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].user.findUnique({
                    where: {
                        email: safeEmail
                    }
                });
                if (!user) return null;
                const ok = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$bcryptjs$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].compare(value.password, user.passwordHash);
                if (!ok) return null;
                return {
                    id: user.id,
                    email: user.email,
                    role: user.role
                };
            }
        })
    ],
    callbacks: {
        async jwt ({ token, user }) {
            if (user) {
                ;
                token.id = user.id;
                token.role = user.role;
            }
            return token;
        },
        async session ({ session, token }) {
            if (session.user) {
                ;
                session.user.id = token.id;
                session.user.role = token.role;
            }
            return session;
        }
    }
};
}),
"[project]/lib/prembly.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * Prembly API Client
 * Documentation: https://docs.prembly.com/docs/welcome-to-prembly-documentation
 */ __turbopack_context__.s([
    "PremblyClient",
    ()=>PremblyClient,
    "default",
    ()=>__TURBOPACK__default__export__,
    "premblyClient",
    ()=>premblyClient
]);
const PREMBLY_BASE_URL = process.env.PREMBLY_BASE_URL || 'https://api.prembly.com';
class PremblyClient {
    apiKey;
    appId;
    constructor(config){
        this.apiKey = config.apiKey;
        this.appId = config.appId;
    }
    async makeRequest(endpoint, method, data) {
        try {
            if ("TURBOPACK compile-time truthy", 1) {
                console.log('[Prembly] env check', {
                    baseUrl: PREMBLY_BASE_URL,
                    endpoint,
                    hasApiKey: !!this.apiKey,
                    hasAppId: !!this.appId
                });
            }
            const response = await fetch(`${PREMBLY_BASE_URL}${endpoint}`, {
                method,
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                    'x-api-key': this.apiKey,
                    'app-id': this.appId
                },
                body: data ? JSON.stringify(data) : undefined
            });
            const contentType = response.headers.get('content-type') || '';
            let result;
            if (contentType.includes('application/json')) {
                result = await response.json();
            } else {
                const text = await response.text();
                throw new Error(`Unexpected response from Prembly (${response.status}): ${text.slice(0, 200)}...`);
            }
            if (!response.ok) {
                const msg = typeof result?.error === 'string' ? result.error : typeof result?.detail === 'string' ? result.detail : typeof result?.message === 'string' ? result.message : 'Failed to process request';
                throw new Error(msg);
            }
            return result;
        } catch (error) {
            console.error('Prembly API Error:', error);
            return {
                status: false,
                detail: error.message || 'An error occurred while processing your request',
                error: error.message
            };
        }
    }
    // NIN Services
    async getNINPrintout(params) {
        const payload = {
            number_nin: params.nin
        };
        return this.makeRequest('/verification/vnin', 'POST', payload);
    }
    async getNINSlip(params) {
        const payload = {
            number_nin: params.nin
        };
        return this.makeRequest('/verification/vnin', 'POST', payload);
    }
    async getNINAdvanced(params) {
        const payload = {
            number_nin: params.nin
        };
        if (params.phoneNumber) payload.phone_number = params.phoneNumber;
        if (params.firstName) payload.first_name = params.firstName;
        if (params.lastName) payload.last_name = params.lastName;
        if (params.dateOfBirth) payload.date_of_birth = params.dateOfBirth;
        if (params.gender) payload.gender = params.gender;
        return this.makeRequest('/verification/vnin', 'POST', payload);
    }
    // BVN Services (use documented endpoints)
    async getBVNPrintout(params) {
        const payload = {
            number: params.bvn
        };
        return this.makeRequest('/verification/bvn', 'POST', payload);
    }
    async getBVNByPhone(params) {
        // Per docs: POST /verification/bvn_with_phone_advance with payload { phone_number }
        const payload = {
            phone_number: params.phoneNumber
        };
        return this.makeRequest('/verification/bvn_with_phone_advance', 'POST', payload);
    }
    async getBVNAdvanced(params) {
        return this.makeRequest('/verification/bvn/advance', 'POST', params);
    }
    // Phone Number (Advanced)
    async verifyPhoneAdvanced(params) {
        const payload = {
            phone_number: params.phoneNumber
        };
        return this.makeRequest('/verification/phone_number/advance', 'POST', payload);
    }
    // TIN
    async verifyTIN(params) {
        return this.makeRequest('/verification/global/tin-check', 'POST', params);
    }
    // Driver's License (Advanced)
    async verifyDriversLicenseAdvanced(params) {
        const payload = {};
        if (params.licenseNumber) payload.license_number = params.licenseNumber;
        if (params.expiryDate) payload.expiry_date = params.expiryDate;
        if (params.firstName) payload.first_name = params.firstName;
        if (params.lastName) payload.last_name = params.lastName;
        if (params.dob) payload.dob = params.dob;
        return this.makeRequest('/verification/drivers_license/advance/v2', 'POST', payload);
    }
    // Voters Card
    async verifyVotersCard(params) {
        const payload = {
            number: params.number
        };
        if (params.lastName) payload.last_name = params.lastName;
        if (params.firstName) payload.first_name = params.firstName;
        if (params.dob) payload.dob = params.dob;
        if (params.lga) payload.lga = params.lga;
        if (params.state) payload.state = params.state;
        return this.makeRequest('/verification/voters_card', 'POST', payload);
    }
    // CAC Services (Advance)
    async getCACInfo(params) {
        // Docs: POST /verification/cac/advance with rc_number, company_type, company_name
        const payload = {};
        if (params.number) payload.rc_number = String(params.number);
        if (params.companyType) payload.company_type = String(params.companyType);
        if (params.companyName) payload.company_name = String(params.companyName);
        return this.makeRequest('/verification/cac/advance', 'POST', payload);
    }
    async getCACAdvanced(params) {
        const payload = {};
        if (params.number) payload.rc_number = String(params.number);
        if (params.companyType) payload.company_type = String(params.companyType);
        if (params.companyName) payload.company_name = String(params.companyName);
        return this.makeRequest('/verification/cac/advance', 'POST', payload);
    }
    async getCACStatusReport(params) {
        const payload = {};
        if (params.number) payload.rc_number = String(params.number);
        if (params.companyType) payload.company_type = String(params.companyType);
        if (params.companyName) payload.company_name = String(params.companyName);
        return this.makeRequest('/verification/cac/advance', 'POST', payload);
    }
    // International Passport v2
    async verifyInternationalPassportV2(params) {
        const payload = {
            passport_number: params.passportNumber
        };
        if (params.lastName) payload.last_name = params.lastName;
        return this.makeRequest('/verification/national_passport_v2', 'POST', payload);
    }
    // Plate Number
    async verifyPlateNumber(params) {
        const payload = {
            plate_number: params.plateNumber
        };
        return this.makeRequest('/verification/vehicle', 'POST', payload);
    }
}
const premblyClient = new PremblyClient({
    apiKey: process.env.PREMBLY_API_KEY || '',
    appId: process.env.PREMBLY_APP_ID || ''
});
const __TURBOPACK__default__export__ = premblyClient;
}),
"[project]/lib/prembly-sdk-adapter.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__,
    "getPrembly",
    ()=>getPrembly
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/prembly.ts [app-route] (ecmascript)");
// Optional SDK imports. We keep usage minimal and fallback to HTTP client when unsupported.
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$prembly$2d$pass$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/prembly-pass/dist/index.js [app-route] (ecmascript)");
;
;
// Shape normalization helper to keep the same response contract our routes expect
function ok(data, detail = "OK") {
    return {
        status: true,
        detail,
        data
    };
}
function fail(message) {
    return {
        status: false,
        detail: message,
        error: message
    };
}
// Singleton SDK instances (created lazily)
let dataVerification = null;
let generalVerification = null;
let documentVerification = null;
let globalBusinessVerification = null;
function ensureSdkInstances() {
    const apiKey = process.env.PREMBLY_API_KEY || "";
    const appId = process.env.PREMBLY_APP_ID || "";
    if (!apiKey || !appId) return false;
    try {
        if (!dataVerification) dataVerification = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$prembly$2d$pass$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["PremblyDataVerification"](apiKey, appId);
        if (!generalVerification) generalVerification = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$prembly$2d$pass$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["PremblyGeneralVerification"](apiKey, appId);
        if (!documentVerification) documentVerification = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$prembly$2d$pass$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["PremblyDocumentVerification"](apiKey, appId);
        if (!globalBusinessVerification) globalBusinessVerification = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$prembly$2d$pass$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["PremblyGlobalBusinessVerification"](apiKey, appId);
        return true;
    } catch (e) {
        return false;
    }
}
// Adapter exposing the same methods as our HTTP client. Unknowns fall back to HTTP client.
const sdkBackedClient = {
    // Delegate to original HTTP client's private fields through the instance we import
    ...__TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"],
    // Plate Number via SDK (Data Verification)
    async verifyPlateNumber (params) {
        try {
            if (ensureSdkInstances()) {
                const res = await dataVerification.verifyPlateNumber(params.plateNumber);
                // Normalize into our standard response
                return ok(res);
            }
        } catch (e) {
            return fail(e?.message || String(e));
        }
        // Fallback to HTTP client
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].verifyPlateNumber(params);
    },
    // Everything else falls back to the HTTP client for now
    async getBVNPrintout (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getBVNPrintout(params);
    },
    async getBVNByPhone (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getBVNByPhone(params);
    },
    async getBVNAdvanced (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getBVNAdvanced(params);
    },
    async getNINPrintout (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getNINPrintout(params);
    },
    async getNINSlip (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getNINSlip(params);
    },
    async getNINAdvanced (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getNINAdvanced(params);
    },
    async getCACInfo (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getCACInfo(params);
    },
    async getCACAdvanced (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getCACAdvanced(params);
    },
    async getCACStatusReport (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getCACStatusReport(params);
    },
    async verifyInternationalPassportV2 (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].verifyInternationalPassportV2(params);
    },
    async verifyTIN (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].verifyTIN(params);
    },
    async verifyVotersCard (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].verifyVotersCard(params);
    },
    async verifyPhoneAdvanced (params) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].verifyPhoneAdvanced(params);
    }
};
function getPrembly() {
    const useSdk = String(process.env.USE_PREMBLY_SDK || "").toLowerCase() === "true";
    return useSdk ? sdkBackedClient : __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"];
}
const __TURBOPACK__default__export__ = getPrembly;
}),
"[project]/app/api/verification/route.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "GET",
    ()=>GET,
    "POST",
    ()=>POST
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$auth$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next-auth/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$auth$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/auth.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2d$sdk$2d$adapter$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/prembly-sdk-adapter.ts [app-route] (ecmascript)");
;
;
;
;
async function POST(req) {
    try {
        const session = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2d$auth$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getServerSession"])(__TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$auth$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["authOptions"]);
        if (!session) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Authentication required"
            }, {
                status: 401
            });
        }
        const premblyClient = (0, __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$prembly$2d$sdk$2d$adapter$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"])();
        const body = await req.json().catch(()=>({}));
        const action = String(body?.action || "").trim();
        const params = body?.params || {};
        if (!action) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Missing 'action' in request body"
            }, {
                status: 400
            });
        }
        // Basic validators per action
        const requireField = (key)=>{
            if (!params[key] || String(params[key]).trim() === "") {
                throw new Error(`Missing required field: ${key}`);
            }
        };
        let result;
        switch(action){
            // BVN
            case "bvn.printout":
                {
                    requireField("bvn");
                    result = await premblyClient.getBVNPrintout({
                        bvn: String(params.bvn)
                    });
                    break;
                }
            case "bvn.retrieval_phone":
                {
                    requireField("phoneNumber");
                    result = await premblyClient.getBVNByPhone({
                        phoneNumber: String(params.phoneNumber)
                    });
                    break;
                }
            case "bvn.advanced":
                {
                    requireField("bvn");
                    result = await premblyClient.getBVNAdvanced({
                        bvn: String(params.bvn)
                    });
                    break;
                }
            // NIN
            case "nin.printout":
                {
                    requireField("nin");
                    result = await premblyClient.getNINPrintout({
                        nin: String(params.nin)
                    });
                    break;
                }
            case "nin.slip":
                {
                    requireField("nin");
                    result = await premblyClient.getNINSlip({
                        nin: String(params.nin)
                    });
                    break;
                }
            case "nin.advanced":
                {
                    requireField("nin");
                    result = await premblyClient.getNINAdvanced({
                        nin: String(params.nin),
                        phoneNumber: params.phoneNumber ? String(params.phoneNumber) : undefined,
                        firstName: params.firstName ? String(params.firstName) : undefined,
                        lastName: params.lastName ? String(params.lastName) : undefined,
                        dateOfBirth: params.dateOfBirth ? String(params.dateOfBirth) : undefined,
                        gender: params.gender ? String(params.gender) : undefined
                    });
                    break;
                }
            // CAC (Advance) - supports RC, BN, IT via companyType
            case "cac.info":
                {
                    const rawNumber = params.number ?? params.rcNumber;
                    if (!rawNumber || String(rawNumber).trim() === "") throw new Error("Missing required field: number");
                    const companyType = params.companyType ? String(params.companyType).toUpperCase() : undefined;
                    const companyName = params.companyName ? String(params.companyName) : undefined;
                    result = await premblyClient.getCACInfo({
                        number: String(rawNumber),
                        companyType: companyType,
                        companyName
                    });
                    break;
                }
            case "cac.status":
                {
                    const rawNumber = params.number ?? params.rcNumber;
                    if (!rawNumber || String(rawNumber).trim() === "") throw new Error("Missing required field: number");
                    const companyType = params.companyType ? String(params.companyType).toUpperCase() : undefined;
                    const companyName = params.companyName ? String(params.companyName) : undefined;
                    result = await premblyClient.getCACStatusReport({
                        number: String(rawNumber),
                        companyType: companyType,
                        companyName
                    });
                    break;
                }
            // Passport
            case "passport.verify":
                {
                    requireField("passportNumber");
                    result = await premblyClient.verifyInternationalPassportV2({
                        passportNumber: String(params.passportNumber),
                        lastName: params.lastName ? String(params.lastName) : undefined
                    });
                    break;
                }
            // Drivers License (Advanced v2)
            case "drivers_license.verify":
                {
                    result = await premblyClient.verifyDriversLicenseAdvanced({
                        licenseNumber: params.licenseNumber ? String(params.licenseNumber) : undefined,
                        expiryDate: params.expiryDate ? String(params.expiryDate) : undefined,
                        firstName: params.firstName ? String(params.firstName) : undefined,
                        lastName: params.lastName ? String(params.lastName) : undefined,
                        dob: params.dob ? String(params.dob) : undefined
                    });
                    break;
                }
            // TIN
            case "tin.verify":
                {
                    requireField("tin");
                    result = await premblyClient.verifyTIN({
                        tin: String(params.tin)
                    });
                    break;
                }
            // Voters Card
            case "voters.verify":
                {
                    requireField("number");
                    result = await premblyClient.verifyVotersCard({
                        number: String(params.number),
                        lastName: params.lastName ? String(params.lastName) : undefined,
                        firstName: params.firstName ? String(params.firstName) : undefined,
                        dob: params.dob ? String(params.dob) : undefined,
                        lga: params.lga ? String(params.lga) : undefined,
                        state: params.state ? String(params.state) : undefined
                    });
                    break;
                }
            // Plate number
            case "plate.verify":
                {
                    requireField("plateNumber");
                    result = await premblyClient.verifyPlateNumber({
                        plateNumber: String(params.plateNumber)
                    });
                    break;
                }
            // Phone (advanced)
            case "phone.verify_advanced":
                {
                    requireField("phoneNumber");
                    result = await premblyClient.verifyPhoneAdvanced({
                        phoneNumber: String(params.phoneNumber)
                    });
                    break;
                }
            default:
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                    error: `Unsupported action: ${action}`
                }, {
                    status: 400
                });
        }
        if (!result?.status) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: result?.detail || result?.error || "Verification failed"
            }, {
                status: 400
            });
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(result);
    } catch (err) {
        const message = err?.message || String(err) || "Failed to process request";
        const isBadRequest = typeof message === "string" && message.startsWith("Missing required field:");
        const status = isBadRequest ? 400 : 500;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: message
        }, {
            status
        });
    }
}
async function GET() {
    // Discover supported actions
    const actions = [
        "bvn.printout",
        "bvn.retrieval_phone",
        "bvn.advanced",
        "nin.printout",
        "nin.slip",
        "nin.advanced",
        "cac.info",
        "cac.status",
        "passport.verify",
        "drivers_license.verify",
        "tin.verify",
        "voters.verify",
        "plate.verify",
        "phone.verify_advanced"
    ];
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
        ok: true,
        actions
    });
}
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__66873435._.js.map