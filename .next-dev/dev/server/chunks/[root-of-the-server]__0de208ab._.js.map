{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient | undefined }\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: [\"error\", \"warn\"],\n  })\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAO;AACxB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/app/api/auth/2fa/check/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport { prisma } from \"@/lib/db\"\r\n\r\n// POST /api/auth/2fa/check - Check if user has 2FA enabled (before login completion)\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const body = await req.json()\r\n        const { email } = body as { email?: string }\r\n\r\n        if (!email) {\r\n            return NextResponse.json({ error: \"Email is required\" }, { status: 400 })\r\n        }\r\n\r\n        const user = await prisma.user.findUnique({\r\n            where: { email: email.toLowerCase().trim() },\r\n            select: { totpEnabled: true },\r\n        })\r\n\r\n        if (!user) {\r\n            // Don't reveal if user exists, return as if 2FA is not enabled\r\n            return NextResponse.json({ ok: true, requires2FA: false })\r\n        }\r\n\r\n        return NextResponse.json({ ok: true, requires2FA: user.totpEnabled === true })\r\n    } catch (err) {\r\n        return NextResponse.json({ requires2FA: false })\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,KAAK,EAAE,GAAG;QAElB,IAAI,CAAC,OAAO;YACR,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAoB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YACtC,OAAO;gBAAE,OAAO,MAAM,WAAW,GAAG,IAAI;YAAG;YAC3C,QAAQ;gBAAE,aAAa;YAAK;QAChC;QAEA,IAAI,CAAC,MAAM;YACP,+DAA+D;YAC/D,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,IAAI;gBAAM,aAAa;YAAM;QAC5D;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,aAAa,KAAK,WAAW,KAAK;QAAK;IAChF,EAAE,OAAO,KAAK;QACV,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,aAAa;QAAM;IAClD;AACJ","debugId":null}}]
}