{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/jwt.ts"],"sourcesContent":["import { SignJWT, jwtVerify, JWTPayload } from \"jose\";\n\nconst encoder = new TextEncoder();\n\nfunction getAccessSecret() {\n  const secret = process.env.JWT_SECRET || \"dev_access_secret\";\n  return encoder.encode(secret);\n}\n\nfunction getRefreshSecret() {\n  const secret = process.env.JWT_REFRESH_SECRET || \"dev_refresh_secret\";\n  return encoder.encode(secret);\n}\n\nfunction nowSeconds() {\n  return Math.floor(Date.now() / 1000);\n}\n\nexport type TokenPayload = {\n  sub: string; // user id\n  email: string;\n  role: string;\n  jti?: string; // token id for refresh\n};\n\nexport async function signAccessToken(payload: TokenPayload, expiresInSeconds = 15 * 60) {\n  return new SignJWT(payload as JWTPayload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(nowSeconds() + expiresInSeconds)\n    .sign(getAccessSecret());\n}\n\nexport async function signRefreshToken(payload: TokenPayload, expiresInSeconds = 7 * 24 * 60 * 60) {\n  return new SignJWT(payload as JWTPayload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(nowSeconds() + expiresInSeconds)\n    .sign(getRefreshSecret());\n}\n\nexport async function verifyAccessToken<T = TokenPayload>(token: string) {\n  const { payload } = await jwtVerify(token, getAccessSecret());\n  return payload as T;\n}\n\nexport async function verifyRefreshToken<T = TokenPayload>(token: string) {\n  const { payload } = await jwtVerify(token, getRefreshSecret());\n  return payload as T;\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;;AAEA,MAAM,UAAU,IAAI;AAEpB,SAAS;IACP,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU,IAAI;IACzC,OAAO,QAAQ,MAAM,CAAC;AACxB;AAEA,SAAS;IACP,MAAM,SAAS,QAAQ,GAAG,CAAC,kBAAkB,IAAI;IACjD,OAAO,QAAQ,MAAM,CAAC;AACxB;AAEA,SAAS;IACP,OAAO,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;AACjC;AASO,eAAe,gBAAgB,OAAqB,EAAE,mBAAmB,KAAK,EAAE;IACrF,OAAO,IAAI,kKAAO,CAAC,SAChB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,eAAe,kBACjC,IAAI,CAAC;AACV;AAEO,eAAe,iBAAiB,OAAqB,EAAE,mBAAmB,IAAI,KAAK,KAAK,EAAE;IAC/F,OAAO,IAAI,kKAAO,CAAC,SAChB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,eAAe,kBACjC,IAAI,CAAC;AACV;AAEO,eAAe,kBAAoC,KAAa;IACrE,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO;IAC3C,OAAO;AACT;AAEO,eAAe,mBAAqC,KAAa;IACtE,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO;IAC3C,OAAO;AACT","debugId":null}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient | undefined }\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: [\"error\", \"warn\"],\n  })\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAO;AACxB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 273, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/security.ts"],"sourcesContent":["import arcjet, { shield, validateEmail } from \"@arcjet/next\"\n\ntype AJInstance = ReturnType<typeof arcjet> | null\n\n// Create a shared Arcjet instance with common rules.\n// In development, ARCJET_KEY may be missing, so we fail open.\nexport const aj: AJInstance = process.env.ARCJET_KEY\n  ? arcjet({\n      key: process.env.ARCJET_KEY!,\n      rules: [\n        shield({ mode: \"LIVE\" }),\n      ],\n    })\n  : null\n\n// Email-validation instance for routes that need email context\nexport const ajWithEmail: AJInstance = process.env.ARCJET_KEY\n  ? arcjet({\n      key: process.env.ARCJET_KEY!,\n      rules: [\n        shield({ mode: \"LIVE\" }),\n        validateEmail({ mode: \"LIVE\", deny: [\"DISPOSABLE\", \"INVALID\", \"NO_MX_RECORDS\"] }),\n      ],\n    })\n  : null\n\nexport async function protect(req: Request, opts?: { email?: string }) {\n  if (!aj) return { allowed: true }\n  try {\n    const decision = await (opts?.email && ajWithEmail\n      ? (ajWithEmail as any).protect(req as any, { email: opts.email })\n      : (aj as any).protect(req as any))\n    if (decision?.isDenied?.()) return { allowed: false }\n    return { allowed: true }\n  } catch {\n    // Fail open in dev\n    return { allowed: true }\n  }\n}"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;;AAMO,MAAM,KAAiB,QAAQ,GAAG,CAAC,UAAU,GAChD,IAAA,sKAAM,EAAC;IACL,KAAK,QAAQ,GAAG,CAAC,UAAU;IAC3B,OAAO;QACL,IAAA,2IAAM,EAAC;YAAE,MAAM;QAAO;KACvB;AACH,KACA;AAGG,MAAM,cAA0B,QAAQ,GAAG,CAAC,UAAU,GACzD,IAAA,sKAAM,EAAC;IACL,KAAK,QAAQ,GAAG,CAAC,UAAU;IAC3B,OAAO;QACL,IAAA,2IAAM,EAAC;YAAE,MAAM;QAAO;QACtB,IAAA,kJAAa,EAAC;YAAE,MAAM;YAAQ,MAAM;gBAAC;gBAAc;gBAAW;aAAgB;QAAC;KAChF;AACH,KACA;AAEG,eAAe,QAAQ,GAAY,EAAE,IAAyB;IACnE,IAAI,CAAC,IAAI,OAAO;QAAE,SAAS;IAAK;IAChC,IAAI;QACF,MAAM,WAAW,MAAM,CAAC,MAAM,SAAS,cACnC,AAAC,YAAoB,OAAO,CAAC,KAAY;YAAE,OAAO,KAAK,KAAK;QAAC,KAC7D,AAAC,GAAW,OAAO,CAAC,IAAW;QACnC,IAAI,UAAU,cAAc,OAAO;YAAE,SAAS;QAAM;QACpD,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAM;QACN,mBAAmB;QACnB,OAAO;YAAE,SAAS;QAAK;IACzB;AACF","debugId":null}},
    {"offset": {"line": 339, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/validation.ts"],"sourcesContent":["import { z } from \"zod\"\nimport { ZodXssSanitizer, ACTION_LEVELS } from \"zod-xss-sanitizer\"\n\n// Shared XSS sanitizer instance\nexport const sanitizer = ZodXssSanitizer.sanitizer({ actionLevel: ACTION_LEVELS.SANITIZE })\n\nexport function sanitizeEmail(input: string) {\n  return sanitizer.parse(z.string().trim().toLowerCase().email().parse(input))\n}\n\nexport function sanitizeString(input: string) {\n  return sanitizer.parse(z.string().trim().min(1).parse(input))\n}\n\nexport function sanitizePhone(input: string) {\n  const schema = z.string().trim().regex(/^\\+?[0-9]{10,15}$/i, { message: \"Invalid phone\" })\n  return sanitizer.parse(schema.parse(input))\n}\n\nexport function isValidUrl(input: string) {\n  const res = z.string().url().safeParse(input)\n  return res.success\n}"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;AAGO,MAAM,YAAY,8KAAe,CAAC,SAAS,CAAC;IAAE,aAAa,4KAAa,CAAC,QAAQ;AAAC;AAElF,SAAS,cAAc,KAAa;IACzC,OAAO,UAAU,KAAK,CAAC,yKAAC,CAAC,MAAM,GAAG,IAAI,GAAG,WAAW,GAAG,KAAK,GAAG,KAAK,CAAC;AACvE;AAEO,SAAS,eAAe,KAAa;IAC1C,OAAO,UAAU,KAAK,CAAC,yKAAC,CAAC,MAAM,GAAG,IAAI,GAAG,GAAG,CAAC,GAAG,KAAK,CAAC;AACxD;AAEO,SAAS,cAAc,KAAa;IACzC,MAAM,SAAS,yKAAC,CAAC,MAAM,GAAG,IAAI,GAAG,KAAK,CAAC,sBAAsB;QAAE,SAAS;IAAgB;IACxF,OAAO,UAAU,KAAK,CAAC,OAAO,KAAK,CAAC;AACtC;AAEO,SAAS,WAAW,KAAa;IACtC,MAAM,MAAM,yKAAC,CAAC,MAAM,GAAG,GAAG,GAAG,SAAS,CAAC;IACvC,OAAO,IAAI,OAAO;AACpB","debugId":null}},
    {"offset": {"line": 378, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\"\nimport type { NextAuthOptions } from \"next-auth\"\nimport Credentials from \"next-auth/providers/credentials\"\nimport { prisma } from \"@/lib/db\"\nimport bcrypt from \"bcryptjs\"\nimport { protect } from \"@/lib/security\"\nimport Joi from \"joi\"\nimport { sanitizer } from \"@/lib/validation\"\n\nconst isProd = process.env.NODE_ENV === \"production\"\n\nexport const authOptions: NextAuthOptions = {\n  session: { strategy: \"jwt\" },\n  providers: [\n    Credentials({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Email\", type: \"email\" },\n        password: { label: \"Password\", type: \"password\" },\n      },\n      async authorize(credentials, req) {\n        // Basic input validation with Joi\n        const schema = Joi.object({\n          // Allow non-public TLDs (e.g., .local) in development; enforce strict in production\n          email: isProd\n            ? Joi.string().email().required()\n            : Joi.string().email({ tlds: { allow: false } }).required(),\n          password: Joi.string().min(6).required(),\n        })\n        const { error, value } = schema.validate({\n          email: credentials?.email,\n          password: credentials?.password,\n        })\n        if (error) return null\n\n        // Sanitize email using shared sanitizer\n        const safeEmail = sanitizer.parse(value.email.trim().toLowerCase())\n\n        // Centralized protection: Shield/email validation handled by shared helper\n        try {\n          const sec = await protect(req as any, { email: safeEmail })\n          if (!sec.allowed) return null\n        } catch {\n          // Fail open to avoid login lockouts if Arcjet fails\n        }\n\n        // Credentials auth\n        const user = await prisma.user.findUnique({ where: { email: safeEmail } })\n        if (!user) return null\n        const ok = await bcrypt.compare(value.password, user.passwordHash)\n        if (!ok) return null\n        return { id: user.id, email: user.email, role: user.role }\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        ;(token as any).id = (user as any).id\n        ;(token as any).role = (user as any).role\n      }\n      return token\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        ;(session.user as any).id = (token as any).id\n        ;(session.user as any).role = (token as any).role\n      }\n      return session\n    },\n  },\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAEA,MAAM,SAAS,oDAAyB;AAEjC,MAAM,cAA+B;IAC1C,SAAS;QAAE,UAAU;IAAM;IAC3B,WAAW;QACT,IAAA,qKAAW,EAAC;YACV,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW,EAAE,GAAG;gBAC9B,kCAAkC;gBAClC,MAAM,SAAS,gJAAG,CAAC,MAAM,CAAC;oBACxB,oFAAoF;oBACpF,OAAO,sCACH,0BACA,gJAAG,CAAC,MAAM,GAAG,KAAK,CAAC;wBAAE,MAAM;4BAAE,OAAO;wBAAM;oBAAE,GAAG,QAAQ;oBAC3D,UAAU,gJAAG,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,QAAQ;gBACxC;gBACA,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,OAAO,QAAQ,CAAC;oBACvC,OAAO,aAAa;oBACpB,UAAU,aAAa;gBACzB;gBACA,IAAI,OAAO,OAAO;gBAElB,wCAAwC;gBACxC,MAAM,YAAY,gIAAS,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,WAAW;gBAEhE,2EAA2E;gBAC3E,IAAI;oBACF,MAAM,MAAM,MAAM,IAAA,4HAAO,EAAC,KAAY;wBAAE,OAAO;oBAAU;oBACzD,IAAI,CAAC,IAAI,OAAO,EAAE,OAAO;gBAC3B,EAAE,OAAM;gBACN,oDAAoD;gBACtD;gBAEA,mBAAmB;gBACnB,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBAAE,OAAO;wBAAE,OAAO;oBAAU;gBAAE;gBACxE,IAAI,CAAC,MAAM,OAAO;gBAClB,MAAM,KAAK,MAAM,8IAAM,CAAC,OAAO,CAAC,MAAM,QAAQ,EAAE,KAAK,YAAY;gBACjE,IAAI,CAAC,IAAI,OAAO;gBAChB,OAAO;oBAAE,IAAI,KAAK,EAAE;oBAAE,OAAO,KAAK,KAAK;oBAAE,MAAM,KAAK,IAAI;gBAAC;YAC3D;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;;gBACN,MAAc,EAAE,GAAG,AAAC,KAAa,EAAE;gBACnC,MAAc,IAAI,GAAG,AAAC,KAAa,IAAI;YAC3C;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;;gBACd,QAAQ,IAAI,CAAS,EAAE,GAAG,AAAC,MAAc,EAAE;gBAC3C,QAAQ,IAAI,CAAS,IAAI,GAAG,AAAC,MAAc,IAAI;YACnD;YACA,OAAO;QACT;IACF;AACF","debugId":null}},
    {"offset": {"line": 479, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/jwt-auth.ts"],"sourcesContent":["import { verifyAccessToken } from \"./jwt\"\nimport { getServerSession } from \"next-auth\"\nimport { authOptions } from \"@/lib/auth\"\n\nexport type AuthUser = { id: string; email?: string | null; role?: string | null }\n\nexport async function getAuthUser(req: Request): Promise<AuthUser | null> {\n  // Prefer Authorization: Bearer access token\n  const authHeader = (req as any).headers?.get?.(\"authorization\") || \"\"\n  const [, token] = authHeader.split(\" \")\n  if (authHeader.toLowerCase().startsWith(\"bearer \") && token) {\n    try {\n      const payload: any = await verifyAccessToken(token)\n      return { id: payload.sub, email: payload.email, role: payload.role }\n    } catch {}\n  }\n\n  // Fallback to NextAuth session\n  try {\n    const session = await getServerSession(authOptions)\n    if (session?.user?.id) {\n      return { id: (session.user as any).id, email: session.user.email, role: (session.user as any).role }\n    }\n  } catch {}\n\n  return null\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAIO,eAAe,YAAY,GAAY;IAC5C,4CAA4C;IAC5C,MAAM,aAAa,AAAC,IAAY,OAAO,EAAE,MAAM,oBAAoB;IACnE,MAAM,GAAG,MAAM,GAAG,WAAW,KAAK,CAAC;IACnC,IAAI,WAAW,WAAW,GAAG,UAAU,CAAC,cAAc,OAAO;QAC3D,IAAI;YACF,MAAM,UAAe,MAAM,IAAA,iIAAiB,EAAC;YAC7C,OAAO;gBAAE,IAAI,QAAQ,GAAG;gBAAE,OAAO,QAAQ,KAAK;gBAAE,MAAM,QAAQ,IAAI;YAAC;QACrE,EAAE,OAAM,CAAC;IACX;IAEA,+BAA+B;IAC/B,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,2JAAgB,EAAC,4HAAW;QAClD,IAAI,SAAS,MAAM,IAAI;YACrB,OAAO;gBAAE,IAAI,AAAC,QAAQ,IAAI,CAAS,EAAE;gBAAE,OAAO,QAAQ,IAAI,CAAC,KAAK;gBAAE,MAAM,AAAC,QAAQ,IAAI,CAAS,IAAI;YAAC;QACrG;IACF,EAAE,OAAM,CAAC;IAET,OAAO;AACT","debugId":null}},
    {"offset": {"line": 520, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/require-auth.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { getAuthUser, AuthUser } from \"@/lib/jwt-auth\"\n\nexport type RequireAuthOptions = {\n  roles?: Array<string>\n}\n\nexport type RequireAuthResult = {\n  ok: true\n  user: AuthUser\n} | {\n  ok: false\n  response: NextResponse\n}\n\nexport async function requireAuth(req: Request, options: RequireAuthOptions = {}): Promise<RequireAuthResult> {\n  const user = await getAuthUser(req)\n  if (!user?.id) {\n    return { ok: false, response: NextResponse.json({ error: \"Unauthorized\" }, { status: 401 }) }\n  }\n  if (options.roles && user.role && !options.roles.includes(user.role)) {\n    return { ok: false, response: NextResponse.json({ error: \"Forbidden\" }, { status: 403 }) }\n  }\n  return { ok: true, user }\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAcO,eAAe,YAAY,GAAY,EAAE,UAA8B,CAAC,CAAC;IAC9E,MAAM,OAAO,MAAM,IAAA,mIAAW,EAAC;IAC/B,IAAI,CAAC,MAAM,IAAI;QACb,OAAO;YAAE,IAAI;YAAO,UAAU,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QAAG;IAC9F;IACA,IAAI,QAAQ,KAAK,IAAI,KAAK,IAAI,IAAI,CAAC,QAAQ,KAAK,CAAC,QAAQ,CAAC,KAAK,IAAI,GAAG;QACpE,OAAO;YAAE,IAAI;YAAO,UAAU,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAY,GAAG;gBAAE,QAAQ;YAAI;QAAG;IAC3F;IACA,OAAO;QAAE,IAAI;QAAM;IAAK;AAC1B","debugId":null}},
    {"offset": {"line": 571, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/pdf.ts"],"sourcesContent":["import puppeteer, { PDFOptions } from \"puppeteer\"\n\nexport type RenderPdfOptions = PDFOptions & {\n  baseUrl?: string\n}\n\nexport async function renderHtmlToPdfBuffer(html: string, opts: RenderPdfOptions = {}): Promise<Buffer> {\n  const browser = await puppeteer.launch({\n    headless: true,\n    args: [\n      \"--no-sandbox\",\n      \"--disable-setuid-sandbox\",\n      \"--disable-dev-shm-usage\",\n      \"--disable-accelerated-2d-canvas\",\n      \"--no-zygote\",\n      \"--no-first-run\",\n    ],\n    executablePath: process.env.PUPPETEER_EXECUTABLE_PATH,\n  })\n\n  try {\n    const page = await browser.newPage()\n\n    // Allow relative asset URLs (e.g., /assets/logo.png)\n    const base = opts.baseUrl || process.env.APP_BASE_URL || \"http://localhost:3000\"\n    let htmlToRender = html\n    if (/<head[^>]*>/i.test(htmlToRender)) {\n      htmlToRender = htmlToRender.replace(/<head[^>]*>/i, (m) => `${m}<base href=\"${base}\">`)\n    } else {\n      htmlToRender = `<!DOCTYPE html><html><head><base href=\"${base}\"><meta charset=\\\"utf-8\\\"></head><body>${html}</body></html>`\n    }\n\n    await page.setContent(htmlToRender, { waitUntil: [\"load\", \"networkidle0\"], timeout: 30000 })\n\n    const pdf = await page.pdf({\n      preferCSSPageSize: true,\n      printBackground: true,\n      margin: { top: \"24px\", right: \"24px\", bottom: \"24px\", left: \"24px\" },\n      ...opts,\n    })\n\n    await page.close()\n    return Buffer.from(pdf)\n  } finally {\n    await browser.close()\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAMO,eAAe,sBAAsB,IAAY,EAAE,OAAyB,CAAC,CAAC;IACnF,MAAM,UAAU,MAAM,6HAAS,CAAC,MAAM,CAAC;QACrC,UAAU;QACV,MAAM;YACJ;YACA;YACA;YACA;YACA;YACA;SACD;QACD,gBAAgB,QAAQ,GAAG,CAAC,yBAAyB;IACvD;IAEA,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,OAAO;QAElC,qDAAqD;QACrD,MAAM,OAAO,KAAK,OAAO,IAAI,QAAQ,GAAG,CAAC,YAAY,IAAI;QACzD,IAAI,eAAe;QACnB,IAAI,eAAe,IAAI,CAAC,eAAe;YACrC,eAAe,aAAa,OAAO,CAAC,gBAAgB,CAAC,IAAM,GAAG,EAAE,YAAY,EAAE,KAAK,EAAE,CAAC;QACxF,OAAO;YACL,eAAe,CAAC,uCAAuC,EAAE,KAAK,uCAAuC,EAAE,KAAK,cAAc,CAAC;QAC7H;QAEA,MAAM,KAAK,UAAU,CAAC,cAAc;YAAE,WAAW;gBAAC;gBAAQ;aAAe;YAAE,SAAS;QAAM;QAE1F,MAAM,MAAM,MAAM,KAAK,GAAG,CAAC;YACzB,mBAAmB;YACnB,iBAAiB;YACjB,QAAQ;gBAAE,KAAK;gBAAQ,OAAO;gBAAQ,QAAQ;gBAAQ,MAAM;YAAO;YACnE,GAAG,IAAI;QACT;QAEA,MAAM,KAAK,KAAK;QAChB,OAAO,OAAO,IAAI,CAAC;IACrB,SAAU;QACR,MAAM,QAAQ,KAAK;IACrB;AACF","debugId":null}},
    {"offset": {"line": 633, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/prembly.ts"],"sourcesContent":["/**\r\n * Prembly API Client\r\n * Documentation: https://docs.prembly.com/docs/welcome-to-prembly-documentation\r\n */\r\n\r\nconst PREMBLY_BASE_URL = process.env.PREMBLY_BASE_URL || 'https://api.prembly.com';\r\n\r\ninterface PremblyConfig {\r\n  apiKey: string;\r\n  appId: string;\r\n}\r\n\r\ninterface PremblyResponse<T> {\r\n  status: boolean;\r\n  detail: string;\r\n  data?: T;\r\n  error?: string;\r\n}\r\n\r\n// NIN Service Types\r\ninterface NINPrintoutParams {\r\n  nin: string;\r\n}\r\n\r\ninterface NINSlipParams {\r\n  nin: string;\r\n}\r\n\r\ninterface NINAdvancedParams {\r\n  nin: string;\r\n  phoneNumber?: string;\r\n  firstName?: string;\r\n  lastName?: string;\r\n  dateOfBirth?: string;\r\n  gender?: string;\r\n}\r\n\r\n// BVN Service Types\r\ninterface BVNPrintoutParams {\r\n  bvn: string;\r\n}\r\n\r\ninterface BVNByPhoneParams {\r\n  phoneNumber: string;\r\n}\r\n\r\ninterface BVNAdvancedParams {\r\n  bvn: string;\r\n}\r\n\r\n// Phone number advanced\r\ninterface PhoneAdvancedParams {\r\n  phoneNumber: string;\r\n}\r\n\r\n// TIN Service Types\r\ninterface TINVerificationParams {\r\n  tin: string;\r\n}\r\n\r\n// Driver's License\r\ninterface DriversLicenseAdvancedParams {\r\n  licenseNumber?: string;\r\n  expiryDate?: string;\r\n  firstName?: string;\r\n  lastName?: string;\r\n  dob?: string;\r\n}\r\n\r\n// Voters Card\r\ninterface VotersCardParams {\r\n  number: string;\r\n  lastName?: string;\r\n  firstName?: string;\r\n  dob?: string;\r\n  lga?: string;\r\n  state?: string;\r\n}\r\n\r\n// CAC Service Types (Advance)\r\ninterface CACAdvanceParams {\r\n  // unified params aligning to Prembly Advance CAC\r\n  number: string; // RC or BN or IT number\r\n  companyType?: 'RC' | 'BN' | 'IT';\r\n  companyName?: string;\r\n}\r\n\r\n// International Passport\r\ninterface InternationalPassportV2Params {\r\n  passportNumber: string;\r\n  lastName?: string;\r\n}\r\n\r\n// Plate Number\r\ninterface PlateNumberParams {\r\n  plateNumber: string;\r\n}\r\n\r\n/**\r\n * Prembly API Client for identity verification services\r\n */\r\nexport class PremblyClient {\r\n  private apiKey: string;\r\n  private appId: string;\r\n  \r\n  constructor(config: PremblyConfig) {\r\n    this.apiKey = config.apiKey;\r\n    this.appId = config.appId;\r\n  }\r\n\r\n  private async makeRequest<T>(endpoint: string, method: string, data?: any): Promise<PremblyResponse<T>> {\r\n    try {\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        console.log('[Prembly] env check', {\r\n          baseUrl: PREMBLY_BASE_URL,\r\n          endpoint,\r\n          hasApiKey: !!this.apiKey,\r\n          hasAppId: !!this.appId,\r\n        })\r\n      }\r\n      const response = await fetch(`${PREMBLY_BASE_URL}${endpoint}`, {\r\n        method,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Accept': 'application/json',\r\n          'x-api-key': this.apiKey,\r\n          'app-id': this.appId,\r\n        },\r\n        body: data ? JSON.stringify(data) : undefined,\r\n      });\r\n\r\n      const contentType = response.headers.get('content-type') || '';\r\n      let result: any;\r\n      if (contentType.includes('application/json')) {\r\n        result = await response.json();\r\n      } else {\r\n        const text = await response.text();\r\n        throw new Error(`Unexpected response from Prembly (${response.status}): ${text.slice(0, 200)}...`);\r\n      }\r\n      \r\n      if (!response.ok) {\r\n        const msg = typeof result?.error === 'string' ? result.error\r\n          : typeof result?.detail === 'string' ? result.detail\r\n          : typeof result?.message === 'string' ? result.message\r\n          : 'Failed to process request';\r\n        throw new Error(msg);\r\n      }\r\n      \r\n      return result;\r\n    } catch (error: any) {\r\n      console.error('Prembly API Error:', error);\r\n      return {\r\n        status: false,\r\n        detail: error.message || 'An error occurred while processing your request',\r\n        error: error.message,\r\n      };\r\n    }\r\n  }\r\n\r\n  // NIN Services\r\n  async getNINPrintout(params: NINPrintoutParams) {\r\n    const payload: any = { number_nin: params.nin }\r\n    return this.makeRequest('/verification/vnin', 'POST', payload);\r\n  }\r\n\r\n  async getNINSlip(params: NINSlipParams) {\r\n    const payload: any = { number_nin: params.nin }\r\n    return this.makeRequest('/verification/vnin', 'POST', payload);\r\n  }\r\n\r\n  async getNINAdvanced(params: NINAdvancedParams) {\r\n    const payload: any = { number_nin: params.nin }\r\n    if (params.phoneNumber) payload.phone_number = params.phoneNumber\r\n    if (params.firstName) payload.first_name = params.firstName\r\n    if (params.lastName) payload.last_name = params.lastName\r\n    if (params.dateOfBirth) payload.date_of_birth = params.dateOfBirth\r\n    if (params.gender) payload.gender = params.gender\r\n    return this.makeRequest('/verification/vnin', 'POST', payload)\r\n  }\r\n\r\n  // BVN Services (use documented endpoints)\r\n  async getBVNPrintout(params: BVNPrintoutParams) {\r\n    const payload = { number: params.bvn } as any\r\n    return this.makeRequest('/verification/bvn', 'POST', payload);\r\n  }\r\n\r\n  async getBVNByPhone(params: BVNByPhoneParams) {\r\n    // Per docs: POST /verification/bvn_with_phone_advance with payload { phone_number }\r\n    const payload = { phone_number: params.phoneNumber } as any;\r\n    return this.makeRequest('/verification/bvn_with_phone_advance', 'POST', payload);\r\n  }\r\n\r\n  async getBVNAdvanced(params: BVNAdvancedParams) {\r\n    return this.makeRequest('/verification/bvn/advance', 'POST', params);\r\n  }\r\n\r\n  // Phone Number (Advanced)\r\n  async verifyPhoneAdvanced(params: PhoneAdvancedParams) {\r\n    const payload = { phone_number: params.phoneNumber } as any\r\n    return this.makeRequest('/verification/phone_number/advance', 'POST', payload)\r\n  }\r\n\r\n  // TIN\r\n  async verifyTIN(params: TINVerificationParams) {\r\n    return this.makeRequest('/verification/global/tin-check', 'POST', params);\r\n  }\r\n\r\n  // Driver's License (Advanced)\r\n  async verifyDriversLicenseAdvanced(params: DriversLicenseAdvancedParams) {\r\n    const payload: any = {}\r\n    if (params.licenseNumber) payload.license_number = params.licenseNumber\r\n    if (params.expiryDate) payload.expiry_date = params.expiryDate\r\n    if (params.firstName) payload.first_name = params.firstName\r\n    if (params.lastName) payload.last_name = params.lastName\r\n    if (params.dob) payload.dob = params.dob\r\n    return this.makeRequest('/verification/drivers_license/advance/v2', 'POST', payload)\r\n  }\r\n\r\n  // Voters Card\r\n  async verifyVotersCard(params: VotersCardParams) {\r\n    const payload: any = { number: params.number }\r\n    if (params.lastName) payload.last_name = params.lastName\r\n    if (params.firstName) payload.first_name = params.firstName\r\n    if (params.dob) payload.dob = params.dob\r\n    if (params.lga) payload.lga = params.lga\r\n    if (params.state) payload.state = params.state\r\n    return this.makeRequest('/verification/voters_card', 'POST', payload)\r\n  }\r\n\r\n  // CAC Services (Advance)\r\n  async getCACInfo(params: CACAdvanceParams) {\r\n    // Docs: POST /verification/cac/advance with rc_number, company_type, company_name\r\n    const payload: any = {}\r\n    if (params.number) payload.rc_number = String(params.number)\r\n    if (params.companyType) payload.company_type = String(params.companyType)\r\n    if (params.companyName) payload.company_name = String(params.companyName)\r\n    return this.makeRequest('/verification/cac/advance', 'POST', payload)\r\n  }\r\n\r\n  async getCACAdvanced(params: CACAdvanceParams) {\r\n    const payload: any = {}\r\n    if (params.number) payload.rc_number = String(params.number)\r\n    if (params.companyType) payload.company_type = String(params.companyType)\r\n    if (params.companyName) payload.company_name = String(params.companyName)\r\n    return this.makeRequest('/verification/cac/advance', 'POST', payload)\r\n  }\r\n\r\n  async getCACStatusReport(params: CACAdvanceParams) {\r\n    const payload: any = {}\r\n    if (params.number) payload.rc_number = String(params.number)\r\n    if (params.companyType) payload.company_type = String(params.companyType)\r\n    if (params.companyName) payload.company_name = String(params.companyName)\r\n    return this.makeRequest('/verification/cac/advance', 'POST', payload)\r\n  }\r\n\r\n  // International Passport v2\r\n  async verifyInternationalPassportV2(params: InternationalPassportV2Params) {\r\n    const payload: any = { passport_number: params.passportNumber }\r\n    if (params.lastName) payload.last_name = params.lastName\r\n    return this.makeRequest('/verification/national_passport_v2', 'POST', payload)\r\n  }\r\n\r\n  // Plate Number\r\n  async verifyPlateNumber(params: PlateNumberParams) {\r\n    const payload = { plate_number: params.plateNumber } as any\r\n    return this.makeRequest('/verification/vehicle', 'POST', payload)\r\n  }\r\n}\r\n\r\n// Create and export a singleton instance with environment variables\r\nexport const premblyClient = new PremblyClient({\r\n  apiKey: process.env.PREMBLY_API_KEY || '',\r\n  appId: process.env.PREMBLY_APP_ID || '',\r\n});\r\n\r\nexport default premblyClient;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 816, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/prembly-sdk-adapter.ts"],"sourcesContent":["import premblyHttpClient, { PremblyClient as HttpPremblyClient } from \"./prembly\"\n\n// Optional SDK imports. We keep usage minimal and fallback to HTTP client when unsupported.\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport { PremblyDataVerification, PremblyGeneralVerification, PremblyDocumentVerification, PremblyGlobalBusinessVerification } from \"prembly-pass\"\n\n// Shape normalization helper to keep the same response contract our routes expect\nfunction ok<T>(data: T, detail = \"OK\") {\n  return { status: true, detail, data }\n}\nfunction fail(message: string) {\n  return { status: false, detail: message, error: message }\n}\n\n// Singleton SDK instances (created lazily)\nlet dataVerification: any | null = null\nlet generalVerification: any | null = null\nlet documentVerification: any | null = null\nlet globalBusinessVerification: any | null = null\n\nfunction ensureSdkInstances() {\n  const apiKey = process.env.PREMBLY_API_KEY || \"\"\n  const appId = process.env.PREMBLY_APP_ID || \"\"\n  if (!apiKey || !appId) return false\n  try {\n    if (!dataVerification) dataVerification = new PremblyDataVerification(apiKey, appId)\n    if (!generalVerification) generalVerification = new PremblyGeneralVerification(apiKey, appId)\n    if (!documentVerification) documentVerification = new PremblyDocumentVerification(apiKey, appId)\n    if (!globalBusinessVerification) globalBusinessVerification = new PremblyGlobalBusinessVerification(apiKey, appId)\n    return true\n  } catch (e) {\n    return false\n  }\n}\n\n// Adapter exposing the same methods as our HTTP client. Unknowns fall back to HTTP client.\nconst sdkBackedClient: HttpPremblyClient & Record<string, any> = {\n  // Delegate to original HTTP client's private fields through the instance we import\n  ...(premblyHttpClient as any),\n\n  // Plate Number via SDK (Data Verification)\n  async verifyPlateNumber(params: { plateNumber: string }) {\n    try {\n      if (ensureSdkInstances()) {\n        const res = await dataVerification.verifyPlateNumber(params.plateNumber)\n        // Normalize into our standard response\n        return ok(res)\n      }\n    } catch (e: any) {\n      return fail(e?.message || String(e))\n    }\n    // Fallback to HTTP client\n    return premblyHttpClient.verifyPlateNumber(params)\n  },\n\n  // Everything else falls back to the HTTP client for now\n  async getBVNPrintout(params: any) { return premblyHttpClient.getBVNPrintout(params) },\n  async getBVNByPhone(params: any) { return premblyHttpClient.getBVNByPhone(params) },\n  async getBVNAdvanced(params: any) { return premblyHttpClient.getBVNAdvanced(params) },\n\n  async getNINPrintout(params: any) { return premblyHttpClient.getNINPrintout(params) },\n  async getNINSlip(params: any) { return premblyHttpClient.getNINSlip(params) },\n  async getNINAdvanced(params: any) { return premblyHttpClient.getNINAdvanced(params) },\n\n  async getCACInfo(params: any) { return premblyHttpClient.getCACInfo(params) },\n  async getCACAdvanced(params: any) { return premblyHttpClient.getCACAdvanced(params) },\n  async getCACStatusReport(params: any) { return premblyHttpClient.getCACStatusReport(params) },\n\n  async verifyInternationalPassportV2(params: any) { return premblyHttpClient.verifyInternationalPassportV2(params) },\n  async verifyTIN(params: any) { return premblyHttpClient.verifyTIN(params) },\n  async verifyVotersCard(params: any) { return premblyHttpClient.verifyVotersCard(params) },\n  async verifyPhoneAdvanced(params: any) { return premblyHttpClient.verifyPhoneAdvanced(params) },\n}\n\nexport function getPrembly() {\n  const useSdk = String(process.env.USE_PREMBLY_SDK || \"\").toLowerCase() === \"true\"\n  return useSdk ? (sdkBackedClient as HttpPremblyClient) : premblyHttpClient\n}\n\nexport default getPrembly"],"names":[],"mappings":";;;;;;AAAA;AAEA,4FAA4F;AAC5F,6DAA6D;AAC7D,aAAa;AACb;;;AAEA,kFAAkF;AAClF,SAAS,GAAM,IAAO,EAAE,SAAS,IAAI;IACnC,OAAO;QAAE,QAAQ;QAAM;QAAQ;IAAK;AACtC;AACA,SAAS,KAAK,OAAe;IAC3B,OAAO;QAAE,QAAQ;QAAO,QAAQ;QAAS,OAAO;IAAQ;AAC1D;AAEA,2CAA2C;AAC3C,IAAI,mBAA+B;AACnC,IAAI,sBAAkC;AACtC,IAAI,uBAAmC;AACvC,IAAI,6BAAyC;AAE7C,SAAS;IACP,MAAM,SAAS,QAAQ,GAAG,CAAC,eAAe,IAAI;IAC9C,MAAM,QAAQ,QAAQ,GAAG,CAAC,cAAc,IAAI;IAC5C,IAAI,CAAC,UAAU,CAAC,OAAO,OAAO;IAC9B,IAAI;QACF,IAAI,CAAC,kBAAkB,mBAAmB,IAAI,6KAAuB,CAAC,QAAQ;QAC9E,IAAI,CAAC,qBAAqB,sBAAsB,IAAI,gLAA0B,CAAC,QAAQ;QACvF,IAAI,CAAC,sBAAsB,uBAAuB,IAAI,iLAA2B,CAAC,QAAQ;QAC1F,IAAI,CAAC,4BAA4B,6BAA6B,IAAI,uLAAiC,CAAC,QAAQ;QAC5G,OAAO;IACT,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF;AAEA,2FAA2F;AAC3F,MAAM,kBAA2D;IAC/D,mFAAmF;IACnF,GAAI,2HAAiB;IAErB,2CAA2C;IAC3C,MAAM,mBAAkB,MAA+B;QACrD,IAAI;YACF,IAAI,sBAAsB;gBACxB,MAAM,MAAM,MAAM,iBAAiB,iBAAiB,CAAC,OAAO,WAAW;gBACvE,uCAAuC;gBACvC,OAAO,GAAG;YACZ;QACF,EAAE,OAAO,GAAQ;YACf,OAAO,KAAK,GAAG,WAAW,OAAO;QACnC;QACA,0BAA0B;QAC1B,OAAO,2HAAiB,CAAC,iBAAiB,CAAC;IAC7C;IAEA,wDAAwD;IACxD,MAAM,gBAAe,MAAW;QAAI,OAAO,2HAAiB,CAAC,cAAc,CAAC;IAAQ;IACpF,MAAM,eAAc,MAAW;QAAI,OAAO,2HAAiB,CAAC,aAAa,CAAC;IAAQ;IAClF,MAAM,gBAAe,MAAW;QAAI,OAAO,2HAAiB,CAAC,cAAc,CAAC;IAAQ;IAEpF,MAAM,gBAAe,MAAW;QAAI,OAAO,2HAAiB,CAAC,cAAc,CAAC;IAAQ;IACpF,MAAM,YAAW,MAAW;QAAI,OAAO,2HAAiB,CAAC,UAAU,CAAC;IAAQ;IAC5E,MAAM,gBAAe,MAAW;QAAI,OAAO,2HAAiB,CAAC,cAAc,CAAC;IAAQ;IAEpF,MAAM,YAAW,MAAW;QAAI,OAAO,2HAAiB,CAAC,UAAU,CAAC;IAAQ;IAC5E,MAAM,gBAAe,MAAW;QAAI,OAAO,2HAAiB,CAAC,cAAc,CAAC;IAAQ;IACpF,MAAM,oBAAmB,MAAW;QAAI,OAAO,2HAAiB,CAAC,kBAAkB,CAAC;IAAQ;IAE5F,MAAM,+BAA8B,MAAW;QAAI,OAAO,2HAAiB,CAAC,6BAA6B,CAAC;IAAQ;IAClH,MAAM,WAAU,MAAW;QAAI,OAAO,2HAAiB,CAAC,SAAS,CAAC;IAAQ;IAC1E,MAAM,kBAAiB,MAAW;QAAI,OAAO,2HAAiB,CAAC,gBAAgB,CAAC;IAAQ;IACxF,MAAM,qBAAoB,MAAW;QAAI,OAAO,2HAAiB,CAAC,mBAAmB,CAAC;IAAQ;AAChG;AAEO,SAAS;IACd,MAAM,SAAS,OAAO,QAAQ,GAAG,CAAC,eAAe,IAAI,IAAI,WAAW,OAAO;IAC3E,OAAO,SAAU,kBAAwC,2HAAiB;AAC5E;uCAEe","debugId":null}},
    {"offset": {"line": 933, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/app/api/pdf/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { requireAuth } from \"@/lib/require-auth\"\nimport { prisma } from \"@/lib/db\"\nimport { renderHtmlToPdfBuffer } from \"@/lib/pdf\"\nimport getPrembly from \"@/lib/prembly-sdk-adapter\"\n\n// POST /api/pdf\n// Body: { templateId: string, action: string, params: Record<string, any>, fileName?: string }\n// - templateId: NinTemplate.id (HTML with placeholders like {{firstName}})\n// - action: one of the unified verification actions handled by /api/verification\n// - params: payload for the selected action\nexport async function POST(req: NextRequest) {\n  try {\n    const auth = await requireAuth(req, { roles: [\"ADMIN\", \"AGENT\", \"USER\"] })\n    if (!auth.ok) return auth.response\n\n    const reqBody = await req.json().catch(() => ({}))\n    const { templateId, action, params, fileName, data: directData } = reqBody || {}\n    if (process.env.NODE_ENV !== \"production\") {\n      try {\n        console.log(\"[PDF] request\", {\n          action,\n          templateId,\n          hasDirectData: !!directData,\n          paramsKeys: params && typeof params === \"object\" ? Object.keys(params) : []\n        })\n      } catch { }\n    }\n\n    if (!templateId || typeof templateId !== \"string\") {\n      return NextResponse.json({ error: \"Missing templateId\" }, { status: 400 })\n    }\n    if (!action || typeof action !== \"string\") {\n      return NextResponse.json({ error: \"Missing action\" }, { status: 400 })\n    }\n\n    // Fetch template\n    const tpl = await prisma.ninTemplate.findUnique({ where: { id: templateId } })\n    if (!tpl || !tpl.isActive) {\n      return NextResponse.json({ error: \"Template not found or inactive\" }, { status: 404 })\n    }\n\n    const premblyClient = getPrembly()\n\n    // If direct verification data provided, skip upstream call\n    let result: any\n    let data: any = null\n    if (directData && typeof directData === \"object\") {\n      result = { status: true, data: directData }\n      data = directData\n    } else {\n      // Call Prembly via our client based on action (reusing mapping in /api/verification)\n      switch (action) {\n        case \"bvn.printout\":\n          result = await premblyClient.getBVNPrintout({ bvn: String(params?.bvn || \"\") })\n          break\n        case \"bvn.retrieval_phone\":\n          result = await premblyClient.getBVNByPhone({ phoneNumber: String(params?.phoneNumber || \"\") })\n          break\n        case \"bvn.advanced\":\n          result = await premblyClient.getBVNAdvanced({ bvn: String(params?.bvn || \"\") })\n          break\n        case \"nin.printout\":\n          result = await premblyClient.getNINPrintout({ nin: String(params?.nin || \"\") })\n          break\n        case \"nin.slip\":\n          result = await premblyClient.getNINSlip({ nin: String(params?.nin || \"\") })\n          break\n        case \"nin.advanced\":\n          result = await premblyClient.getNINAdvanced({\n            nin: String(params?.nin || \"\"),\n            phoneNumber: params?.phoneNumber,\n            firstName: params?.firstName,\n            lastName: params?.lastName,\n            dateOfBirth: params?.dateOfBirth,\n            gender: params?.gender,\n          })\n          break\n        case \"cac.info\":\n          result = await premblyClient.getCACInfo({\n            number: String(params?.number ?? params?.rcNumber ?? \"\"),\n            companyType: params?.companyType ? String(params.companyType).toUpperCase() as any : undefined,\n            companyName: params?.companyName ? String(params.companyName) : undefined,\n          })\n          break\n        case \"cac.status\":\n          result = await premblyClient.getCACStatusReport({\n            number: String(params?.number ?? params?.rcNumber ?? \"\"),\n            companyType: params?.companyType ? String(params.companyType).toUpperCase() as any : undefined,\n            companyName: params?.companyName ? String(params.companyName) : undefined,\n          })\n          break\n        case \"passport.verify\":\n          result = await premblyClient.verifyInternationalPassportV2({\n            passportNumber: String(params?.passportNumber || \"\"),\n            lastName: params?.lastName,\n          })\n          break\n        case \"tin.verify\":\n          result = await premblyClient.verifyTIN({ tin: String(params?.tin || \"\") })\n          break\n        case \"voters.verify\":\n          result = await premblyClient.verifyVotersCard({\n            number: String(params?.number ?? params?.vin ?? \"\"),\n            lastName: params?.lastName ? String(params.lastName) : undefined,\n            firstName: params?.firstName ? String(params.firstName) : undefined,\n            dob: params?.dob ? String(params.dob) : undefined,\n            lga: params?.lga ? String(params.lga) : undefined,\n            state: params?.state ? String(params.state) : undefined,\n          })\n          break\n        case \"plate.verify\":\n          result = await premblyClient.verifyPlateNumber({ plateNumber: String(params?.plateNumber || \"\") })\n          break\n        case \"phone.verify_advanced\":\n          result = await premblyClient.verifyPhoneAdvanced({ phoneNumber: String(params?.phoneNumber || \"\") })\n          break\n        case \"drivers_license.verify\":\n          result = await premblyClient.verifyDriversLicenseAdvanced({\n            licenseNumber: params?.licenseNumber ? String(params.licenseNumber) : undefined,\n            expiryDate: params?.expiryDate ? String(params.expiryDate) : undefined,\n            firstName: params?.firstName ? String(params.firstName) : undefined,\n            lastName: params?.lastName ? String(params.lastName) : undefined,\n            dob: params?.dob ? String(params.dob) : undefined,\n          })\n          break\n        default:\n          return NextResponse.json({ error: `Unsupported action: ${action}` }, { status: 400 })\n      }\n\n      if (!result?.status) {\n        return NextResponse.json({ error: result?.detail || result?.error || \"Upstream verification failed\" }, { status: 400 })\n      }\n\n      if (process.env.NODE_ENV !== \"production\") {\n        try {\n          console.log(\"[PDF] upstream status\", { status: !!result?.status, detail: result?.detail || result?.error })\n        } catch { }\n      }\n\n      // Create a simple placeholder substitution from templateContent\n      data = result?.data || (result as any)?.result || {}\n    }\n    if (data && typeof data === \"object\") {\n      if ((data as any).data) data = (data as any).data\n      if ((data as any).nin_data) data = (data as any).nin_data\n    }\n    if (process.env.NODE_ENV !== \"production\") {\n      try {\n        const src: any = data || {}\n        const rawImg = src.photo || src.image || src.imageUrl || src.base64Image || src.image_base64 || src.imageBase64 || src.photo_base64 || src.photoBase64 || \"\"\n        const head = typeof rawImg === \"string\" ? String(rawImg).slice(0, 120) : \"\"\n        console.log(\"[PDF] data keys\", Object.keys(src))\n        console.log(\"[PDF] data image preview\", head)\n      } catch { }\n    }\n    const aliases: Record<string, any> = {}\n    if (action.startsWith(\"nin.\")) {\n      const src = data || {}\n      const firstName = src.first_name || src.firstname || src.firstName || src.given_names || src.givenNames || src.given_name || \"\"\n      const lastName = src.last_name || src.lastname || src.lastName || src.surname || \"\"\n      const middleName = src.middle_name || src.middlename || src.middleName || src.other_names || src.otherNames || \"\"\n      const givenNames = src.given_names || src.givenNames || [firstName, middleName].filter(Boolean).join(\" \")\n      const sex = src.sex || src.gender || \"\"\n      const gender = src.gender || src.sex || \"\"\n      const nin = src.nin || src.nin_number || src.ninNumber || \"\"\n      const address = src.address || src.residential_address || src.homeAddress || src.residentialAddress || \"\"\n      const trackingId = src.tracking_id || src.trackingId || src.nimc_trackingId || \"\"\n      const phoneNumber = src.phone_number || src.phoneNumber || src.msisdn || src.telephoneno || \"\"\n      const residenceState = src.residence_state || src.stateOfResidence || src.residential_state || \"\"\n      const residenceTown = src.residence_town || src.residence_lga || src.lga || src.lgaOfResidence || \"\"\n      const birthState = src.birth_state || src.stateOfOrigin || src.state_of_origin || src.birthstate || \"\"\n      const birthLga = src.birth_lga || src.lgaOfOrigin || src.lga_of_origin || src.birthlga || \"\"\n      let image = src.photo || src.photoUrl || src.image || src.imageUrl || src.base64Image || src.image_base64 || src.imageBase64 || src.photo_base64 || src.photoBase64 || \"\"\n      const _imgRaw = typeof image === \"string\" ? String(image) : \"\"\n      const _imgCompact = _imgRaw.replace(/\\s+/g, \"\").trim()\n      image = _imgCompact || image\n      const looksLikeDataUrl = typeof image === \"string\" && /^data:image\\/(png|jpeg|jpg);base64,/i.test(String(image))\n      const looksLikeHttp = typeof image === \"string\" && /^(https?:\\/\\/|\\/)/i.test(String(image))\n      const base64Candidate = typeof image === \"string\" && !looksLikeDataUrl && !looksLikeHttp && /^[A-Za-z0-9+/=]+$/.test(String(image)) && String(image).length > 30\n      if (base64Candidate) {\n        const raw = String(image)\n        const isPng = /^iVBOR/.test(raw)\n        const isJpg = /^\\/9j\\//.test(raw)\n        const mime = isPng ? \"image/png\" : \"image/jpeg\"\n        image = `data:${mime};base64,${raw}`\n      } else if (!image && typeof src.photo === \"string\" && src.photo.length > 30) {\n        const raw = String(src.photo).replace(/\\s+/g, \"\").trim()\n        const isPng = /^iVBOR/.test(raw)\n        const mime = isPng ? \"image/png\" : \"image/jpeg\"\n        image = `data:${mime};base64,${raw}`\n      } else if (!image && typeof src.base64Image === \"string\" && src.base64Image.length > 30) {\n        const raw = String(src.base64Image).replace(/\\s+/g, \"\").trim()\n        const isPng = /^iVBOR/.test(raw)\n        const mime = isPng ? \"image/png\" : \"image/jpeg\"\n        image = `data:${mime};base64,${raw}`\n      } else if (!image && typeof src.image_base64 === \"string\" && src.image_base64.length > 30) {\n        const raw = String(src.image_base64).replace(/\\s+/g, \"\").trim()\n        const isPng = /^iVBOR/.test(raw)\n        const mime = isPng ? \"image/png\" : \"image/jpeg\"\n        image = `data:${mime};base64,${raw}`\n      } else if (!image && typeof src.imageBase64 === \"string\" && src.imageBase64.length > 30) {\n        const raw = String(src.imageBase64).replace(/\\s+/g, \"\").trim()\n        const isPng = /^iVBOR/.test(raw)\n        const mime = isPng ? \"image/png\" : \"image/jpeg\"\n        image = `data:${mime};base64,${raw}`\n      }\n      if (!image) {\n        const pick = (v: any) => {\n          const s = typeof v === \"string\" ? String(v).replace(/\\s+/g, \"\").trim() : \"\"\n          const isDataUrl = /^data:image\\/(png|jpeg|jpg);base64,/i.test(s)\n          const isHttp = /^(https?:\\/\\/|\\/)/i.test(s)\n          const isBase64 = !isDataUrl && !isHttp && /^[A-Za-z0-9+/=]+$/.test(s) && s.length > 30\n          if (isDataUrl || isHttp) return s\n          if (isBase64) {\n            const isPng = /^iVBOR/.test(s)\n            const mime = isPng ? \"image/png\" : \"image/jpeg\"\n            return `data:${mime};base64,${s}`\n          }\n          return \"\"\n        }\n        for (const [k, v] of Object.entries(src)) {\n          if (!image && typeof v === \"string\" && /(image|photo|portrait)/i.test(k)) {\n            const cand = pick(v)\n            if (cand) { image = cand; break }\n          } else if (!image && v && typeof v === \"object\") {\n            for (const [k2, v2] of Object.entries(v as any)) {\n              if (typeof v2 === \"string\" && /(image|photo|portrait|base64)/i.test(k2)) {\n                const cand2 = pick(v2)\n                if (cand2) { image = cand2; break }\n              }\n            }\n          }\n        }\n      }\n      const issueDate = src.issue_date || src.issueDate || new Date().toISOString().slice(0, 10)\n      let qrCode = src.qr_code || src.qrCode || \"\"\n      const email = src.email || \"\"\n      const employmentStatus = src.employmentstatus || src.employment_status || \"\"\n      const maritalStatus = src.maritalstatus || src.marital_status || \"\"\n      const educationalLevel = src.educationallevel || src.education_level || \"\"\n      const birthCountry = src.birthcountry || src.birth_country || \"\"\n      const height = src.heigth || src.height || \"\"\n      const parentFirstName = src.pfirstname || src.parent_firstname || \"\"\n      const spokenLanguage = src.ospokenlang || src.spoken_language || \"\"\n      const centralId = src.centralID || src.central_id || \"\"\n      const nokFirst = src.nok_firstname || \"\"\n      const nokMiddle = src.nok_middlename || \"\"\n      const nokSurname = src.nok_surname || \"\"\n      const nokAddress1 = src.nok_address1 || \"\"\n      const nokAddress2 = src.nok_address2 || \"\"\n      const nokState = src.nok_state || \"\"\n      const nokLgaTown = src.nok_town || src.nok_lga || \"\"\n      const nokPostalCode = src.nok_postalcode || \"\"\n      aliases.surname = lastName\n      aliases.first_name = firstName\n      aliases.middle_name = middleName\n      aliases.given_names = givenNames\n      aliases.sex = sex\n      aliases.gender = gender\n      aliases.nin = nin\n      const dobRaw = src.birthdate || src.date_of_birth || src.dob || src.dateOfBirth || \"\"\n      const fmtDate = (v: any) => {\n        const s = String(v || \"\").trim()\n        if (!s) return \"\"\n        let d: Date | null = null\n        if (/^\\d{4}-\\d{2}-\\d{2}/.test(s)) {\n          d = new Date(s)\n        } else if (/^\\d{2}[\\/-]\\d{2}[\\/-]\\d{4}$/.test(s)) {\n          const [a, b, c] = s.split(/[\\/-]/).map(Number)\n          d = new Date(c, (b || 1) - 1, a)\n        } else if (!isNaN(Date.parse(s))) {\n          d = new Date(Date.parse(s))\n        }\n        if (!d || isNaN(d.getTime())) return s\n        const months = [\"JAN\", \"FEB\", \"MAR\", \"APR\", \"MAY\", \"JUN\", \"JUL\", \"AUG\", \"SEP\", \"OCT\", \"NOV\", \"DEC\"]\n        const dd = String(d.getDate()).padStart(2, \"0\")\n        const mmm = months[d.getMonth()] || \"\"\n        const yyyy = d.getFullYear()\n        return `${dd} ${mmm} ${yyyy}`\n      }\n      aliases.dob = fmtDate(dobRaw)\n      const ninDigits = String(nin || \"\").replace(/\\D+/g, \"\")\n      const ninSpaced = ninDigits.length === 11 ? `${ninDigits.slice(0, 4)} ${ninDigits.slice(4, 7)} ${ninDigits.slice(7)}` : nin\n      aliases.nin_spaced = ninSpaced\n      aliases.address = address\n      aliases.image = image\n      aliases.photo = \"\"\n      aliases.imageUrl = \"\"\n      aliases.photoUrl = \"\"\n      if (typeof image === \"string\" && /^data:image\\/(png|jpeg|jpg);base64,/i.test(String(image))) {\n        aliases.base64Image = image.replace(/^data:image\\/(png|jpeg|jpg);base64,/i, \"\").replace(/\\s+/g, \"\")\n      } else if (typeof image === \"string\" && /^[A-Za-z0-9+/=]+$/.test(String(image)) && String(image).length > 50) {\n        aliases.base64Image = String(image).replace(/\\s+/g, \"\").trim()\n        aliases.image = `data:image/jpeg;base64,${aliases.base64Image}`\n        aliases.photo = \"\"\n        aliases.imageUrl = \"\"\n        aliases.photoUrl = \"\"\n      }\n      try {\n        if (typeof aliases.image === \"string\" && aliases.image) {\n          (data as any).image = aliases.image\n            ; (data as any).photo = aliases.image\n            ; (data as any).imageUrl = aliases.image\n            ; (data as any).photoUrl = aliases.image\n        }\n      } catch { }\n      if (process.env.NODE_ENV !== \"production\") {\n        try {\n          const imh = typeof aliases.image === \"string\" ? String(aliases.image).slice(0, 120) : \"\"\n          const b64len = typeof aliases.base64Image === \"string\" ? String(aliases.base64Image).length : 0\n          console.log(\"[PDF] nin aliases\", { imageHead: imh, base64Len: b64len, qr: !!aliases.qr_code })\n        } catch { }\n      }\n      aliases.tracking_id = trackingId\n      aliases.trackingId = trackingId\n      aliases.phone_number = phoneNumber\n      aliases.phoneNumber = phoneNumber\n      aliases.residence_state = residenceState\n      aliases.residence_town = residenceTown\n      aliases.birth_state = birthState\n      aliases.birth_lga = birthLga\n      aliases.issue_date = fmtDate(issueDate)\n      // Fallback QR generation if missing\n      if (!qrCode) {\n        try {\n          const payload = JSON.stringify({\n            nin,\n            surname: lastName,\n            given_names: givenNames,\n            dob: aliases.dob || src.birthdate || src.date_of_birth || src.dob || src.dateOfBirth || \"\",\n            issue_date: issueDate,\n          })\n          const url = `https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=${encodeURIComponent(payload)}`\n          const resp = await fetch(url)\n          if (resp.ok) {\n            const buf = Buffer.from(await resp.arrayBuffer())\n            qrCode = `data:image/png;base64,${buf.toString(\"base64\")}`\n          }\n        } catch { }\n      }\n      aliases.qr_code = qrCode\n      aliases.email = email\n      aliases.employment_status = employmentStatus\n      aliases.marital_status = maritalStatus\n      aliases.educational_level = educationalLevel\n      aliases.birth_country = birthCountry\n      aliases.height = height\n      aliases.parent_first_name = parentFirstName\n      aliases.spoken_language = spokenLanguage\n      aliases.central_id = centralId\n      aliases.nok_firstname = nokFirst\n      aliases.nok_middlename = nokMiddle\n      aliases.nok_surname = nokSurname\n      aliases.nok_address1 = nokAddress1\n      aliases.nok_address2 = nokAddress2\n      aliases.nok_state = nokState\n      aliases.nok_lga_town = nokLgaTown\n      aliases.nok_postalcode = nokPostalCode\n      try {\n        const rawImage = src.image || src.photo || src.imageUrl || src.photoUrl || src.base64Image || src.image_base64 || src.imageBase64 || src.photo_base64 || src.photoBase64 || \"\"\n        const rawPreview = typeof rawImage === \"string\" ? rawImage.slice(0, 120) : \"\"\n        const finalPreview = typeof aliases.image === \"string\" ? String(aliases.image).slice(0, 120) : \"\"\n        console.log(\"[PDF] NIN debug\", {\n          action,\n          hasData: !!data,\n          dataKeys: Object.keys(src || {}),\n          rawImagePreview: rawPreview,\n          finalImagePreview: finalPreview,\n          hasQr: !!aliases.qr_code,\n        })\n      } catch { }\n    } else if (action.startsWith(\"bvn.\")) {\n      const src = data || {}\n      const firstName = src.first_name || src.firstName || \"\"\n      const lastName = src.last_name || src.lastName || \"\"\n      const middleName = src.middle_name || src.middleName || src.other_names || src.otherNames || src.middleName || \"\"\n      const fullName = src.full_name || src.fullName || [firstName, middleName, lastName].filter(Boolean).join(\" \")\n      const bvn = src.bvn || src.number || src.bvn_number || \"\"\n      const dob = src.date_of_birth || src.dob || src.birth_date || src.dateOfBirth || \"\"\n      const phone = src.phone_number || src.phoneNumber || src.phoneNumber1 || src.phoneNumber2 || \"\"\n      const gender = src.gender || src.sex || \"\"\n      const email = src.email || \"\"\n      const enrollmentBank = src.enrollment_bank || src.enrollmentBank || \"\"\n      const enrollmentBranch = src.enrollment_branch || src.enrollmentBranch || \"\"\n      const registrationDate = src.registration_date || src.registrationDate || \"\"\n      const residentialAddress = src.residential_address || src.residentialAddress || \"\"\n      const stateOfResidence = src.state_of_residence || src.stateOfResidence || \"\"\n      const nin = src.nin || src.nin_number || src.ninNumber || \"\"\n      let image = src.photo || src.photoUrl || src.image || src.imageUrl || \"\"\n      if (!image && src.base64Image) {\n        image = `data:image/jpeg;base64,${String(src.base64Image)}`\n      }\n      aliases.first_name = firstName\n      aliases.middle_name = middleName\n      aliases.last_name = lastName\n      aliases.surname = lastName\n      aliases.full_name = fullName\n      aliases.bvn = bvn\n      aliases.nin = nin\n      aliases.dob = dob\n      aliases.phone_number = phone\n      aliases.phoneNumber = phone\n      aliases.gender = gender\n      aliases.email = email\n      aliases.enrollment_bank = enrollmentBank\n      aliases.enrollment_branch = enrollmentBranch\n      aliases.registration_date = registrationDate\n      aliases.residential_address = residentialAddress\n      aliases.state_of_residence = stateOfResidence\n\n      // Format Issue Date\n      const today = new Date()\n      const months = [\"JAN\", \"FEB\", \"MAR\", \"APR\", \"MAY\", \"JUN\", \"JUL\", \"AUG\", \"SEP\", \"OCT\", \"NOV\", \"DEC\"]\n      aliases.issue_date = `${today.getDate().toString().padStart(2, \"0\")}-${months[today.getMonth()]}-${today.getFullYear()}`\n\n      aliases.image = image\n      aliases.base64Image = src.base64Image || \"\"\n      aliases[\"data.bvn\"] = bvn\n      aliases[\"data.nin\"] = nin\n      aliases[\"data.firstName\"] = firstName\n      aliases[\"data.lastName\"] = lastName\n      aliases[\"data.middleName\"] = middleName\n      aliases[\"data.gender\"] = gender\n      aliases[\"data.email\"] = email\n      aliases[\"data.enrollmentBank\"] = enrollmentBank\n      aliases[\"data.enrollmentBranch\"] = enrollmentBranch\n      aliases[\"data.registrationDate\"] = registrationDate\n      aliases[\"data.residentialAddress\"] = residentialAddress\n      aliases[\"data.stateOfResidence\"] = stateOfResidence\n    } else if (action.startsWith(\"voters.\")) {\n      const src = data || {}\n      const firstName = src.first_name || src.firstName || \"\"\n      const lastName = src.last_name || src.lastName || \"\"\n      const fullName = src.full_name || `${firstName} ${lastName}`.trim()\n      const vin = src.number || src.votersCardNumber || src.vin || (params?.number || params?.vin || \"\")\n      const dob = src.dob || src.date_of_birth || src.dateOfBirth || \"\"\n      const gender = src.gender || src.sex || \"\"\n      const state = src.state || src.residence_state || (params?.state || \"\")\n      const lga = src.lga || src.residence_town || src.residence_lga || (params?.lga || \"\")\n      let address = src.address || src.residential_address || \"\"\n      if (!address) address = [lga, state].filter(Boolean).join(\", \")\n      let photo = src.photo || src.photoUrl || src.image || src.imageUrl || \"\"\n      const looksLikeDataUrl2 = typeof photo === \"string\" && /^data:image\\/(png|jpeg);base64,/i.test(String(photo))\n      const looksLikeHttp2 = typeof photo === \"string\" && /^(https?:\\/\\/|\\/)/i.test(String(photo))\n      const base64Candidate2 = typeof photo === \"string\" && !looksLikeDataUrl2 && !looksLikeHttp2 && /^[A-Za-z0-9+/=]+$/.test(String(photo).trim()) && String(photo).length > 100\n      if (base64Candidate2) photo = `data:image/jpeg;base64,${String(photo).trim()}`\n      aliases.first_name = firstName\n      aliases.last_name = lastName\n      aliases.full_name = fullName\n      aliases.vin = vin\n      aliases.number = vin\n      aliases.dob = dob\n      aliases.gender = gender\n      aliases.state = state\n      aliases.lga = lga\n      aliases.address = address\n      aliases.photo = photo\n    }\n\n    // Common aliases\n    aliases.generated_at = new Date().toLocaleString()\n    let html = tpl.templateContent\n    html = html.replace(/\\{\\{\\s*([a-zA-Z0-9_\\.]+)\\s*\\}\\}/g, (_, key) => {\n      const path = String(key)\n      const val = path.split(\".\").reduce<any>((acc, k) => (acc && acc[k] !== undefined ? acc[k] : undefined), data)\n        ?? (aliases[path] !== undefined ? aliases[path] : undefined)\n      return (val !== undefined && val !== null) ? String(val) : \"\"\n    })\n    if (process.env.NODE_ENV !== \"production\") {\n      try {\n        console.log(\"[PDF] html has data:image\", /data:image\\/(png|jpeg|jpg);base64,/.test(html))\n      } catch { }\n    }\n\n    // Normalize paths and relative asset URLs to absolute using request origin\n    try {\n      const origin = req.nextUrl?.origin || \"\"\n      if (origin) {\n        // Convert any backslashes to forward slashes in HTML paths\n        html = html.replace(/\\\\+/g, \"/\")\n        html = html.replace(/(<img\\s+[^>]*src=[\"'])\\/(?!\\/)([^\"']+)([\"'][^>]*>)/gi, `$1${origin}/$2$3`)\n      }\n    } catch { }\n\n    const pdf = await renderHtmlToPdfBuffer(html)\n    const defaultBase = (() => {\n      switch (String(action)) {\n        case \"bvn.retrieval_phone\":\n          return \"bvn-by-phone-printout\"\n        case \"bvn.printout\":\n          return \"bvn-printout\"\n        default:\n          return `${action}-slip`\n      }\n    })()\n    const fname = (fileName && typeof fileName === \"string\" ? fileName : `${defaultBase}-${Date.now()}`).replace(/[^a-zA-Z0-9._-]+/g, \"-\")\n\n    const pdfBody = (pdf instanceof Buffer) ? new Uint8Array(pdf) : pdf\n    return new NextResponse(pdfBody as any, {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/pdf\",\n        \"Content-Disposition\": `attachment; filename=\"${fname}.pdf\"`,\n      },\n    })\n  } catch (err: any) {\n    return NextResponse.json({ error: \"Failed to generate PDF\", detail: String(err?.message || err) }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}