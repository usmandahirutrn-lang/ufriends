{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/components/layout/DashboardLayout.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DashboardLayout = registerClientReference(\n    function() { throw new Error(\"Attempted to call DashboardLayout() from the server but DashboardLayout is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/layout/DashboardLayout.tsx <module evaluation>\",\n    \"DashboardLayout\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,kBAAkB,IAAA,wQAAuB,EAClD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,uEACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/components/layout/DashboardLayout.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DashboardLayout = registerClientReference(\n    function() { throw new Error(\"Attempted to call DashboardLayout() from the server but DashboardLayout is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/layout/DashboardLayout.tsx\",\n    \"DashboardLayout\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,kBAAkB,IAAA,wQAAuB,EAClD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,mDACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 32, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient | undefined }\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: [\"error\", \"warn\"],\n  })\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAO;AACxB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 214, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/security.ts"],"sourcesContent":["import arcjet, { shield, validateEmail, detectBot, fixedWindow } from \"@arcjet/next\"\n\ntype AJInstance = ReturnType<typeof arcjet> | null\n\n// Create a shared Arcjet instance with common rules.\n// In development, ARCJET_KEY may be missing, so we fail open.\nexport const aj: AJInstance = process.env.ARCJET_KEY\n  ? arcjet({\n    key: process.env.ARCJET_KEY!,\n    rules: [\n      shield({ mode: \"LIVE\" }),\n      detectBot({ mode: \"LIVE\", allow: [\"CATEGORY:SEARCH_ENGINE\", \"CATEGORY:MONITOR\", \"CATEGORY:PREVIEW\"] }),\n      fixedWindow({ mode: \"LIVE\", window: \"60s\", max: 100 }),\n    ],\n  })\n  : null\n\n// Email-validation instance for routes that need email context\nexport const ajWithEmail: AJInstance = process.env.ARCJET_KEY\n  ? arcjet({\n    key: process.env.ARCJET_KEY!,\n    rules: [\n      shield({ mode: \"LIVE\" }),\n      detectBot({ mode: \"LIVE\", allow: [\"CATEGORY:SEARCH_ENGINE\", \"CATEGORY:MONITOR\", \"CATEGORY:PREVIEW\"] }),\n      fixedWindow({ mode: \"LIVE\", window: \"60s\", max: 100 }),\n      validateEmail({ mode: \"LIVE\", deny: [\"DISPOSABLE\", \"INVALID\", \"NO_MX_RECORDS\"] }),\n    ],\n  })\n  : null\n\nexport async function protect(req: Request, opts?: { email?: string }) {\n  if (!aj) return { allowed: true }\n  try {\n    const decision = await (opts?.email && ajWithEmail\n      ? (ajWithEmail as any).protect(req as any, { email: opts.email })\n      : (aj as any).protect(req as any))\n    if (decision?.isDenied?.()) return { allowed: false }\n    return { allowed: true }\n  } catch {\n    // Fail open in dev\n    return { allowed: true }\n  }\n}"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;;AAMO,MAAM,KAAiB,QAAQ,GAAG,CAAC,UAAU,GAChD,IAAA,oKAAM,EAAC;IACP,KAAK,QAAQ,GAAG,CAAC,UAAU;IAC3B,OAAO;QACL,IAAA,yIAAM,EAAC;YAAE,MAAM;QAAO;QACtB,IAAA,4IAAS,EAAC;YAAE,MAAM;YAAQ,OAAO;gBAAC;gBAA0B;gBAAoB;aAAmB;QAAC;QACpG,IAAA,8IAAW,EAAC;YAAE,MAAM;YAAQ,QAAQ;YAAO,KAAK;QAAI;KACrD;AACH,KACE;AAGG,MAAM,cAA0B,QAAQ,GAAG,CAAC,UAAU,GACzD,IAAA,oKAAM,EAAC;IACP,KAAK,QAAQ,GAAG,CAAC,UAAU;IAC3B,OAAO;QACL,IAAA,yIAAM,EAAC;YAAE,MAAM;QAAO;QACtB,IAAA,4IAAS,EAAC;YAAE,MAAM;YAAQ,OAAO;gBAAC;gBAA0B;gBAAoB;aAAmB;QAAC;QACpG,IAAA,8IAAW,EAAC;YAAE,MAAM;YAAQ,QAAQ;YAAO,KAAK;QAAI;QACpD,IAAA,gJAAa,EAAC;YAAE,MAAM;YAAQ,MAAM;gBAAC;gBAAc;gBAAW;aAAgB;QAAC;KAChF;AACH,KACE;AAEG,eAAe,QAAQ,GAAY,EAAE,IAAyB;IACnE,IAAI,CAAC,IAAI,OAAO;QAAE,SAAS;IAAK;IAChC,IAAI;QACF,MAAM,WAAW,MAAM,CAAC,MAAM,SAAS,cACnC,AAAC,YAAoB,OAAO,CAAC,KAAY;YAAE,OAAO,KAAK,KAAK;QAAC,KAC7D,AAAC,GAAW,OAAO,CAAC,IAAW;QACnC,IAAI,UAAU,cAAc,OAAO;YAAE,SAAS;QAAM;QACpD,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAM;QACN,mBAAmB;QACnB,OAAO;YAAE,SAAS;QAAK;IACzB;AACF","debugId":null}},
    {"offset": {"line": 306, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/validation.ts"],"sourcesContent":["import { z } from \"zod\"\nimport { ZodXssSanitizer, ACTION_LEVELS } from \"zod-xss-sanitizer\"\n\n// Shared XSS sanitizer instance\nexport const sanitizer = ZodXssSanitizer.sanitizer({ actionLevel: ACTION_LEVELS.SANITIZE })\n\nexport function sanitizeEmail(input: string) {\n  return sanitizer.parse(z.string().trim().toLowerCase().email().parse(input))\n}\n\nexport function sanitizeString(input: string) {\n  return sanitizer.parse(z.string().trim().min(1).parse(input))\n}\n\nexport function sanitizePhone(input: string) {\n  const schema = z.string().trim().regex(/^\\+?[0-9]{10,15}$/i, { message: \"Invalid phone\" })\n  return sanitizer.parse(schema.parse(input))\n}\n\nexport function isValidUrl(input: string) {\n  const res = z.string().url().safeParse(input)\n  return res.success\n}"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;AAGO,MAAM,YAAY,4KAAe,CAAC,SAAS,CAAC;IAAE,aAAa,0KAAa,CAAC,QAAQ;AAAC;AAElF,SAAS,cAAc,KAAa;IACzC,OAAO,UAAU,KAAK,CAAC,uKAAC,CAAC,MAAM,GAAG,IAAI,GAAG,WAAW,GAAG,KAAK,GAAG,KAAK,CAAC;AACvE;AAEO,SAAS,eAAe,KAAa;IAC1C,OAAO,UAAU,KAAK,CAAC,uKAAC,CAAC,MAAM,GAAG,IAAI,GAAG,GAAG,CAAC,GAAG,KAAK,CAAC;AACxD;AAEO,SAAS,cAAc,KAAa;IACzC,MAAM,SAAS,uKAAC,CAAC,MAAM,GAAG,IAAI,GAAG,KAAK,CAAC,sBAAsB;QAAE,SAAS;IAAgB;IACxF,OAAO,UAAU,KAAK,CAAC,OAAO,KAAK,CAAC;AACtC;AAEO,SAAS,WAAW,KAAa;IACtC,MAAM,MAAM,uKAAC,CAAC,MAAM,GAAG,GAAG,GAAG,SAAS,CAAC;IACvC,OAAO,IAAI,OAAO;AACpB","debugId":null}},
    {"offset": {"line": 345, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/lib/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\"\nimport type { NextAuthOptions } from \"next-auth\"\nimport Credentials from \"next-auth/providers/credentials\"\nimport { prisma } from \"@/lib/db\"\nimport bcrypt from \"bcryptjs\"\nimport { protect } from \"@/lib/security\"\nimport Joi from \"joi\"\nimport { sanitizer } from \"@/lib/validation\"\n\nconst isProd = process.env.NODE_ENV === \"production\"\n\nexport const authOptions: NextAuthOptions = {\n  session: { strategy: \"jwt\" },\n  providers: [\n    Credentials({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Email\", type: \"email\" },\n        password: { label: \"Password\", type: \"password\" },\n        twoFactorProof: { label: \"2FA Proof\", type: \"text\" },\n      },\n      async authorize(credentials, req) {\n        console.log(\"AUTH DEBUG: authorize called with\", { email: credentials?.email })\n        // Basic input validation with Joi\n        const schema = Joi.object({\n          // Allow non-public TLDs (e.g., .local) in development; enforce strict in production\n          email: isProd\n            ? Joi.string().email().required()\n            : Joi.string().email({ tlds: { allow: false } }).required(),\n          password: Joi.string().min(6).required(),\n        })\n        const { error, value } = schema.validate({\n          email: credentials?.email,\n          password: credentials?.password,\n        })\n        if (error) {\n          console.log(\"AUTH DEBUG: Joi validation error\", error)\n          return null\n        }\n\n        // Sanitize email using shared sanitizer\n        const safeEmail = sanitizer.parse(value.email.trim().toLowerCase())\n\n        // Centralized protection: Shield/email validation handled by shared helper\n        try {\n          const sec = await protect(req as any, { email: safeEmail })\n          if (!sec.allowed) {\n            console.log(\"AUTH DEBUG: Protected by Arcjet/Security\")\n            return null\n          }\n        } catch {\n          // Fail open to avoid login lockouts if Arcjet fails\n        }\n\n        // Credentials auth\n        const user = await prisma.user.findUnique({ where: { email: safeEmail } })\n        if (!user) {\n          console.log(\"AUTH DEBUG: User not found\", safeEmail)\n          return null\n        }\n        const ok = await bcrypt.compare(value.password, user.passwordHash)\n        if (!ok) {\n          console.log(\"AUTH DEBUG: Password mismatch for\", safeEmail)\n          return null\n        }\n\n        // ENFORCE 2FA\n        if (user.totpEnabled) {\n          if (!credentials?.twoFactorProof) {\n            console.log(\"AUTH DEBUG: 2FA required but proof missing\")\n            throw new Error(\"2FA_REQUIRED\")\n          }\n          try {\n            const { verify2FAProof } = await import(\"@/lib/jwt\")\n            const proof = await verify2FAProof(credentials.twoFactorProof)\n            if (proof.sub !== user.id) throw new Error(\"INVALID_PROOF\")\n          } catch (e) {\n            console.log(\"AUTH DEBUG: 2FA proof verification failed\")\n            throw new Error(\"2FA_EXPIRED\")\n          }\n        }\n\n        console.log(\"AUTH DEBUG: Auth successful for\", safeEmail)\n        return { id: user.id, email: user.email, role: user.role }\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        ; (token as any).id = (user as any).id\n          ; (token as any).role = (user as any).role\n      }\n      return token\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        ; (session.user as any).id = (token as any).id\n          ; (session.user as any).role = (token as any).role\n      }\n      return session\n    },\n  },\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 481, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/ufriends%20version%201/app/dashboard/layout.tsx"],"sourcesContent":["import type React from \"react\"\r\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\"\r\nimport { redirect } from \"next/navigation\"\r\nimport { getServerSession } from \"next-auth\"\r\nimport { authOptions } from \"@/lib/auth\"\r\n\r\nexport default async function Layout({\r\n  children,\r\n}: {\r\n  children: React.ReactNode\r\n}) {\r\n  const session = await getServerSession(authOptions)\r\n  if (!session) {\r\n    redirect(\"/login\")\r\n  }\r\n\r\n  return <DashboardLayout>{children}</DashboardLayout>\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AACA;AACA;;;;;;AAEe,eAAe,OAAO,EACnC,QAAQ,EAGT;IACC,MAAM,UAAU,MAAM,IAAA,yJAAgB,EAAC,0HAAW;IAClD,IAAI,CAAC,SAAS;QACZ,IAAA,iMAAQ,EAAC;IACX;IAEA,qBAAO,8OAAC,2JAAe;kBAAE;;;;;;AAC3B","debugId":null}}]
}